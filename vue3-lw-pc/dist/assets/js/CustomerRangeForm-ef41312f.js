import{g as e}from"./businessConver-2b86f97c.js";import{g as l}from"./groupMessage-f31c8fd2.js";import{_ as s}from"./quill-image-resize-module-c051113e.js";import{T as t,U as a,X as i,ai as o,o as r,c as d,_ as u,Y as n,a9 as m,Z as p,K as c,R as g}from"./@vue-e400fd81.js";import"../index-044285d2.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";const f={isContain:"1"},v={components:{},props:{data:{type:Object},isDetail:{type:Boolean,default:!1},isTrans:{type:Boolean,default:!1},isEmptyTips:{type:Boolean,default:!0},exclude:{type:Array,default:()=>[]}},data(){return{form:this.data||JSON.parse(JSON.stringify(f)),stageList:[],dialogVisibleSelectUser:!1,dialogVisibleSelectTag:!1}},computed:{},watch:{form:{deep:!0,handler(e){var l,s,t,a,i,o,r,d,u,n,m,p,c;e=JSON.parse(JSON.stringify(e)),this.isTrans&&(e={genders:null==(l=e.genders)?void 0:l.join(","),customerTypes:null==(s=e.customerTypes)?void 0:s.join(","),tagIds:null==(a=null==(t=e.tags)?void 0:t.map((e=>e.tagId)))?void 0:a.join(","),tagNames:null==(o=null==(i=e.tags)?void 0:i.map((e=>e.name)))?void 0:o.join(","),userIds:null==(d=null==(r=e.users)?void 0:r.map((e=>e.userId)))?void 0:d.join(","),userNames:null==(n=null==(u=e.users)?void 0:u.map((e=>e.name)))?void 0:n.join(","),beginTime:null==(m=e.dateRange)?void 0:m[0],endTime:null==(p=e.dateRange)?void 0:p[1],trackState:e.trackState,isContain:(null==(c=e.tags)?void 0:c.length)?e.isContain:void 0}),this.change(e)}}},created(){var l,s,t,a,i,o,r,d;if(this.isTrans&&this.data){let e=JSON.parse(JSON.stringify(this.data)),u=null==(l=e.userNames)?void 0:l.split(","),n=null==(s=e.tagNames)?void 0:s.split(",");this.form=Object.assign(e,{isContain:e.isContain?e.isContain+"":void 0,genders:null==(t=e.genders)?void 0:t.split(","),customerTypes:null==(a=e.customerTypes)?void 0:a.split(","),users:null==(o=null==(i=e.userIds)?void 0:i.split(","))?void 0:o.map(((e,l)=>({userId:e,name:null==u?void 0:u[l]}))),tags:null==(d=null==(r=e.tagIds)?void 0:r.split(","))?void 0:d.map(((e,l)=>({tagId:e,name:null==n?void 0:n[l]}))),dateRange:[e.beginTime,e.endTime]})}this.change(this.data||JSON.parse(JSON.stringify(f))),e().then((e=>{this.stageList=e.data}))},mounted(){},methods:{change(e){this.$emit("update:data",e),this.$attrs.onGetCustomers&&this.getCustomerList(e)},getCustomerList(e=this.data){return l(e,1).then((({data:e})=>{if(null==e?void 0:e.length)this.$attrs.onGetCustomers&&this.$emit("getCustomers",e);else if(this.isEmptyTips)return this.msgError("未找到符合条件的客户!"),Promise.reject();return e}))}}},j={key:0},b={key:0};const y=s(v,[["render",function(e,l,s,f,v,y){const h=o("el-button"),k=o("SelectUser"),S=o("TagEllipsis"),T=o("el-form-item"),V=o("el-checkbox"),_=o("el-checkbox-group"),C=o("el-date-picker"),x=o("SelectTag"),U=o("el-radio"),N=o("el-radio-group"),O=o("el-option"),I=o("el-select"),J=o("el-form");return v.form?(r(),t(J,{key:0,model:v.form,ref:"form"},{default:a((()=>[s.exclude.includes("users")?i("",!0):(r(),t(T,{key:0,label:"添加人员",prop:"users"},{default:a((()=>[s.isDetail?i("",!0):(r(),d("div",j,[u(h,{type:"primary",onClick:l[0]||(l[0]=e=>v.dialogVisibleSelectUser=!0)},{default:a((()=>[n("选择人员")])),_:1}),u(k,{visible:v.dialogVisibleSelectUser,"onUpdate:visible":l[1]||(l[1]=e=>v.dialogVisibleSelectUser=e),title:"选择人员",defaultValues:v.form.users,onSuccess:l[2]||(l[2]=l=>(v.form.users=l,e.$refs.form.validateField("users")))},null,8,["visible","defaultValues"])])),u(S,{list:v.form.users,limit:"10",emptyText:s.isDetail},null,8,["list","emptyText"])])),_:1})),s.exclude.includes("customerTypes")?i("",!0):(r(),t(T,{key:1,label:"客户类型",prop:"customerTypes"},{default:a((()=>[u(_,{modelValue:v.form.customerTypes,"onUpdate:modelValue":l[3]||(l[3]=e=>v.form.customerTypes=e)},{default:a((()=>[(r(),d(c,null,m({1:"微信用户",2:"企业用户"},((e,l)=>u(V,{key:l,label:l},{default:a((()=>[n(p(e),1)])),_:2},1032,["label"]))),64))])),_:1},8,["modelValue"])])),_:1})),s.exclude.includes("genders")?i("",!0):(r(),t(T,{key:2,label:"客户性别",prop:"genders"},{default:a((()=>[u(_,{modelValue:v.form.genders,"onUpdate:modelValue":l[4]||(l[4]=e=>v.form.genders=e)},{default:a((()=>[(r(),d(c,null,m([{label:"男",value:"1"},{label:"女",value:"2"},{label:"未知",value:"0"}],((e,l)=>u(V,{key:l,label:e.value},{default:a((()=>[n(p(e.label),1)])),_:2},1032,["label"]))),64))])),_:1},8,["modelValue"])])),_:1})),s.exclude.includes("dateRange")?i("",!0):(r(),t(T,{key:3,label:"添加时间"},{default:a((()=>[u(C,g({modelValue:v.form.dateRange,"onUpdate:modelValue":l[5]||(l[5]=e=>v.form.dateRange=e),"value-format":"YYYY-MM-DD",type:"daterange"},e.pickerOptions,{"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right"}),null,16,["modelValue"])])),_:1})),s.exclude.includes("tags")?i("",!0):(r(),t(T,{key:4,label:"客户标签",prop:"tags"},{default:a((()=>[s.isDetail?i("",!0):(r(),d("div",b,[u(h,{type:"primary",onClick:l[6]||(l[6]=e=>v.dialogVisibleSelectTag=!0)},{default:a((()=>[n("选择标签")])),_:1}),u(x,{visible:v.dialogVisibleSelectTag,"onUpdate:visible":l[7]||(l[7]=e=>v.dialogVisibleSelectTag=e),selected:v.form.tags,onSuccess:l[8]||(l[8]=l=>(v.form.tags=l,e.$refs.form.validateField("tags")))},null,8,["visible","selected"])])),u(S,{class:"block mt5",list:v.form.tags,limit:"10"},null,8,["list"]),u(N,{modelValue:v.form.isContain,"onUpdate:modelValue":l[9]||(l[9]=e=>v.form.isContain=e),onChange:l[10]||(l[10]=()=>{})},{default:a((()=>[(r(),d(c,null,m({1:"包含全部选中标签",2:"包含其中一个标签",3:"不包含选中标签"},((e,l)=>u(U,{key:l,label:l},{default:a((()=>[n(p(e),1)])),_:2},1032,["label"]))),64))])),_:1},8,["modelValue"])])),_:1})),s.exclude.includes("trackState")?i("",!0):(r(),t(T,{key:5,label:"商机阶段",prop:"trackState"},{default:a((()=>[u(I,{modelValue:v.form.trackState,"onUpdate:modelValue":l[11]||(l[11]=e=>v.form.trackState=e),placeholder:"请选择"},{default:a((()=>[(r(!0),d(c,null,m(v.stageList,((e,l)=>(r(),t(O,{key:l,label:e.stageKey,value:e.stageVal},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}))])),_:1},8,["model"])):i("",!0)}]]);export{y as default};
