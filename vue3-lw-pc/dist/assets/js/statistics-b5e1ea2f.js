import{u as e}from"./vue-router-f8d53be7.js";import{c as a,d as t,e as l,f as r,h as o}from"./api-8af93ec8.js";import{r as i,ai as s,o as d,c as u,_ as n,u as p,U as m,R as c,K as j,a9 as g,T as f,Y as b,Z as T,a as h,i as q}from"./@vue-e400fd81.js";import"../index-044285d2.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./quill-image-resize-module-c051113e.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";const v=["onClick"],_={__name:"statistics",setup(_){let U=i(!1),y=e().query.id,C=i([]),R={0:"未进群",1:"已进群"},x=i(!1);function J(e,a,t){t.length=0,a.length=0;let l=[[],[]];e.forEach((e=>{t.push(e.date),l[0].push(e.touchWeCustomerNumber),l[1].push(e.joinGroupCustomerNumber)})),a.push(...l)}function N(e){return e.id=y,e.dateRangeAddTime?(e.startAddTime=e.dateRangeAddTime[0],e.endAddTime=e.dateRangeAddTime[1]):(delete e.startAddTime,delete e.endAddTime),delete e.dateRangeAddTime,e.dateRangeJoinTime?(e.startJoinTime=e.dateRangeJoinTime[0],e.endJoinTime=e.dateRangeJoinTime[1]):(delete e.startJoinTime,delete e.endJoinTime),delete e.dateRangeJoinTime,o(e)}return U.value=!0,a(y).then((({data:e})=>{C.value=[{title:"送达客户总数",tips:"建群任务送达的客户总数(去重)",value:e.touchWeCustomerNumber},{title:"进群客户总数",tips:"送达客户中成功进群的总数(去重)",value:e.joinGroupCustomerNumber},{title:"今日送达客户数",tips:"今日建群任务送达的客户数(去重)",value:e.tdTouchWeCustomerNumber},{title:"今日进群客户数",tips:"今日送达客户中成功进群数(去重)",value:e.tdJoinGroupCustomerNumber}]})).finally((()=>{U.value=!1})),(e,a)=>{const o=s("CardGroupIndex"),i=s("RequestChartTable"),_=s("el-input"),U=s("el-form-item"),y=s("el-date-picker"),V=s("el-option"),A=s("el-select"),k=s("el-table-column"),G=s("el-button"),w=s("el-table"),E=s("el-dialog");return d(),u("div",null,[n(o,{data:p(C)},null,8,["data"]),n(i,{type:"lineChart",title:"数据趋势",isTimeQuery:"",isCreateRequest:!1,request:a=>(a.id=e.$route.query.id,t(a)),legend:["今日送达客户数","今日进群客户数"],dealDataFun:J},null,8,["request"]),n(i,{title:"数据明细",ref:"importRecord",request:N,requestExport:a=>(a.id=e.$route.query.id,l(a)),exportFileName:"标签建群数据明细导出.xls"},{queryMiddle:m((({query:a})=>[n(U,{label:"",prop:"customerName"},{default:m((()=>[n(_,{modelValue:a.customerName,"onUpdate:modelValue":e=>a.customerName=e,placeholder:"请输入客户名称"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),n(U,{label:""},{default:m((()=>[n(y,c({modelValue:a.dateRangeAddTime,"onUpdate:modelValue":e=>a.dateRangeAddTime=e,"value-format":"YYYY-MM-DD",type:"daterange"},e.pickerOptions,{"range-separator":"-","start-placeholder":"添加开始","end-placeholder":"结束日期",align:"right"}),null,16,["modelValue","onUpdate:modelValue"])])),_:2},1024),n(U,{label:"",prop:"isJoinGroup"},{default:m((()=>[n(A,{modelValue:a.isJoinGroup,"onUpdate:modelValue":e=>a.isJoinGroup=e,placeholder:"请选择是否进群"},{default:m((()=>[(d(!0),u(j,null,g(p(R),((e,a)=>(d(),f(V,{key:a,label:e,value:a},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),default:m((({data:a})=>[n(w,{data:a},{default:m((()=>[n(k,{align:"center",prop:"customerName",label:"客户名称"}),n(k,{align:"center",prop:"addUserId",label:"添加员工"}),n(k,{align:"center",prop:"addTime",label:"添加时间"}),n(k,{align:"center",prop:"isJoinGroup",label:"是否进群"},{default:m((({row:e})=>[b(T(p(R)[e.isJoinGroup]),1)])),_:1}),n(k,{align:"center",prop:"groupName",label:"进入客群"},{default:m((({row:a})=>[h("div",{class:"g-color cp",onClick:t=>{var l;e.externalUserid=a.externalUserid,q(x)?x.value=!0:x=!0,null==(l=e.$refs.RequestChartTableDialog)||l.getList()}},T(a.joinGroupNumber),9,v)])),_:1}),n(k,{align:"center",prop:"joinTime",label:"进群时间"},{default:m((({row:e})=>[b(T(e.joinTime||"—"),1)])),_:1}),n(k,{label:"操作",align:"center"},{default:m((({row:a})=>[n(G,{text:"",onClick:t=>e.$router.push({name:e.lwConfig.CUSTOMER_DETAIL_ROUTE_NAME,query:{externalUserid:a.externalUserid,userId:a.addUserId}})},{default:m((()=>[b(" 客户详情 ")])),_:2},1032,["onClick"])])),_:1})])),_:2},1032,["data"])])),_:1},8,["requestExport"]),n(E,{title:"进入客群",modelValue:p(x),"onUpdate:modelValue":a[0]||(a[0]=e=>q(x)?x.value=e:x=e),"close-on-click-modal":!1},{default:m((()=>[n(i,{ref:"RequestChartTableDialog",style:{padding:"0 0 20px 0"},request:a=>(a.id=e.$route.query.id,a.externalUserid=e.externalUserid,r(a))},{default:m((({data:e})=>[n(w,{data:e},{default:m((()=>[n(k,{label:"客群名称",align:"center",prop:"groupName"}),n(k,{align:"center",prop:"joinTime",label:"进群时间"},{default:m((({row:e})=>[b(T(e.joinTime||"—"),1)])),_:1})])),_:2},1032,["data"])])),_:1},8,["request"])])),_:1},8,["modelValue"])])}}};export{_ as default};
