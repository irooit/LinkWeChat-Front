import{i as e}from"./echarts-8e7b9cd7.js";import{c as t,h as a,i}from"./staff-48996164.js";import{_ as s}from"./quill-image-resize-module-c051113e.js";import{ai as l,aq as o,V as r,o as d,c as m,a as n,_ as p,U as u,Y as c,K as f,a9 as h,T as g,Z as j,bl as y,bj as b}from"./@vue-e400fd81.js";import"./tslib-a4e99503.js";import"./zrender-da4e2cf7.js";import"../index-044285d2.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";const v={name:"CodeDetail",data:()=>({loading:!1,ids:[],total:0,list:[],dateRange:[],form:{},query:{userId:void 0,addWay:void 0,beginTime:void 0,endTime:void 0},type:{1:"单人",2:"多人",3:"批量单人"},timeRange:7}),created(){let e=this.$route.query.id;e&&this.getDetail(e)},mounted(){this.clipboard=new this.ClipboardJS(".copy-btn")},unmounted(){this.clipboard.destroy()},methods:{getDetail(e){this.loading=!0,t(e).then((({data:e})=>{this.form=e,this.loading=!1,this.query.userId=e.weEmpleCodeUseScops[0].businessId,this.query.addWay=1,this.setTime(7),this.getList()}))},getList(){this.query.beginTime=this.dateRange[0],this.query.endTime=this.dateRange[1],a(this.query).then((({data:t})=>{this.total=t.total,this.loading=!1;let a={xAxis:{type:"category",data:t.dateList},yAxis:{type:"value"},series:[{data:t.statList,type:"line"}]};e(this.$refs.chart).setOption(a),this.$nextTick((()=>{}))}))},setTime(e){this.timeRange=e;let t=new Date;t.setDate(t.getDate()-e),this.dateRange=[this.getTime(t),this.getTime()],this.getList()},getHandledValue:e=>e<10?"0"+e:e,getTime(e){const t=e?new Date(e):new Date;return t.getFullYear()+"-"+this.getHandledValue(t.getMonth()+1)+"-"+this.getHandledValue(t.getDate())},download(){let e=this.form.weEmpleCodeUseScops.map((e=>e.businessName)).join(",")+"-"+this.form.activityScene+".png";i(this.form.id).then((t=>{if(null!=t){let a=new Blob([t],{type:"application/zip"}),i=window.URL.createObjectURL(a);const s=document.createElement("a");s.href=i,s.download=e,s.click(),URL.revokeObjectURL(i)}}))}}},w=e=>(y("data-v-0e887996"),e=e(),b(),e),_=w((()=>n("div",{class:"title"},"员工活码信息",-1))),x={class:"flex top"},q={class:"ac"},T=w((()=>n("div",{class:"title"},"扫码人数",-1))),C={class:"mb15"},R={class:"chart",ref:"chart",style:{width:"90%",height:"400px"}};const D=s(v,[["render",function(e,t,a,i,s,y){const b=l("el-image"),v=l("el-button"),w=l("el-tag"),D=l("el-form-item"),k=l("el-form"),L=l("el-divider"),U=l("el-button-group"),V=l("el-date-picker"),z=o("loading");return r((d(),m("div",null,[_,n("div",x,[n("div",q,[p(b,{src:s.form.qrCode,fit:"fill","preview-src-list":[s.form.qrCode],style:{width:"150px",height:"150px"}},null,8,["src","preview-src-list"]),n("div",null,[p(v,{text:"",onClick:t[0]||(t[0]=e=>y.download())},{default:u((()=>[c("下载二维码")])),_:1}),p(v,{text:"",class:"copy-btn","data-clipboard-text":s.form.qrCode},{default:u((()=>[c("复制链接")])),_:1},8,["data-clipboard-text"])])]),p(k,{ref:"form","label-width":"100px"},{default:u((()=>[p(D,{label:"使用成员："},{default:u((()=>[(d(!0),m(f,null,h(s.form.weEmpleCodeUseScops,((e,t)=>(d(),g(w,{key:t},{default:u((()=>[c(j(e.businessName),1)])),_:2},1024)))),128))])),_:1}),p(D,{label:"活动场景："},{default:u((()=>[c(j(s.form.activityScene),1)])),_:1}),p(D,{label:"类型："},{default:u((()=>[c(j(s.type[s.form.codeType]),1)])),_:1}),p(D,{label:"设置："},{default:u((()=>[c(j(`客户添加时${1===s.form.isJoinConfirmFriends?"无":""}需经过确认自动成为好友`),1)])),_:1}),p(D,{label:"创建人："},{default:u((()=>[c(j(s.form.createBy),1)])),_:1}),p(D,{label:"创建时间："},{default:u((()=>[c(j(s.form.createTime),1)])),_:1})])),_:1},512),p(k,{ref:"form","label-width":"100px"},{default:u((()=>[p(D,{label:"扫码标签："},{default:u((()=>[(d(!0),m(f,null,h(s.form.weEmpleCodeTags,((e,t)=>(d(),g(w,{key:t},{default:u((()=>[c(j(e.tagName),1)])),_:2},1024)))),128))])),_:1}),p(D,{label:"欢迎语："},{default:u((()=>[c(j(s.form.welcomeMsg),1)])),_:1})])),_:1},512)]),p(L),T,n("div",C,"累计总人数："+j(s.total),1),n("div",null,[p(U,null,{default:u((()=>[p(v,{type:"primary",plain:7!=s.timeRange,onClick:t[1]||(t[1]=e=>y.setTime(7))},{default:u((()=>[c("近7日")])),_:1},8,["plain"]),p(v,{type:"primary",plain:30!=s.timeRange,onClick:t[2]||(t[2]=e=>y.setTime(30))},{default:u((()=>[c("近30日")])),_:1},8,["plain"])])),_:1}),p(V,{modelValue:s.dateRange,"onUpdate:modelValue":t[3]||(t[3]=e=>s.dateRange=e),class:"ml20",style:{width:"260px"},"value-format":"YYYY-MM-DD",type:"daterange",clearable:!1,"range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期",onChange:y.getList},null,8,["modelValue","onChange"])]),n("div",R,null,512)])),[[z,s.loading]])}],["__scopeId","data-v-0e887996"]]);export{D as default};
