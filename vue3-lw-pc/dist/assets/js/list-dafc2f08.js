import{h as e}from"./moment-8163541f.js";import{r as t,l as a,j as l,k as s}from"./circle-2faa2a32.js";import{_ as i}from"./quill-image-resize-module-c051113e.js";import{ai as o,aq as r,o as u,c as n,_ as p,U as d,K as m,a9 as c,T as h,Y as y,a as f,V as g,Z as b,X as j,bl as v,bj as T}from"./@vue-e400fd81.js";import"../index-044285d2.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";const q={name:"enterprise",components:{},data:()=>({value1:[],dialogVisible:!1,userArray:[],query:{pageSize:10,pageNum:1,executeStartTime:"",executeEndTime:""},loading:!1,tableData:[],total:0,sendType:[{label:"企微群发",value:0},{label:"成员群发",value:2}],taskStatus:[{label:"未开始",value:1},{label:"进行中",value:2},{label:"已结束",value:3}]}),methods:{dealType(e){switch(e){case 1:return"未开始";case 2:return"进行中";case 3:return"已结束"}},dealSendType(e){switch(e){case 0:return"企微群发";case 1:return"个人发送";case 2:return"成员群发"}},remind(e){this.$confirm("提醒执行将针对本任务未执行的成员再次催促执行，是否确认提醒？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((()=>{t(e).then((e=>{200===e.code&&(this.msgSuccess(e.msg),this.getList())}))})).catch((()=>{}))},cease(e){this.$confirm("是否确认停止当前朋友圈任务？停止后将终止当前朋友圈任务，不可再次继续。仅可查看已执行成员的相关数据。（部分朋友圈数据同步可能会存在偏差）","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((()=>{a(e).then((e=>{200===e.code&&(this.msgSuccess(e.msg),this.getList())}))})).catch((()=>{}))},gotoRoute(){this.$router.push({path:"./publish"})},setTimeChange(t){t?(this.query.executeStartTime=e(t[0]).format("YYYY-MM-DD HH:mm"),this.query.executeEndTime=e(t[1]).format("YYYY-MM-DD HH:mm")):(this.query.executeStartTime="",this.query.executeEndTime="")},determineType(e){let t="";return 1===e.isLwPush?t=1:0===e.isLwPush&&(0===e.type?t=2:1===e.type&&(t=3)),t},detailFn(e){let t=this.determineType(e);this.$router.push({path:"./publish",query:{type:t,id:e.id}})},statistics(e){let t=this.determineType(e);this.$router.push({path:"./statistics",query:{type:t,id:e.id,name:e.name,showRemaind:2===e.status&&0!==e.sendType?1:0,sendType:e.sendType}})},syncFn(e){l(e).then((e=>{200===e.code&&(this.msgSuccess(e.data),this.getList())}))},getSelectUser(e){this.userArray=e,this.query.creator=this.userArray.map((function(e,t){return e.name})).join(",")},resetQuery(){this.query={pageSize:10,pageNum:1,executeStartTime:"",executeEndTime:""},this.userArray=[],this.value1=[],this.getList()},getList(e){e&&(this.query.pageNum=e),this.loading=!0,s(this.query).then((e=>{this.tableData=e.rows,this.total=Number(e.total),this.loading=!1})).catch((()=>{this.loading=!1}))}},mounted(){},created(){this.getList(),this.$store.setBusininessDesc("\n        <div>可对企业的朋友圈资源进行统一运营，联动互动功能进行自动打标签，统计成员朋友圈执行效率功能等等</div>\n      ")}},w={class:"g-card"},_={class:"mid-action"},k=(e=>(v("data-v-a427d39c"),e=e(),T(),e))((()=>f("div",null,"企业每分钟创建朋友圈的频率：10条/分钟",-1)));const x=i(q,[["render",function(e,t,a,l,s,i){const v=o("el-input"),T=o("el-form-item"),q=o("el-option"),x=o("el-select"),V=o("el-date-picker"),S=o("el-button"),C=o("el-form"),U=o("el-icon-QuestionFilled"),Y=o("el-popover"),D=o("el-table-column"),L=o("el-table"),B=o("pagination"),z=o("SelectUser"),F=r("loading");return u(),n("div",null,[p(C,{model:s.query,"label-position":"left",ref:"queryForm",inline:!0,"label-width":"70px",class:"top-search"},{default:d((()=>[p(T,{prop:"name"},{default:d((()=>[p(v,{modelValue:s.query.name,"onUpdate:modelValue":t[0]||(t[0]=e=>s.query.name=e),placeholder:"请输入任务名称"},null,8,["modelValue"])])),_:1}),p(T,{prop:"createBy"},{default:d((()=>[p(v,{modelValue:s.query.createBy,"onUpdate:modelValue":t[1]||(t[1]=e=>s.query.createBy=e),placeholder:"请输入创建人"},null,8,["modelValue"])])),_:1}),p(T,{prop:"sendType"},{default:d((()=>[p(x,{clearable:"",modelValue:s.query.sendType,"onUpdate:modelValue":t[2]||(t[2]=e=>s.query.sendType=e),placeholder:"请选择发送方式"},{default:d((()=>[(u(!0),n(m,null,c(s.sendType,((e,t)=>(u(),h(q,{key:t,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),p(T,{prop:"creator"},{default:d((()=>[p(x,{clearable:"",modelValue:s.query.status,"onUpdate:modelValue":t[3]||(t[3]=e=>s.query.status=e),placeholder:"请选择任务状态"},{default:d((()=>[(u(!0),n(m,null,c(s.taskStatus,((e,t)=>(u(),h(q,{key:t,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),p(T,null,{default:d((()=>[p(V,{clearable:"",modelValue:s.value1,"onUpdate:modelValue":t[4]||(t[4]=e=>s.value1=e),format:"YYYY-MM-DD HH:mm",onChange:i.setTimeChange,type:"datetimerange","range-separator":"—","start-placeholder":"执行开始时间","end-placeholder":"执行结束时间",style:{width:"240px"}},null,8,["modelValue","onChange"])])),_:1}),p(T,null,{default:d((()=>[p(S,{type:"primary",onClick:t[5]||(t[5]=e=>i.getList(1))},{default:d((()=>[y("查询")])),_:1}),p(S,{onClick:i.resetQuery},{default:d((()=>[y("清空")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"]),f("div",w,[f("div",_,[f("div",null,[p(S,{type:"primary",onClick:i.gotoRoute,style:{"margin-right":"10px"}},{default:d((()=>[y("新建朋友圈")])),_:1},8,["onClick"]),p(Y,{placement:"top",trigger:"hover"},{reference:d((()=>[p(U,{class:"el-icon-QuestionFilled mr5"})])),default:d((()=>[k])),_:1})])]),g((u(),h(L,{ref:"table",data:s.tableData},{default:d((()=>[p(D,{"show-overflow-tooltip":"",prop:"name",label:"任务名称"},{default:d((({row:e})=>[y(b(e.name?e.name:"—"),1)])),_:1}),p(D,{"show-overflow-tooltip":"",prop:"sendType",label:"发送方式"},{default:d((({row:e})=>[y(b(i.dealSendType(e.sendType)),1)])),_:1}),p(D,{"show-overflow-tooltip":"",prop:"createBy",label:"创建人"}),p(D,{"show-overflow-tooltip":"",prop:"executeTime",label:"执行时间"},{default:d((({row:e})=>[y(b(e.executeTime?e.executeTime:"—"),1)])),_:1}),p(D,{"show-overflow-tooltip":"",prop:"status",label:"任务状态"},{default:d((({row:e})=>[f("div",null,b(i.dealType(e.status)),1)])),_:1}),p(D,{"show-overflow-tooltip":"",prop:"finishRate",label:"完成率"}),p(D,{label:"操作",align:"center",width:"200"},{default:d((({row:e})=>[2===e.status&&0!==e.sendType?(u(),h(S,{key:0,text:"",onClick:t=>i.remind(e.id)},{default:d((()=>[y("提醒执行")])),_:2},1032,["onClick"])):j("",!0),0==e.sendType?(u(),h(S,{key:1,text:"",onClick:t=>i.syncFn(e.id)},{default:d((()=>[y("同步")])),_:2},1032,["onClick"])):j("",!0),p(S,{text:"",onClick:t=>i.statistics(e)},{default:d((()=>[y("统计")])),_:2},1032,["onClick"]),p(S,{text:"",onClick:t=>i.detailFn(e)},{default:d((()=>[y("查看")])),_:2},1032,["onClick"]),3!==e.status?(u(),h(S,{key:2,text:"",onClick:t=>i.cease(e.id)},{default:d((()=>[y("停止")])),_:2},1032,["onClick"])):j("",!0)])),_:1})])),_:1},8,["data"])),[[F,s.loading]]),p(B,{total:s.total,page:s.query.pageNum,"onUpdate:page":t[6]||(t[6]=e=>s.query.pageNum=e),limit:s.query.pageSize,"onUpdate:limit":t[7]||(t[7]=e=>s.query.pageSize=e),onPagination:t[8]||(t[8]=e=>i.getList())},null,8,["total","page","limit"])]),p(z,{visible:s.dialogVisible,"onUpdate:visible":t[9]||(t[9]=e=>s.dialogVisible=e),title:"组织架构",defaultValues:s.userArray,onSuccess:i.getSelectUser},null,8,["visible","defaultValues","onSuccess"])])}],["__scopeId","data-v-a427d39c"]]);export{x as default};
