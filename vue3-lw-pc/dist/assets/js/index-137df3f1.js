import{c as e,g as t,r as i}from"./intelligentShortLink-f7529ad3.js";import{g as o}from"./enterpriseId-1d1ed446.js";import{t as l}from"./mixin-7ecaaf69.js";import{_ as a}from"./quill-image-resize-module-c051113e.js";import{ai as s,aq as r,o as n,c as p,_ as d,U as u,K as m,a9 as c,T as h,Y as g,a as f,V as y,Z as j,X as v,bl as b,bj as k}from"./@vue-e400fd81.js";import"../index-044285d2.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";const _={name:"",components:{},data:()=>({loading:!1,cardData:[],total:0,query:{pageSize:10,pageNum:1},touchTypeDict:l,list:[],ids:[],needMoreInfo:!1,dialogVisible:!1}),computed:{},watch:{},created(){this.setState(),this.getList(),this.getAnalysis(),this.$store.setBusininessDesc(" <div>生成智能短链，一键跳转公众号、小程序、企业微信</div> ")},mounted(){this.clipboard=new this.ClipboardJS(".copy-btn")},unmounted(){this.clipboard.destroy()},methods:{cancelFn(){this.needMoreInfo=!1,this.dialogVisible=!1,this.goRoute()},gotoSetting(){this.$router.push({name:lwConfig.WORK_WEIXIN_CONFIG_ROUTE_NAME})},setState(){o().then((e=>{e.data.wxAppletOriginalId&&e.data.miniAppId&&e.data.miniSecret||(this.needMoreInfo=!0)}))},getAnalysis(){this.loading=!0,e().then((({data:e})=>{this.cardData=[{title:"访问总数(pv)",tips:"短链页面访问的总次数",value:e.pvTotalCount},{title:"访问总人数(uv)",tips:"短链页面访问的独立IP数",value:e.uvTotalCount},{title:"小程序打开数",tips:"小程序成功打开的总次数",value:e.openTotalCount},{title:"今日访问总数(pv)",tips:"今日短链页面访问的总次数",value:e.pvTodayCount,title1:"较昨日",value1:e.pvDiff},{title:"今日访问总人数(uv)",tips:"今日短链页面访问的独立IP数",value:e.uvTodayCount,title1:"较昨日",value1:e.uvDiff},{title:"今日小程序打开数",tips:"今日小程序成功打开的总次数",value:e.openTodayCount,title1:"较昨日",value1:e.openDiff}]})).catch((e=>{})).finally((()=>{this.loading=!1}))},getList(e){e&&(this.query.pageNum=e),this.loading=!0,t(this.query).then((({rows:e,total:t})=>{this.list=e||[],this.total=+t})).catch((()=>{})).finally((()=>{this.loading=!1}))},resetForm(){this.$refs.queryForm.resetFields(),this.getList(1)},goRoute(e,t="addEdit"){if(!e&&this.needMoreInfo)return void(this.dialogVisible=!0);let{id:i}=e||{};this.$router.push({path:"./"+t,query:{id:i}})},remove(e){const t=e||this.ids+"";this.$confirm("是否确认删除吗?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return i(t)})).then((()=>{this.getList(),this.msgSuccess("删除成功")}))}}},C={class:"g-card"},w={class:"mid-action"},q={key:0,class:"tips"},I=(e=>(b("data-v-36da4e50"),e=e(),k(),e))((()=>f("div",{style:{"text-align":"center"}},"智能短链需要先配置短链小程序，否则无法正常使用。",-1))),L={class:"dialog-footer"};const V=a(_,[["render",function(e,t,i,o,l,a){const b=s("CardGroupIndex"),k=s("el-input"),_=s("el-form-item"),V=s("el-option"),x=s("el-select"),S=s("el-button"),T=s("el-form"),N=s("el-table-column"),D=s("el-icon-copy-document"),F=s("el-table"),U=s("pagination"),z=s("el-dialog"),M=r("loading");return n(),p("div",null,[d(b,{data:l.cardData},null,8,["data"]),d(T,{ref:"queryForm",inline:!0,model:l.query,class:"top-search","label-width":""},{default:u((()=>[d(_,{label:"短链名称",prop:"shortLinkName"},{default:u((()=>[d(k,{clearable:"",modelValue:l.query.shortLinkName,"onUpdate:modelValue":t[0]||(t[0]=e=>l.query.shortLinkName=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1}),d(_,{label:"类型",prop:"type"},{default:u((()=>[d(x,{clearable:"",modelValue:l.query.type,"onUpdate:modelValue":t[1]||(t[1]=e=>l.query.type=e),placeholder:"请选择"},{default:u((()=>[(n(!0),p(m,null,c(l.touchTypeDict,((e,t)=>(n(),h(V,{key:t,label:e.allName,value:+t},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),d(_,{label:""},{default:u((()=>[d(S,{type:"primary",onClick:t[2]||(t[2]=e=>a.getList(1))},{default:u((()=>[g("查询")])),_:1}),d(S,{onClick:t[3]||(t[3]=e=>a.resetForm())},{default:u((()=>[g("重置")])),_:1})])),_:1})])),_:1},8,["model"]),f("div",C,[f("div",w,[d(S,{type:"primary",class:"mr10",onClick:t[4]||(t[4]=e=>a.goRoute())},{default:u((()=>[g("新建短链")])),_:1}),d(S,{disabled:!l.ids.length,type:"danger",onClick:t[5]||(t[5]=e=>a.remove())},{default:u((()=>[g("批量删除")])),_:1},8,["disabled"])]),y((n(),h(F,{data:l.list,onSelectionChange:t[6]||(t[6]=e=>l.ids=e.map((e=>e.id)))},{default:u((()=>[d(N,{type:"selection",width:"55",align:"center"}),d(N,{label:"短链名称",align:"center",prop:"shortLinkName","show-overflow-tooltip":""}),d(N,{label:"类型",align:"center",prop:"type"},{default:u((({row:e})=>[g(j(l.touchTypeDict[e.type+""].allName),1)])),_:1}),d(N,{label:"短链地址",align:"center",prop:"shortLink","show-overflow-tooltip":""},{default:u((({row:e})=>[f("span",null,j(e.shortLink),1)])),_:1}),d(N,{width:"35",align:"center"},{default:u((({row:e})=>[d(D,{class:"el-icon-copy-document copy-btn cp",title:"复制","data-clipboard-text":e.shortLink},null,8,["data-clipboard-text"])])),_:1}),d(N,{label:"最后更新时间",align:"center",prop:"updateTime","show-overflow-tooltip":""}),d(N,{label:"操作",align:"center"},{default:u((({row:e})=>[d(S,{text:"",onClick:t=>a.goRoute(e,"detail")},{default:u((()=>[g("详情|统计")])),_:2},1032,["onClick"]),d(S,{text:"",onClick:t=>a.goRoute(e)},{default:u((()=>[g("编辑")])),_:2},1032,["onClick"]),d(S,{onClick:t=>a.remove(e.id),text:""},{default:u((()=>[g("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[M,l.loading]]),d(U,{total:l.total,page:l.query.pageNum,"onUpdate:page":t[7]||(t[7]=e=>l.query.pageNum=e),limit:l.query.pageSize,"onUpdate:limit":t[8]||(t[8]=e=>l.query.pageSize=e),onPagination:t[9]||(t[9]=e=>a.getList())},null,8,["total","page","limit"]),l.needMoreInfo?(n(),p("div",q,[g(" 智能短链需要先配置短链小程序，否则无法正常使用， "),f("a",{class:"link",onClick:t[10]||(t[10]=(...e)=>a.gotoSetting&&a.gotoSetting(...e))},"去配置")])):v("",!0)]),d(z,{title:"提示","close-on-click-modal":!1,"show-close":!1,modelValue:l.dialogVisible,"onUpdate:modelValue":t[11]||(t[11]=e=>l.dialogVisible=e),width:"auto"},{footer:u((()=>[f("span",L,[d(S,{onClick:a.cancelFn},{default:u((()=>[g("继续新建")])),_:1},8,["onClick"]),d(S,{type:"primary",onClick:a.gotoSetting},{default:u((()=>[g("去配置")])),_:1},8,["onClick"])])])),default:u((()=>[I])),_:1},8,["modelValue"])])}],["__scopeId","data-v-36da4e50"]]);export{V as default};
