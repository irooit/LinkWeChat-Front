import{a as t}from"./appManage-10b8c536.js";import{ai as e,aq as i,o as s,c as a,_ as o,U as l,K as r,a9 as n,T as p,Y as m,V as u,Z as d,X as c,$ as g}from"./@vue-e400fd81.js";import{_ as j}from"./quill-image-resize-module-c051113e.js";import"../index-044285d2.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";const y=j({name:"",components:{},props:{id:{type:[String,Number],required:!0}},data(){return{query:{pageNum:1,pageSize:10,title:"",status:"",agentId:this.id},total:0,list:[],loading:!1,status:{"":"全部状态",0:"草稿",1:"待发送",2:"已发送",3:"发送失败",4:"已撤回"},typeDict:{text:"文本",image:"图片",news:"图文",video:"视频",file:"文件"},form:{}}},computed:{},watch:{},created(){this.getList()},mounted(){},methods:{getList(e){e&&(this.query.pageNum=e),this.loading=!0,t.getList(this.query).then((({rows:t,total:e})=>{this.list=t,this.total=+e})).finally((()=>{this.loading=!1}))},edit(e,i){this.loading=!0,this.form=Object.assign({},e||{}),t.getDetail(e.id).then((t=>{this.$emit("edit",t.data,i)})).finally((()=>{this.loading=!1}))},removke(e,i,s){this.$confirm("是否确认"+s+"？该操作不可撤销，请谨慎操作。",{title:"警告",confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return t[i](e)})).then((()=>{this.getList(),this.msgSuccess("删除成功")}))},resetQuery(){this.query.status="",this.getList(1)}}},[["render",function(t,j,y,f,h,k){const b=e("el-option"),q=e("el-select"),v=e("el-button"),_=e("el-table-column"),x=e("el-table"),C=e("pagination"),w=i("loading");return s(),a("div",null,[o(q,{class:"mb10 mr10",modelValue:h.query.status,"onUpdate:modelValue":j[0]||(j[0]=t=>h.query.status=t),placeholder:""},{default:l((()=>[(s(!0),a(r,null,n(h.status,((t,e)=>(s(),p(b,{key:e,label:t,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),o(v,{type:"primary",onClick:j[1]||(j[1]=t=>k.getList(1))},{default:l((()=>[m("查询")])),_:1}),o(v,{onClick:k.resetQuery},{default:l((()=>[m("重置")])),_:1},8,["onClick"]),u((s(),p(x,{data:h.list},{default:l((()=>[o(_,{label:"消息标题",align:"center",prop:"title"}),o(_,{prop:"msgType",label:"类型",align:"center"},{default:l((({row:t})=>[m(d(h.typeDict[t.msgType]),1)])),_:1}),o(_,{prop:"status",label:"消息状态",align:"center"},{default:l((({row:t})=>[m(d(h.status[t.status]),1)])),_:1}),o(_,{label:"发送时间",align:"center",prop:"sendTime"}),o(_,{label:"操作",align:"center"},{default:l((({row:t})=>[o(v,{text:"",onClick:e=>k.edit(t,"detail")},{default:l((()=>[m("详情")])),_:2},1032,["onClick"]),["0","1"].includes(t.status+"")?(s(),p(v,{key:0,text:"",onClick:e=>k.edit(t,"edit")},{default:l((()=>[m("编辑")])),_:2},1032,["onClick"])):c("",!0),2==t.status?(s(),p(v,{key:1,text:"",onClick:e=>k.removke(t.id,"revoke","撤回")},{default:l((()=>[m("撤回")])),_:2},1032,["onClick"])):(s(),p(v,{key:2,onClick:e=>k.removke(t.id,"remove","删除"),text:""},{default:l((()=>[m("删除")])),_:2},1032,["onClick"]))])),_:1})])),_:1},8,["data"])),[[w,h.loading]]),u(o(C,{style:{"text-align":"center"},class:"mt20",total:h.total,background:!1,layout:"prev, pager, next",page:h.query.pageNum,"onUpdate:page":j[2]||(j[2]=t=>h.query.pageNum=t),limit:h.query.pageSize,"onUpdate:limit":j[3]||(j[3]=t=>h.query.pageSize=t),onPagination:j[4]||(j[4]=t=>k.getList())},null,8,["total","page","limit"]),[[g,h.total>0]])])}]]);export{y as default};
