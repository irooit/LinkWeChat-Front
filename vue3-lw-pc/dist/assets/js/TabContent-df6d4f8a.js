import{_ as e}from"../index-044285d2.js";import{_ as t}from"./quill-image-resize-module-c051113e.js";import{aU as s,ai as a,aq as r,o as i,c as o,V as l,T as p,X as n,a as u}from"./@vue-e400fd81.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";const m={name:"",components:{ChartLine:s((()=>e((()=>import("./ChartLine-b009fc4d.js")),["assets/js/ChartLine-b009fc4d.js","assets/js/echarts-8e7b9cd7.js","assets/js/tslib-a4e99503.js","assets/js/zrender-da4e2cf7.js","assets/index-044285d2.js","assets/js/js-cookie-8253c38e.js","assets/js/@vue-e400fd81.js","assets/js/vue-router-f8d53be7.js","assets/js/element-plus-68ba2566.js","assets/js/lodash-es-d4f5f48c.js","assets/js/@element-plus-214e0f7b.js","assets/js/@popperjs-b78c3215.js","assets/js/@ctrl-91de2ec7.js","assets/js/dayjs-c17bc6b2.js","assets/js/@babel-efd68da6.js","assets/js/to-fast-properties-1160b370.js","assets/js/async-validator-cf877c1f.js","assets/js/memoize-one-63ab667a.js","assets/js/normalize-wheel-es-3222b0a2.js","assets/js/@floating-ui-36fbce82.js","assets/css/element-plus-3888a320.css","assets/js/quill-image-resize-module-c051113e.js","assets/js/quill-c6b3d2fb.js","assets/js/quill-delta-a1872f89.js","assets/js/fast-diff-d5a53119.js","assets/js/lodash.clonedeep-1b6eefdc.js","assets/js/lodash.isequal-e7d08617.js","assets/js/@vueup-7cf8cfdd.js","assets/css/@vueup-da05906a.css","assets/css/quill-image-resize-module-44eb40f8.css","assets/js/pinia-1b56b17e.js","assets/js/vue-demi-71ba0ef2.js","assets/js/jsencrypt-43f479c1.js","assets/js/crypto-js-d6a67473.js","assets/js/ali-oss-912914b8.js","assets/js/axios-fb5f9e0e.js","assets/js/@vueuse-4025ce01.js","assets/js/path-browserify-289407ee.js","assets/js/nprogress-a39edb90.js","assets/css/nprogress-771398e6.css","assets/js/clipboard-7a0da8dc.js","assets/css/index-b5531375.css","assets/css/normalize-9d9ae4af.css","assets/js/lodash.merge-f1a4e0c2.js","assets/css/ChartLine-9d5ca891.css"]))),ChartBar:s((()=>e((()=>import("./ChartBar-39a01942.js")),["assets/js/ChartBar-39a01942.js","assets/js/echarts-8e7b9cd7.js","assets/js/tslib-a4e99503.js","assets/js/zrender-da4e2cf7.js","assets/index-044285d2.js","assets/js/js-cookie-8253c38e.js","assets/js/@vue-e400fd81.js","assets/js/vue-router-f8d53be7.js","assets/js/element-plus-68ba2566.js","assets/js/lodash-es-d4f5f48c.js","assets/js/@element-plus-214e0f7b.js","assets/js/@popperjs-b78c3215.js","assets/js/@ctrl-91de2ec7.js","assets/js/dayjs-c17bc6b2.js","assets/js/@babel-efd68da6.js","assets/js/to-fast-properties-1160b370.js","assets/js/async-validator-cf877c1f.js","assets/js/memoize-one-63ab667a.js","assets/js/normalize-wheel-es-3222b0a2.js","assets/js/@floating-ui-36fbce82.js","assets/css/element-plus-3888a320.css","assets/js/quill-image-resize-module-c051113e.js","assets/js/quill-c6b3d2fb.js","assets/js/quill-delta-a1872f89.js","assets/js/fast-diff-d5a53119.js","assets/js/lodash.clonedeep-1b6eefdc.js","assets/js/lodash.isequal-e7d08617.js","assets/js/@vueup-7cf8cfdd.js","assets/css/@vueup-da05906a.css","assets/css/quill-image-resize-module-44eb40f8.css","assets/js/pinia-1b56b17e.js","assets/js/vue-demi-71ba0ef2.js","assets/js/jsencrypt-43f479c1.js","assets/js/crypto-js-d6a67473.js","assets/js/ali-oss-912914b8.js","assets/js/axios-fb5f9e0e.js","assets/js/@vueuse-4025ce01.js","assets/js/path-browserify-289407ee.js","assets/js/nprogress-a39edb90.js","assets/css/nprogress-771398e6.css","assets/js/clipboard-7a0da8dc.js","assets/css/index-b5531375.css","assets/css/normalize-9d9ae4af.css","assets/js/lodash.merge-f1a4e0c2.js","assets/css/ChartBar-e0d67a11.css"])))},props:{type:{type:String,default:""},legend:{type:[Array,String],default:null},request:{type:Function,default:()=>{}},requestExport:{type:Function,default:()=>{}},option:{type:Object,default:null}},data:()=>({loading:!1,timeRange:7,total:0,list:[],xData:[],series:[],legendDict:{customerTotalChart:["客群总数"],customerTotalChart:["客群总数"]},dateRange:[],query:{pageNum:void 0,pageSize:void 0,deptIds:[],userIds:[],chatIds:[],ownerIds:[],beginTime:void 0,endTime:void 0},groupChats:[],tableProps:{customerTotalTable:[{prop:"xtime",label:"日期"},{prop:"totalCnt",label:"客户总数"},{prop:"addCnt",label:"新增客户"},{prop:"lostCnt",label:"流失客户"},{prop:"netCnt",label:"净增客户"},{prop:"gjCnt",label:"跟进客户"}],customerGroupTotalTable:[{prop:"xtime",label:"日期"},{prop:"totalCnt",label:"客群总数"},{prop:"addCnt",label:"新增客群数"},{prop:"dissolveCnt",label:"解散客群数"}],customerGroupMemberTotalTable:[{prop:"xtime",label:"日期"},{prop:"totalCnt",label:"客群成员总数"},{prop:"addCnt",label:"新增成员"},{prop:"quitCnt",label:"退出成员"}],customerContactTable:[{prop:"xtime",label:"日期"},{prop:"chatCnt",label:"单聊总数"},{prop:"messageCnt",label:"发送消息数"},{prop:"replyPercentage",label:"已回复聊天占比"},{prop:"avgReplyTime",label:"平均回复时长(分)"}],customerGroupContactTable:[{prop:"xtime",label:"日期"},{prop:"chatTotal",label:"群聊总数"},{prop:"msgTotal",label:"群聊消息数"},{prop:"memberHasMsg",label:"发送消息群成员数"}]},userArray:[],dialogVisible:!1,dialogType:"_users"}),computed:{},watch:{},created(){this.setTime(7)},mounted(){},methods:{getList(e){this.type.includes("Table")&&(this.query.pageSize||(this.query.pageSize=10)),this.dateRange?(this.query.beginTime=this.dateRange[0],this.query.endTime=this.dateRange[1]):(this.query.beginTime="",this.query.endTime=""),"_users"===this.dialogType?Array.isArray(this.userArray)?(this.query.deptIds=this.userArray.filter((e=>e.isParty)).map((e=>e.id)).join(","),this.query.userIds=this.userArray.filter((e=>!e.isParty)).map((e=>e.userId)).join(",")):this.query.deptIds=this.query.userIds="":"_groupOwners"===this.dialogType&&(Array.isArray(this.userArray)?this.query.ownerIds=this.userArray.filter((e=>!e.isParty)).map((e=>e.userId)).join(","):this.query.ownerIds=""),this.loading=!0,e&&(this.query.pageNum=e),this.request(this.query).then((({rows:e,total:t,data:s})=>{if(this.series=[],s=s||e,this.type.includes("Chart"))if(this.xData=s.map((e=>e.xtime)),"customerTotalChart,customerGroupTotalChart,customerGroupMemberTotalChart".includes(this.type))this.series=s.map((e=>e.totalCnt));else if("realDataChart"===this.type)this.series.push(s.map((e=>e.addCnt))),this.series.push(s.map((e=>e.lostCnt))),this.series.push(s.map((e=>e.netCnt))),this.series.push(s.map((e=>e.gjCnt)));else if("groupMemberChart"===this.type)this.series.push(s.map((e=>e.addCnt))),this.series.push(s.map((e=>e.quitCnt)));else{let e={singleChatTotalChart:"chatCnt",sendMessageNumChart:"messageCnt",replySingleChatChart:"replyPercentage",averageReplyDurationChart:"avgReplyTime",groupChatTotalChart:"chatTotal",groupChatMessageNumChart:"msgTotal",sendMessageGroupMemberChart:"memberHasMsg"};this.series=s.map((t=>t[e[this.type]]))}else"staffCustomerBar"===this.type?(this.xData=s.map((e=>e.userName)),this.series=s.map((e=>e.totalCnt))):this.type.includes("Table")&&(this.list=s,this.total=Number(t))})).catch((e=>{})).finally((()=>{this.loading=!1}))},getGroupList(e){getGroupList(e).then((({rows:e})=>{this.groupChats=e})).catch((()=>{}))},getTime(e){const t=e?new Date(e):new Date;return t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),t.toJSON().substr(0,10)},setTime(e){if(this.timeRange=e,e){let t=new Date;t.setDate(t.getDate()-e),this.dateRange=[this.getTime(t),this.getTime()],this.getList()}else this.dateRange=null},showDialog(e){this.dialogType=e,this.dialogVisible=!0},getSelectUser(e){this.userArray=e,this.query[this.dialogType]=e.map((e=>e.userId)).join(","),["customerGroupMemberTotalChart","customerGroupMemberTotalTable"].includes(this.type)&&(this.query.chatIds="",this.getGroupList({userIds:this.query[this.dialogType]})),this.getList()}}},h=u("div",{class:"operation"},null,-1);const d=t(m,[["render",function(e,t,s,u,m,d){const g=a("ChartLine"),y=a("ChartBar"),c=r("loading");return i(),o("div",null,[h,l((i(),o("div",null,[s.type.includes("Chart")?(i(),p(g,{key:0,xData:m.xData,legend:s.legend||m.legendDict[s.type],series:m.series,bgLinearGradient:e.$attrs.bgLinearGradient},null,8,["xData","legend","series","bgLinearGradient"])):"staffCustomerBar".includes(s.type)?(i(),p(y,{key:1,xData:m.xData,series:m.series},null,8,["xData","series"])):"rowEchart".includes("vChart")?(i(),p(g,{key:2,xData:m.xData,legend:s.legend||m.legendDict[s.type],series:m.series,option:s.option},null,8,["xData","legend","series","option"])):n("",!0)])),[[c,m.loading]])])}]]);export{d as default};
