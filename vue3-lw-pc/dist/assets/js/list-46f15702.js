import{u as e,k as t,l as a,m as l}from"./api-0004a25c.js";import{ai as i,aq as s,o,c as n,_ as r,U as u,K as d,a9 as p,T as m,Y as c,a as f,V as h,Z as g,X as y,$ as j,bl as b,bj as k}from"./@vue-e400fd81.js";import{_ as S}from"./quill-image-resize-module-c051113e.js";import"../index-044285d2.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";const C={name:"task-group-list",data:()=>({statusType:[{name:"待开始",key:1},{name:"进行中",key:2},{name:"已结束",key:3},{name:"已暂停",key:4}],query:{fassionType:2,pageSize:10,pageNum:1,fassionName:"",fassionState:""},total:0,loading:!1,list:[],selectList:[]}),methods:{setStateChange(t,a){let l="";3==t&&(l="是否确定结束当前任务？结束后无法继续执行活动，该不可撤销，请谨慎操作。"),2==t&&(l="是否确定启动当前任务？启动后立即生效，请谨慎操作。"),4==t&&(l="是否确定暂停当前任务？暂停后需手动重启，该不可撤销，请谨慎操作。"),this.$confirm(l,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>e({id:a.id,fassionState:t}))).then((()=>{this.handleSearch(),this.msgSuccess("操作成功")}))},selectable(e,t){if(2!==e.fassionState)return!0},setType(e){let t="";return this.infoType.forEach((a=>{a.key==e.type&&(t=a.name)})),t},setStatus(e){let t="";return this.statusType.forEach((a=>{a.key==e.fassionState&&(t=a.name)})),t},getList(){this.loading=!0,t(this.query).then((e=>{this.total=Number(e.total),this.list=e.rows,this.loading=!1}))},handleSearch(){this.query.pageNum=1,this.getList()},resetQuery(){this.query.pageNum=1,this.$refs.queryForm.resetFields(),this.getList()},handleSelectionChange(e){this.selectList=e.map((e=>e.id))},deleteFn(e){this.$confirm("是否确认删除当前裂变任务？删除后不可撤销，请谨慎操作。","删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>a(e.id))).then((()=>{this.handleSearch(),this.msgSuccess("删除成功")}))},deleteMult(){if(!this.selectList.length)return void this.msgInfo("请选择要删除项！");const e=this.selectList.join(",");this.$confirm("是否确认删除当前裂变任务？删除后不可撤销，请谨慎操作。","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>l(e))).then((()=>{this.handleSearch(),this.msgSuccess("删除成功")})).catch((function(){}))}},created(){this.getList(),this.$store.setBusininessDesc("\n        <div>通过任务形式，引导老客裂变新客加群，实现客群增长</div>\n      ")}},v=e=>(b("data-v-cc79b69e"),e=e(),k(),e),_={class:"g-card"},w={class:"mid-action"},q=v((()=>f("div",null,"在当前任务中员工已送达的客群总数",-1))),T=v((()=>f("div",null,"在当前任务中完成裂变任务的客户总数",-1))),N=v((()=>f("div",null,"在当前任务中成功添加客群的新客总数",-1)));const x=S(C,[["render",function(e,t,a,l,b,k){const S=i("el-input"),C=i("el-form-item"),v=i("el-option"),x=i("el-select"),L=i("el-button"),B=i("el-form"),F=i("el-table-column"),$=i("el-tag"),z=i("el-icon-QuestionFilled"),O=i("el-popover"),V=i("el-table"),Q=i("pagination"),U=s("loading");return o(),n("div",null,[r(B,{ref:"queryForm",model:b.query,inline:"",class:"top-search","label-position":"left","label-width":""},{default:u((()=>[r(C,{label:"",prop:"fassionName"},{default:u((()=>[r(S,{clearable:"",modelValue:b.query.fassionName,"onUpdate:modelValue":t[0]||(t[0]=e=>b.query.fassionName=e),placeholder:"请输入任务名称"},null,8,["modelValue"])])),_:1}),r(C,{label:"",prop:"fassionState"},{default:u((()=>[r(x,{"popper-append-to-body":!1,modelValue:b.query.fassionState,"onUpdate:modelValue":t[1]||(t[1]=e=>b.query.fassionState=e),placeholder:"请选择任务状态"},{default:u((()=>[r(v,{label:"全部任务状态",value:""}),(o(!0),n(d,null,p(b.statusType,((e,t)=>(o(),m(v,{key:t,label:e.name,value:e.key},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),r(C,{label:""},{default:u((()=>[r(L,{type:"primary",onClick:k.handleSearch},{default:u((()=>[c("查询")])),_:1},8,["onClick"]),r(L,{onClick:k.resetQuery},{default:u((()=>[c("重置")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"]),f("div",_,[f("div",w,[r(L,{type:"primary",onClick:t[2]||(t[2]=t=>e.$router.push("./add"))},{default:u((()=>[c("新建任务")])),_:1}),f("div",null,[r(L,{type:"primary",plain:"",disabled:0==b.selectList.length,onClick:k.deleteMult},{default:u((()=>[c("批量删除")])),_:1},8,["disabled","onClick"])])]),h((o(),m(V,{data:b.list,onSelectionChange:k.handleSelectionChange},{default:u((()=>[r(F,{type:"selection",width:"55",align:"center",fixed:"left",selectable:k.selectable},null,8,["selectable"]),r(F,{prop:"fassionName",label:"任务名称",align:"center",width:"120",fixed:"left"}),r(F,{prop:"statusType",label:"任务状态",align:"center",width:"100"},{default:u((({row:e})=>[r($,{type:1==e.fassionState?"info":3==e.fassionState?"danger":""},{default:u((()=>[c(g(k.setStatus(e)),1)])),_:2},1032,["type"])])),_:1}),r(F,{prop:"fassionStartTime",label:"任务开始时间",align:"center",width:"180"},{default:u((({row:e})=>[c(g(e.fassionStartTime||"-"),1)])),_:1}),r(F,{prop:"fassionEndTime",label:"任务结束时间",align:"center",width:"180"},{default:u((({row:e})=>[c(g(e.fassionEndTime||"-"),1)])),_:1}),r(F,{prop:"inviterOldCustomerNum",label:"员工触达客群总数",align:"center",width:"150"},{header:u((()=>[r(O,{placement:"top",trigger:"hover"},{reference:u((()=>[f("div",null,[c(" 员工触达客群总数 "),r(z,{class:"el-icon-QuestionFilled"})])])),default:u((()=>[q])),_:1})])),default:u((({row:e})=>[c(g(null==e.inviterOldCustomerNum?"-":e.inviterOldCustomerNum),1)])),_:1}),r(F,{prop:"completeTaskOldCustomerNum",label:"完成任务客户总数",align:"center",width:"150"},{header:u((()=>[r(O,{placement:"top",trigger:"hover"},{reference:u((()=>[f("div",null,[c(" 完成任务客户总数 "),r(z,{class:"el-icon-QuestionFilled"})])])),default:u((()=>[T])),_:1})])),default:u((({row:e})=>[c(g(null==e.completeTaskOldCustomerNum?"-":e.completeTaskOldCustomerNum),1)])),_:1}),r(F,{prop:"fissionCustomerNum",label:"裂变新客总数",align:"center",width:"140"},{header:u((()=>[r(O,{placement:"top",trigger:"hover"},{reference:u((()=>[f("div",null,[c(" 裂变新客总数 "),r(z,{class:"el-icon-QuestionFilled"})])])),default:u((()=>[N])),_:1})])),default:u((({row:e})=>[c(g(null==e.fissionCustomerNum?"-":e.fissionCustomerNum),1)])),_:1}),r(F,{prop:"createBy",label:"创建人",align:"center"}),r(F,{prop:"updateTime",label:"最近操作时间",align:"center",width:"180"}),r(F,{label:"操作",align:"center",width:"180",fixed:"right"},{default:u((({row:t})=>[r(L,{text:"",onClick:a=>e.$router.push({path:"./detail",query:{id:t.id}})},{default:u((()=>[c("详情|统计")])),_:2},1032,["onClick"]),1==t.fassionState?(o(),m(L,{key:0,text:"",onClick:a=>e.$router.push({path:"./add",query:{id:t.id}})},{default:u((()=>[c(" 编辑 ")])),_:2},1032,["onClick"])):y("",!0),2==t.fassionState||4==t.fassionState?(o(),m(L,{key:1,text:"",onClick:e=>k.setStateChange(3,t)},{default:u((()=>[c("结束")])),_:2},1032,["onClick"])):y("",!0),2==t.fassionState?(o(),m(L,{key:2,text:"",onClick:e=>k.setStateChange(4,t)},{default:u((()=>[c("暂停")])),_:2},1032,["onClick"])):y("",!0),4==t.fassionState?(o(),m(L,{key:3,text:"",onClick:e=>k.setStateChange(2,t)},{default:u((()=>[c("启动")])),_:2},1032,["onClick"])):y("",!0),2!==t.fassionState&&4!==t.fassionState?(o(),m(L,{key:4,text:"",onClick:e=>k.deleteFn(t)},{default:u((()=>[c(" 删除 ")])),_:2},1032,["onClick"])):y("",!0)])),_:1})])),_:1},8,["data","onSelectionChange"])),[[U,b.loading]]),h(r(Q,{total:b.total,page:b.query.pageNum,"onUpdate:page":t[3]||(t[3]=e=>b.query.pageNum=e),limit:b.query.pageSize,"onUpdate:limit":t[4]||(t[4]=e=>b.query.pageSize=e),onPagination:k.getList},null,8,["total","page","limit","onPagination"]),[[j,b.total>0]])])])}],["__scopeId","data-v-cc79b69e"]]);export{x as default};
