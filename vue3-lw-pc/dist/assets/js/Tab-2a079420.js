import e from"./PreviewInPhone-9ed75a0f.js";import{g as t,r as i}from"./welcome-6ff4c53e.js";import{t as l}from"./modleCenter-5112f339.js";import{_ as a}from"./quill-image-resize-module-c051113e.js";import{ai as s,aq as o,o as r,c as n,_ as p,U as m,T as u,X as d,Y as h,a as c,Z as g,V as f}from"./@vue-e400fd81.js";import"./quill-c6b3d2fb.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";import"../index-044285d2.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";const y={class:"left"},j={class:"g-card"},w={class:"mid-action"},v={class:"dialog-footer"};const b=a({name:"Tab2",components:{PreviewInPhone:e},props:{type:{type:[Number,String],default:"1"}},data:()=>({userArray:[],qrUserName:void 0,ids:[],query:{pageNum:1,pageSize:10,tplType:1,templateType:1},dialogVisible:!1,loading:!1,total:0,list:[],wel:{1:"活码",2:"员工",3:"入群"},showPreviewDialog:!1,previewList:[],templateInfo:"",materialMsgList:[]}),watch:{},computed:{},created(){this.query.tplType=+this.type,this.getList()},mounted(){},methods:{resetQuery(){2==this.type&&(this.query.userId=""),this.query.templateInfo="",this.userArray=[],this.qrUserName="",this.query.pageNum=1,this.getList()},getSelectUser(e){this.userArray=e,this.qrUserName=this.userArray.map((function(e,t){return e.name})).join(","),this.query.userId=this.userArray.map((function(e,t){return e.userId})).join(",")},handleSelectionChange(e){this.ids=e.map((e=>e.id))},getList(e){e&&(this.query.pageNum=e),this.loading=!0,this.query.tplType=this.type,t(this.query).then((({rows:e,total:t})=>{this.list=e,this.total=+t,this.loading=!1})).catch((()=>{this.loading=!1}))},remove(e){this.$confirm("是否确认删除吗?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>i(e))).then((()=>{this.getList(),this.msgSuccess("删除成功")}))},removeMult(){this.ids.length?this.$confirm("是否确认删除吗?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>i(this.ids.join(",")))).then((()=>{this.getList(),this.msgSuccess("删除成功")})):this.msgInfo("请勾选需要删除的项！")},goRoute(e){let t={};e?(localStorage.setItem("obj",JSON.stringify(e)),t.id=e.id,t.tplType=this.type):t.tplType=this.type,this.$router.push({path:"add",query:t})},showPreview(e){this.templateInfo=e.templateInfo,this.getDeatil(e.id),this.showPreviewDialog=!0},getDeatil(e){this.loading=!0,l(e).then((e=>{this.previewList=e.data.weMaterialList,this.loading=!1})).catch((()=>{this.loading=!1}))}}},[["render",function(e,t,i,l,a,b){const q=s("el-input"),_=s("el-form-item"),I=s("el-button"),C=s("el-form"),k=s("el-table-column"),S=s("el-table"),U=s("pagination"),x=s("PreviewInPhone"),N=s("el-dialog"),P=s("SelectUser"),T=o("loading");return r(),n("div",y,[p(C,{"label-position":"left",inline:"","label-width":"",class:"top-search"},{default:m((()=>[p(_,{label:"欢迎语"},{default:m((()=>[p(q,{placeholder:"请输入欢迎语",modelValue:a.query.templateInfo,"onUpdate:modelValue":t[0]||(t[0]=e=>a.query.templateInfo=e),style:{width:"260px"}},null,8,["modelValue"])])),_:1}),"2"===i.type?(r(),u(_,{key:0,label:"选择员工",prop:"qrUserName"},{default:m((()=>[p(q,{"model-value":a.qrUserName,readonly:"",onClick:t[1]||(t[1]=e=>a.dialogVisible=!0),placeholder:"请选择员工"},null,8,["model-value"])])),_:1})):d("",!0),p(_,{"label-width":"0"},{default:m((()=>[p(I,{type:"primary",onClick:t[2]||(t[2]=e=>b.getList(0))},{default:m((()=>[h("查询")])),_:1}),p(I,{onClick:b.resetQuery},{default:m((()=>[h("重置")])),_:1},8,["onClick"])])),_:1})])),_:1}),c("div",j,[c("div",w,[p(I,{type:"primary",onClick:t[3]||(t[3]=e=>b.goRoute())},{default:m((()=>[h("新建"+g(a.wel[i.type])+"欢迎语",1)])),_:1}),p(I,{style:{"align-self":"flex-end"},type:"primary",plain:"",onClick:t[4]||(t[4]=e=>b.removeMult())},{default:m((()=>[h("批量删除")])),_:1})]),f((r(),u(S,{data:a.list,onSelectionChange:b.handleSelectionChange,"max-height":"calc(100vh - 420px)"},{default:m((()=>[p(k,{type:"selection",width:"55",align:"center"}),p(k,{label:"欢迎语",align:"center",prop:"welcomeMsg","min-width":"250","show-overflow-tooltip":""},{default:m((e=>[h(g(e.row.templateInfo),1)])),_:1}),"2"===i.type?(r(),u(k,{key:0,label:"员工",prop:"userNames",align:"center"})):d("",!0),p(k,{label:"附件",align:"center",prop:"attachTotalNum"}),p(k,{label:"最近更新",align:"center"},{default:m((e=>[c("div",null,g(e.row.updateBy),1),c("span",null,g(e.row.updateTime),1)])),_:1}),p(k,{label:"操作",align:"center"},{default:m((e=>[p(I,{text:"",onClick:t=>b.showPreview(e.row)},{default:m((()=>[h("预览")])),_:2},1032,["onClick"]),p(I,{text:"",onClick:t=>b.goRoute(e.row)},{default:m((()=>[h("编辑")])),_:2},1032,["onClick"]),p(I,{text:"",onClick:t=>b.remove(e.row.id)},{default:m((()=>[h("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","onSelectionChange"])),[[T,a.loading]]),p(U,{total:a.total,page:a.query.pageNum,"onUpdate:page":t[5]||(t[5]=e=>a.query.pageNum=e),limit:a.query.pageSize,"onUpdate:limit":t[6]||(t[6]=e=>a.query.pageSize=e),onPagination:t[7]||(t[7]=e=>b.getList())},null,8,["total","page","limit"])]),p(N,{title:"预览",modelValue:a.showPreviewDialog,"onUpdate:modelValue":t[9]||(t[9]=e=>a.showPreviewDialog=e),width:"50%"},{footer:m((()=>[c("span",v,[p(I,{type:"primary",onClick:t[8]||(t[8]=e=>a.showPreviewDialog=!1)},{default:m((()=>[h("关闭")])),_:1})])])),default:m((()=>[p(x,{list:a.previewList,templateInfo:a.templateInfo},null,8,["list","templateInfo"])])),_:1},8,["modelValue"]),p(P,{visible:a.dialogVisible,"onUpdate:visible":t[10]||(t[10]=e=>a.dialogVisible=e),title:"组织架构",defaultValues:a.userArray,onSuccess:b.getSelectUser},null,8,["visible","defaultValues","onSuccess"])])}],["__scopeId","data-v-d12e1dff"]]);export{b as default};
