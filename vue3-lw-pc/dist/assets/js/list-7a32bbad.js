import{e,g as i,s as t,a as l,r as s}from"./commodityManage-9fcb714b.js";import{ai as a,aq as o,o as r,c as n,_ as m,U as d,Y as p,a as c,V as u,T as g,Z as h,$ as f,K as b,a9 as y,bl as j,bj as v}from"./@vue-e400fd81.js";import{_}from"./quill-image-resize-module-c051113e.js";import"../index-044285d2.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";const x={picture:"",price:1,describe:"",attachments:[]},L={components:{},props:{},data:()=>({query:{pageNum:1,pageSize:10,name:""},loading:!1,submitLoading:!1,dialogVisible:!1,form:JSON.parse(JSON.stringify(x)),newInput:"",newInputVisible:!1,rules:Object.freeze({picture:[{required:!0,message:"必填项",trigger:"change"}],price:[{required:!0,message:"必填项",trigger:"change"}],describe:[{required:!0,message:"必填项",trigger:"blur"}]}),ids:[],multiple:!0,total:0,list:[],lastSyncTime:0,fileList:[]}),computed:{},created(){this.$store.setBusininessDesc("\n\t\t\t     <div>快捷创建商品图册，员工一键发送给客户，客户直接购买。</div>\n\t\t\t   "),this.getList()},methods:{resetForm(){this.query.name="",this.getList(1)},getList(i){i&&(this.query.pageNum=i),this.loading=!0,e(this.query).then((({rows:e,total:i,lastSyncTime:t})=>{this.list=e,this.total=+i,this.lastSyncTime=t,this.loading=!1})).catch((()=>{this.loading=!1}))},edit(e){this.fileList=[],e?i(e.id).then((e=>{if(this.form=e.data,this.form.attachments){this.form.attachments.split(",").forEach((e=>{this.fileList.push({url:e})}))}})):this.form=JSON.parse(JSON.stringify(x)),this.dialogVisible=!0},sync(){const e=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});t().then((()=>{e.close(),this.msgSuccess("后台开始同步数据，请稍后关注进度"),this.getList()})).catch((()=>{e.close()}))},submit(){this.$refs.form.validate((e=>{var i;let t=JSON.parse(JSON.stringify(this.form));t.price=null==(i=+t.price)?void 0:i.toFixed(2),t.attachments=this.fileList.map((e=>e.url)).join(","),this.submitLoading=!0,l[t.id?"update":"add"](t,t.id).then((()=>{this.msgSuccess("操作成功"),this.dialogVisible=!1,this.getList()})).finally((()=>{this.submitLoading=!1}))}))},handleSelectionChange(e){this.ids=e.map((e=>e.id)),this.multiple=!e.length},remove(e){const i=e||this.ids+"";this.$confirm("是否确认删除吗?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return s(i)})).then((()=>{this.getList(),this.msgSuccess("删除成功")}))},goRoute(e){this.$router.push({path:"./detail",query:{id:e.id}})}}},k=e=>(j("data-v-09730a18"),e=e(),v(),e),q={class:"g-card"},w={class:"mid-action"},S={style:{display:"flex"}},V={class:"limit_span"},C={class:"flex"},U={span:12},z=k((()=>c("div",{class:"tip"},"支持jpg/png格式，图片大小不超过10M",-1))),N=k((()=>c("div",{class:"tip"},"精确到小数点后两位，不超过5万元",-1))),T=k((()=>c("div",{class:"tip"},"最多添加八张详情",-1))),O={span:12},J={class:"phone-content"},$={key:1,class:"commodity-img commodity-thumb"},B={class:"price"},F={class:"content"},I={class:"dialog-footer ar"};const R=_(L,[["render",function(e,i,t,l,s,j){const v=a("el-input"),_=a("el-form-item"),x=a("el-button"),L=a("el-form"),k=a("el-table-column"),R=a("el-image"),M=a("el-table"),A=a("pagination"),D=a("upload"),E=a("el-input-number"),K=a("PhoneTemplate"),P=a("el-dialog"),Y=o("loading");return r(),n("div",null,[m(L,{ref:"queryForm",inline:!0,model:s.query,"label-width":"110px",class:"top-search"},{default:d((()=>[m(_,{label:"商品名称或描述",prop:"name"},{default:d((()=>[m(v,{clearable:"",modelValue:s.query.name,"onUpdate:modelValue":i[0]||(i[0]=e=>s.query.name=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1}),m(_,{label:""},{default:d((()=>[m(x,{type:"primary",onClick:i[1]||(i[1]=e=>j.getList(1))},{default:d((()=>[p("查询")])),_:1}),m(x,{onClick:i[2]||(i[2]=e=>j.resetForm())},{default:d((()=>[p("重置")])),_:1})])),_:1})])),_:1},8,["model"]),c("div",q,[c("div",w,[m(x,{type:"primary",class:"mr10",onClick:i[3]||(i[3]=e=>j.edit())},{default:d((()=>[p("新建商品")])),_:1}),m(x,{disabled:!s.ids.length,type:"danger",onClick:i[4]||(i[4]=e=>j.remove())},{default:d((()=>[p("批量删除")])),_:1},8,["disabled"])]),u((r(),g(M,{data:s.list,onSelectionChange:j.handleSelectionChange},{default:d((()=>[m(k,{type:"selection",width:"55",align:"center"}),m(k,{label:"商品",align:"center",prop:"",width:"200"},{default:d((({row:e})=>[c("div",S,[m(R,{style:{width:"50px",height:"50px","margin-right":"5px","flex-shrink":"0"},src:e.picture},null,8,["src"]),c("span",V,h(e.describe),1)])])),_:1}),m(k,{label:"单价(元)",align:"center",prop:"price"}),m(k,{label:"订单总数",align:"center",prop:"orderNum"}),m(k,{label:"订单总额(元)",align:"center",prop:"orderTotalAmount"}),m(k,{label:"创建人",align:"center",prop:"createBy"}),m(k,{label:"最近操作时间",align:"center",prop:"updateTime",width:"180"}),m(k,{label:"操作",align:"center"},{default:d((({row:e,index:i})=>[m(x,{text:"",onClick:i=>j.goRoute(e)},{default:d((()=>[p("详情")])),_:2},1032,["onClick"]),m(x,{text:"",onClick:t=>j.edit(e,i)},{default:d((()=>[p("编辑")])),_:2},1032,["onClick"]),m(x,{text:"",onClick:i=>j.remove(e.id)},{default:d((()=>[p("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","onSelectionChange"])),[[Y,s.loading]]),u(m(A,{total:s.total,page:s.query.pageNum,"onUpdate:page":i[5]||(i[5]=e=>s.query.pageNum=e),limit:s.query.pageSize,"onUpdate:limit":i[6]||(i[6]=e=>s.query.pageSize=e),onPagination:i[7]||(i[7]=e=>j.getList())},null,8,["total","page","limit"]),[[f,s.total>0]])]),m(P,{title:s.form.id?"修改":"新建",modelValue:s.dialogVisible,"onUpdate:modelValue":i[13]||(i[13]=e=>s.dialogVisible=e),"close-on-click-modal":!1,width:"auto"},{footer:d((()=>[c("div",I,[u((r(),g(x,{type:"primary",onClick:j.submit},{default:d((()=>[p("确 定")])),_:1},8,["onClick"])),[[Y,s.submitLoading]]),m(x,{onClick:i[12]||(i[12]=e=>s.dialogVisible=!1)},{default:d((()=>[p("取 消")])),_:1})])])),default:d((()=>[c("div",C,[c("div",U,[m(L,{ref:"form",model:s.form,rules:s.rules,"label-width":"130px"},{default:d((()=>[m(_,{label:"商品封面",prop:"picture"},{default:d((()=>[m(D,{fileUrl:s.form.picture,"onUpdate:fileUrl":i[8]||(i[8]=e=>s.form.picture=e),type:"0",maxSize:10,format:["jpg","png"]},{tip:d((()=>[z])),_:1},8,["fileUrl"])])),_:1}),m(_,{label:"商品单价(元)",prop:"price"},{default:d((()=>[m(E,{modelValue:s.form.price,"onUpdate:modelValue":i[9]||(i[9]=e=>s.form.price=e),precision:2,step:.1,min:0,max:5e4},null,8,["modelValue"]),N])),_:1}),m(_,{label:"商品标题或描述",prop:"describe"},{default:d((()=>[m(v,{modelValue:s.form.describe,"onUpdate:modelValue":i[10]||(i[10]=e=>s.form.describe=e),type:"textarea",maxlength:270,"show-word-limit":"",autosize:{minRows:4,maxRows:50},placeholder:"请输入"},null,8,["modelValue"])])),_:1}),m(_,{label:"商品详情"},{default:d((()=>[m(D,{fileList:s.fileList,"onUpdate:fileList":i[11]||(i[11]=e=>s.fileList=e),multiple:!0,limit:8,type:"0",maxSize:10,format:["jpg","png"]},{tip:d((()=>[T])),_:1},8,["fileList"])])),_:1})])),_:1},8,["model","rules"])]),c("div",O,[m(K,null,{default:d((()=>[c("div",J,[s.form.picture?(r(),g(R,{key:0,class:"commodity-img commodity-thumb",style:{width:"100%"},src:s.form.picture},null,8,["src"])):(r(),n("div",$)),c("div",B,"￥"+h(s.form.price),1),c("div",F,h(s.form.describe),1),(r(!0),n(b,null,y(s.fileList,((e,i)=>(r(),g(R,{class:"commodity-img",src:e.url,key:i},null,8,["src"])))),128))])])),_:1})])])])),_:1},8,["title","modelValue"])])}],["__scopeId","data-v-09730a18"]]);export{R as default};
