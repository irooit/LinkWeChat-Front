import e from"./PreviewInPhone-9ed75a0f.js";import"./group-16414119.js";import{_ as t}from"./quill-image-resize-module-c051113e.js";import{ai as l,o as a,c as s,_ as i,U as r,a as o,Y as m,Z as n,K as p,a9 as d,T as c,X as u,bl as f,bj as h}from"./@vue-e400fd81.js";import"./quill-c6b3d2fb.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";import"../index-044285d2.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";const g={components:{PreviewInPhone:e},data:()=>({showSelectTag:!1,templateInfo:"",talkList:[],clipboard:null,functionList:[{svg:"redBox",name:"红包拉新",content:"给新客户发送红包",active:!0},{svg:"card",name:"卡券拉新",content:"给新客户发送微信卡券",active:!1}],groupId:null,pullnewsInfo:{qrType:1,materialName:""}}),props:{form:{type:Object,default:{}}},mounted(){this.clipboard=new this.ClipboardJS("#copyUrl")},unmounted(){this.clipboard.destroy()},methods:{dealInfo(e){let t=[];return e&&e.length&&e.forEach((e=>{switch(e.scopeType){case 1:t.push(e.userName);break;case 2:t.push(e.partyName);break;case 3:t.push(e.position)}})),t},dealTag(e){let t=[];return e&&e.length&&e.forEach((e=>{t.push(e.tagName)})),t},dealTable(e){let t="";e&&(t=JSON.parse(e));let l=[];return l.push(t),l},dealList(e){let t=[];return e?(e.forEach((e=>{"text"===e.msgType?this.templateInfo=e.content:t.push(e)})),this.setAttachments(t)):t},setAttachments(e){let t=[];return e&&e.length&&e.forEach((e=>{if("image"===e.msgType){let l={mediaType:"0",materialUrl:e.picUrl};t.push(l)}else if("video"===e.msgType){let l={mediaType:"2",materialUrl:e.fileUrl,coverUrl:e.picUrl,digest:e.description,materialName:e.title};t.push(l)}else if("file"===e.msgType){let l={mediaType:"3",materialUrl:e.fileUrl,digest:e.description,materialName:e.title};t.push(l)}else if("text"===e.msgType){let l={mediaType:"4",content:e.content};t.push(l)}else if("link"===e.msgType){let l={mediaType:"9",content:e.content,coverUrl:e.picUrl,materialUrl:e.linkUrl,materialName:e.title};t.push(l)}else if("miniprogram"===e.msgType){let l={mediaType:"11",digest:e.appId,materialName:e.title,coverUrl:e.picUrl,materialUrl:e.fileUrl};t.push(l)}else if("news"===e.msgType){let l={mediaType:"12",digest:e.description,materialUrl:e.fileUrl,coverUrl:e.picUrl,content:e.content,materialName:e.title};t.push(l)}else if("posters"===e.msgType){let l={mediaType:"5",materialUrl:e.fileUrl,materialName:e.title};t.push(l)}})),t},goRouter(){this.$router.push("add?groupCodeId="+this.$route.query.groupId)},handleDownload(e,t){let l=new Image;l.setAttribute("crossOrigin","anonymous"),l.src=e,l.onload=()=>{let e=document.createElement("canvas");e.width=l.width,e.height=l.height,e.getContext("2d").drawImage(l,0,0,l.width,l.height),e.toBlob((e=>{let l=URL.createObjectURL(e),a=document.createElement("a");a.download=t,a.href=l,a.click(),a.remove(),URL.revokeObjectURL(l)}))}}}},j=e=>(f("data-v-5a2e045a"),e=e(),h(),e),y={class:"g-card",style:{"min-height":"1040px"}},b={class:"card-title"},v=j((()=>o("span",null,"活码信息",-1))),U={class:"card-content"},w={class:"function"},T={class:"function-item active-item"},I={class:"item-text"},_={class:"redForm"},x=j((()=>o("div",{class:"redTitle"},"选择红包：",-1))),k={class:"red-packet-message"},L={class:"red-packet-text"},N={class:"g-card right-card-title"},q=j((()=>o("span",null,"活码预览",-1))),C={class:"code-wrapper"},E={class:"code-actions"},P={class:"g-card right-card-title"},D=j((()=>o("span",null,"欢迎语预览",-1)));const O=t(g,[["render",function(e,t,f,h,g,j){const O=l("el-button"),R=l("el-input"),A=l("el-form-item"),z=l("svg-icon"),B=l("el-tag"),J=l("el-table-column"),S=l("el-table"),V=l("el-col"),K=l("el-row"),$=l("el-form"),F=l("el-image"),M=l("PreviewInPhone");return a(),s("div",null,[i(K,{type:"flex",justify:"space-between"},{default:r((()=>[i(V,{span:16,class:"boxClass left radius"},{default:r((()=>[o("div",y,[o("div",b,[v,i(O,{type:"primary",onClick:j.goRouter},{default:r((()=>[m("编辑")])),_:1},8,["onClick"])]),o("div",U,[i(K,null,{default:r((()=>[i(V,{sm:24,md:16,lg:14},{default:r((()=>[i($,{model:f.form,ref:"form","label-width":"140px"},{default:r((()=>[i(K,null,{default:r((()=>[i(V,{sm:24,md:18},{default:r((()=>[i(A,{label:"活码名称:",class:"pb20"},{default:r((()=>[i(R,{modelValue:f.form.name,"onUpdate:modelValue":t[0]||(t[0]=e=>f.form.name=e),placeholder:"请输入名称","show-word-limit":"",maxlength:"15",disabled:!0},null,8,["modelValue"])])),_:1}),i(A,{label:"拉新方式:",class:"pb20"},{default:r((()=>[o("div",w,[o("div",T,[i(z,{class:"icon-style",icon:"redBox"}),o("div",null,[o("span",null,n(g.functionList[0].name),1),o("div",I,n(g.functionList[0].content),1)])])])])),_:1}),i(A,{label:"添加员工:",prop:"chatIdList",class:"pb20"},{default:r((()=>[(a(!0),s(p,null,d(j.dealInfo(f.form.qrUserInfos),((e,t)=>(a(),s(p,{key:t},[e?(a(),c(B,{key:0},{default:r((()=>[m(n(e),1)])),_:2},1024)):u("",!0)],64)))),128))])),_:1}),i(A,{label:"添加标签:",class:"pb20"},{default:r((()=>[(a(!0),s(p,null,d(j.dealTag(f.form.qrTags),((e,t)=>(a(),s(p,{key:t},[e?(a(),c(B,{key:0},{default:r((()=>[m(n(e),1)])),_:2},1024)):u("",!0)],64)))),128))])),_:1}),o("div",_,[x,j.dealTable(f.form.businessData)?(a(),c(S,{key:0,data:j.dealTable(f.form.businessData),class:"mr10"},{default:r((()=>[i(J,{width:"300",label:"红包",align:"center",prop:"name"},{default:r((({row:e})=>[o("div",k,[o("div",L,n(e.name),1)])])),_:1}),i(J,{label:"红包金额(元)",align:"center",prop:"money"})])),_:1},8,["data"])):u("",!0)])])),_:1})])),_:1})])),_:1},8,["model"])])),_:1})])),_:1})])])])),_:1}),i(V,{span:8,style:{"margin-top":"0"}},{default:r((()=>[o("div",N,[q,o("div",C,[i(F,{src:f.form.imageUrl,class:"code-image",style:{width:"160px",height:"200px"}},null,8,["src"]),o("div",E,[i(O,{text:"",onClick:t[1]||(t[1]=e=>j.handleDownload(f.form.imageUrl,f.form.name))},{default:r((()=>[m("下载二维码")])),_:1}),i(O,{id:"copyUrl",text:"","data-clipboard-text":f.form.linkPath},{default:r((()=>[m("复制链接")])),_:1},8,["data-clipboard-text"])])])]),o("div",P,[D,i(M,{list:j.dealList(f.form.qrAttachments),templateInfo:g.templateInfo,pullnewsInfo:{qrType:1,materialName:j.dealTable(f.form.businessData)[0].name},name:"新客户"},null,8,["list","templateInfo","pullnewsInfo"])])])),_:1})])),_:1})])}],["__scopeId","data-v-5a2e045a"]]);export{O as default};
