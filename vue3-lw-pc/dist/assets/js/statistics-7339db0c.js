import e from"./ChartLine-b009fc4d.js";import t from"./SearchTitle-ceb204ee.js";import{i,j as a}from"./api-49257dfd.js";import s from"./SelectDept-7a07b4de.js";import r from"./chatList-2d846d6f.js";import{_ as l}from"./quill-image-resize-module-c051113e.js";import{ai as o,aq as p,o as d,c as n,_ as m,a as u,U as h,Y as c,V as g,T as j,Z as b,X as y}from"./@vue-e400fd81.js";import"./echarts-8e7b9cd7.js";import"./tslib-a4e99503.js";import"./zrender-da4e2cf7.js";import"../index-044285d2.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";import"./lodash.merge-f1a4e0c2.js";import"./moment-8163541f.js";import"./organization-9bed3593.js";import"./chatListClassTab-de00b2d7.js";import"./chatList-17de18bb.js";import"./ChatContent-f938bb33.js";import"./benz-amr-recorder-259e7c16.js";const v={name:"quality-statistics",components:{SearchTitle:t,ChartLine:e,SelectDept:s,ChatList:r},data:()=>({deptArray:[],deptName:"",dialogDeptVisible:!1,dialogVisible:!1,userArray:[],userName:"",cardData:[{title:"总超时次数",tips:"成员在会话中未能及时回复的次数，仅计算产生双方参与的会话次数",value:0},{title:"总超时率",tips:"成员在会话中未能及时回复的次数/双方共产生会话的次数",value:0},{title:"今日超时人数",tips:"今日未能及时回复用户会话的成员人数",value:0},{title:"今日超时次数",tips:"今日成员在会话中未能及时回复的次数",value:0},{title:"今日超时率",tips:"今日成员在会话中未能及时回复的次数/今日双方共产生会话的次数",value:0}],value:[],id:"",exportLoading:!1,tableList:[],loading:!1,total:0,query:{pageSize:10,pageNum:1,beginTime:"",endTime:"",deptIds:"",userIds:""},tableSearch:{},showChat:!1,queryChat:{formId:"",msgId:"",pageType:0,receiveId:"",roomId:""}}),methods:{showChatList(e){this.queryChat={fromId:e.fromId,msgId:e.msgId,pageType:0,receiveId:e.receiveId,roomId:e.roomId},this.showChat=!0},handleSearch(){this.getTableChangeSize()},resetQuery(){this.query={pageSize:10,pageNum:1,beginTime:"",endTime:"",deptIds:"",userIds:""},this.userArray=[],this.userName="",this.deptArray=[],this.deptName="",this.getTableChangeSize()},getSelectUser(e){this.userArray=e,this.userName=this.userArray.map((function(e,t){return e.name})).join(","),this.query.userIds=this.userArray.map((function(e,t){return e.userId})).join(",")},selectedDept(e){this.deptArray=e,this.deptName=this.deptArray.map((function(e,t){return e.deptName})).join(","),this.query.deptIds=this.userArray.map((function(e,t){return e.deptId})).join(",")},getTabTotalFn(){i(this.id).then((e=>{this.cardData[0].value=e.data.timeOutTotalNum,this.cardData[1].value=100*Number(e.data.timeOutTotalRate)+"%",this.cardData[2].value=e.data.todayTimeOutUserNum,this.cardData[3].value=e.data.todayTimeOutNum,this.cardData[4].value=100*Number(e.data.todayTimeOutRate)+"%"}))},getTableChangeSize(){this.loading=!0,a(this.id,Object.assign({},this.query)).then((e=>{this.tableList=e.rows,this.total=Number(e.total),this.loading=!1}))},getTableFn(e){this.tableSearch=e,this.loading=!0,this.query.beginTime=e.beginTime,this.query.endTime=e.endTime,this.getTableChangeSize()}},created(){this.id=this.$route.query.id,this.getTabTotalFn()}},f={class:"g-card"},C=u("div",{class:"g-card-title"},"数据报表",-1),T={style:{display:"flex","align-items":"center"}};const w=l(v,[["render",function(e,t,i,a,s,r){const l=o("CardGroupIndex"),v=o("search-title"),w=o("el-input"),S=o("el-button"),q=o("el-table-column"),I=o("el-table"),N=o("pagination"),D=o("SelectUser"),z=o("SelectDept"),L=o("ChatList"),A=p("loading");return d(),n("div",null,[m(l,{data:s.cardData},null,8,["data"]),u("div",f,[C,u("div",T,[m(v,{showMore:!0,onSearch:r.getTableFn},null,8,["onSearch"]),m(w,{style:{width:"150px"},"model-value":s.userName,readonly:"",onClick:t[0]||(t[0]=e=>s.dialogVisible=!0),placeholder:"请选择成员"},null,8,["model-value"]),m(w,{style:{width:"150px",margin:"0 20px"},"model-value":s.deptName,readonly:"",onClick:t[1]||(t[1]=e=>s.dialogDeptVisible=!0),placeholder:"请选择部门"},null,8,["model-value"]),m(S,{type:"primary",onClick:r.handleSearch},{default:h((()=>[c("查询")])),_:1},8,["onClick"]),m(S,{onClick:r.resetQuery},{default:h((()=>[c("重置")])),_:1},8,["onClick"])]),g((d(),j(I,{data:s.tableList,style:{width:"100%"}},{default:h((()=>[m(q,{label:"成员名称",align:"center",prop:"userName","min-width":"100","show-overflow-tooltip":""}),m(q,{label:"所属部门",align:"center",prop:"deptName","show-overflow-tooltip":""}),m(q,{label:"所属会话",align:"center",prop:"chatName","show-overflow-tooltip":""}),m(q,{label:"会话类型",align:"center",prop:"chatType","show-overflow-tooltip":""},{default:h((({row:e})=>[u("div",null,b(1==e.chatType?"客户会话":"客群会话"),1)])),_:1}),m(q,{label:"超时时长",align:"center",prop:"timeout","show-overflow-tooltip":""}),m(q,{label:"触发时间",align:"center",prop:"createTime",width:"180","show-overflow-tooltip":""}),m(q,{label:"操作",align:"center",fixed:"right",width:"180"},{default:h((({row:e})=>[m(S,{text:"",onClick:t=>r.showChatList(e)},{default:h((()=>[c("查看")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[A,s.loading]]),m(N,{total:s.total,page:s.query.pageNum,"onUpdate:page":t[2]||(t[2]=e=>s.query.pageNum=e),limit:s.query.pageSize,"onUpdate:limit":t[3]||(t[3]=e=>s.query.pageSize=e),onPagination:t[4]||(t[4]=e=>r.getTableChangeSize())},null,8,["total","page","limit"])]),m(D,{visible:s.dialogVisible,"onUpdate:visible":t[5]||(t[5]=e=>s.dialogVisible=e),title:"组织架构",defaultValues:s.userArray,onSuccess:r.getSelectUser},null,8,["visible","defaultValues","onSuccess"]),m(z,{defaultValues:s.deptArray,visible:s.dialogDeptVisible,"onUpdate:visible":t[6]||(t[6]=e=>s.dialogDeptVisible=e),title:"选择部门",onSuccess:r.selectedDept},null,8,["defaultValues","visible","onSuccess"]),s.showChat?(d(),j(L,{key:0,visible:s.showChat,"onUpdate:visible":t[7]||(t[7]=e=>s.showChat=e),queryChat:s.queryChat},null,8,["visible","queryChat"])):y("",!0)])}]]);export{w as default};
