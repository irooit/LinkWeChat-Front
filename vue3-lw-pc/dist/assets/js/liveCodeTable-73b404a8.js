import{a as e}from"./staff-48996164.js";import{g as l,a as t}from"./group-16414119.js";import{r as i}from"../index-044285d2.js";import{g as o}from"./pullNews-68e01d94.js";import{_ as a}from"./quill-image-resize-module-c051113e.js";import{ai as r,aq as s,o as d,c as n,_ as p,U as c,a as u,Y as m,V as g,T as h,K as w,a9 as f,Z as b,X as y,bl as v,bj as k}from"./@vue-e400fd81.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";const C=window.lwConfig.services.wecom+"/knowCustomer";function j(e){return i({url:C+"/findWeKnowCustomerCodes",params:e})}const _={props:{twoVisible:{type:Boolean,default:!1},type:{type:String,default:"ygcode"}},watch:{type:{handler(e){this.getList()}}},data:()=>({loading:!1,tabLoading:!1,list:[],query:{pageNum:1,pageSize:10},total:0,liveCodeUrl:null,detailDialog:!1,tableList:[]}),computed:{title(){return{ygcode:"员工活码",kqcode:"客群活码",mdcoed:"门店活码",skcode:"识客活码",lxcode:"拉新活码"}[this.type]},Pvisible:{get(){return this.twoVisible},set(e){this.$emit("update:twoVisible",e)}}},created(){this.getList()},methods:{handleClose(){this.Pvisible=!1,this.list=[]},getDetail(e){this.detailDialog=!0,this.tabLoading=!0,l(e).then((e=>{this.tableList=e.data,this.tabLoading=!1}))},submit(e){e?null===this.liveCodeUrl?this.$message.error("请选择活码"):(this.$emit("selectLiveCode",this.liveCodeUrl),this.Pvisible=!1,this.list=[]):this.Pvisible=!1},getList(){this.loading=!0;let l={ygcode:e,kqcode:t,skcode:j,lxcode:o};"ygcode"===this.type?(this.query.orderByColumn="wqc.update_time",this.query.isAsc="desc"):(delete this.query.orderByColumn,delete this.query.isAsc),l[this.type](this.query).then((({rows:e,total:l})=>{this.list=e.map((e=>(e.checked=!1,e))),this.total=Number(l),this.loading=!1})).catch((()=>{this.loading=!1}))},goAdd(){this.$router.push({name:{ygcode:"staffCode",kqcode:"customerGroupCode",mdcoed:"storeCode",skcode:"identityCode",lxcode:"pullNewsCode"}[this.type]})},onRowClick(e,l,t){if("INPUT"==t.target.nodeName.toUpperCase(0))return;const i=e.checked;i||this.list.forEach((e=>e.checked=!1)),e.checked=!i;this.liveCodeUrl=e.checked?e[{ygcode:"qrCode",kqcode:"codeUrl",skcode:"knowCustomerQr",lxcode:"imageUrl"}[this.type]]:null}}},q=e=>(v("data-v-48b30c96"),e=e(),k(),e),N={key:0},U={style:{display:"inline"}},x=q((()=>u("div",null,"当前群活码所有群聊数量，包括自动建立的群",-1))),T=["onClick"],L=q((()=>u("div",null,"当前群活码全部群的总人数（含员工及重复）",-1))),V=q((()=>u("div",null,"通过当前群活码进群的人数（去重）",-1))),Q=q((()=>u("div",null,"通过当前群活码进群后退群的人数（去重）",-1))),G=q((()=>u("div",null,"通过当前活码新增的客户总数",-1))),D=q((()=>u("div",null,"新增客户领取的红包/卡券总数",-1))),M={key:1,class:"empty"},P={class:"tips"};const z=a(_,[["render",function(e,l,t,i,o,a){const v=r("el-radio"),k=r("el-table-column"),C=r("el-image"),j=r("el-tag"),_=r("el-popover"),q=r("tag-ellipsis"),z=r("el-icon-QuestionFilled"),B=r("el-table"),F=r("pagination"),I=r("el-button"),S=r("el-dialog"),$=s("loading");return d(),n("div",null,[p(S,{title:`添加${a.title}`,modelValue:a.Pvisible,"onUpdate:modelValue":l[5]||(l[5]=e=>a.Pvisible=e),width:"70%","append-to-body":"","destroy-on-close":"","before-close":a.handleClose},{footer:c((()=>[u("div",null,[p(I,{onClick:l[3]||(l[3]=e=>a.Pvisible=!1)},{default:c((()=>[m("取 消")])),_:1}),p(I,{type:"primary",onClick:l[4]||(l[4]=e=>a.submit(o.list.length))},{default:c((()=>[m("确 定")])),_:1})])])),default:c((()=>[o.loading||0!==o.list.length?(d(),n("div",N,[g((d(),h(B,{data:o.list,onRowClick:a.onRowClick},{default:c((()=>[p(k,{width:"30"},{default:c((({row:e})=>[p(v,{modelValue:e.checked,"onUpdate:modelValue":l=>e.checked=l,label:!0},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),"ygcode"===t.type?(d(),n(w,{key:0},[p(k,{label:"二维码",align:"center",prop:"qrCode","min-width":"120"},{default:c((({row:e})=>[p(C,{src:e.qrCode,fit:"fill","preview-src-list":[e.qrCode],style:{width:"100px",height:"100px"}},null,8,["src","preview-src-list"])])),_:1}),p(k,{label:"活码名称",align:"center","min-width":"100",prop:"name","show-overflow-tooltip":""}),p(k,{label:"活码分组",align:"center","min-width":"100",prop:"qrGroupName","show-overflow-tooltip":""}),p(k,{label:"使用员工",align:"center","min-width":"140",prop:"qrUserInfos","show-overflow-tooltip":""},{default:c((({row:e})=>[(d(!0),n(w,null,f(e.qrUserInfos,((e,l)=>(d(),n("div",{key:l,style:{display:"inline"}},[(d(!0),n(w,null,f(e.weQrUserList,((e,l)=>(d(),n("span",{key:l},b(e.userName+" "),1)))),128))])))),128))])),_:1}),p(k,{label:"标签",align:"center",prop:"qrTags","min-width":"160px"},{default:c((({row:e})=>[u("div",null,[(d(!0),n(w,null,f(e.qrTags,((e,l)=>(d(),n(w,{key:l},[l<2&&e.tagName?(d(),h(j,{key:l},{default:c((()=>[m(b(e.tagName),1)])),_:2},1024)):y("",!0)],64)))),128)),p(_,{trigger:"hover",width:"200"},{reference:c((()=>[u("div",U,[e.qrTags&&e.qrTags.length>2?(d(),h(j,{key:0},{default:c((()=>[m("...")])),_:1})):y("",!0)])])),default:c((()=>[(d(!0),n(w,null,f(e.qrTags,((e,l)=>(d(),n(w,{key:l},[l>1&&e.tagName?(d(),h(j,{key:0},{default:c((()=>[m(b(e.tagName),1)])),_:2},1024)):y("",!0)],64)))),128))])),_:2},1024)])])),_:1}),p(k,{label:"最近更新时间",align:"center",prop:"updateTime",width:"180"})],64)):"kqcode"===t.type?(d(),n(w,{key:1},[p(k,{prop:"activityName",label:"活码名称",align:"center"}),p(k,{prop:"codeUrl",label:"二维码",align:"center",width:"130"},{default:c((({row:e})=>[p(_,{placement:"bottom",trigger:"hover"},{reference:c((()=>[p(C,{src:e.codeUrl,class:"code-image--small"},null,8,["src"])])),default:c((()=>[p(C,{src:e.codeUrl,class:"code-image"},null,8,["src"])])),_:2},1024)])),_:1}),p(k,{label:"客群标签",width:"180px"},{default:c((({row:e})=>[e.tags?(d(),h(q,{key:0,limit:"2",list:e.tags.split(",")},null,8,["list"])):y("",!0)])),_:1}),p(k,{label:"活码客群数",align:"center",width:"120px",prop:"chatGroupNum"},{header:c((()=>[p(_,{placement:"top",trigger:"hover"},{reference:c((()=>[u("div",null,[m(" 活码客群数 "),p(z,{class:"el-icon-QuestionFilled"})])])),default:c((()=>[x])),_:1})])),default:c((({row:e})=>[u("a",{style:{color:"#0079de","text-decoration":"underline"},onClick:l=>a.getDetail(e.id)},b(e.chatGroupNum),9,T)])),_:1}),p(k,{prop:"chatGroupMemberTotalNum",width:"120px",label:"群总人数",align:"center"},{header:c((()=>[p(_,{placement:"top",trigger:"hover"},{reference:c((()=>[u("div",null,[m(" 群总人数 "),p(z,{class:"el-icon-QuestionFilled"})])])),default:c((()=>[L])),_:1})])),_:1}),p(k,{prop:"joinChatGroupTotalMemberNum",width:"120px",label:"进群人数",align:"center"},{header:c((()=>[p(_,{placement:"top",trigger:"hover"},{reference:c((()=>[u("div",null,[m(" 进群人数 "),p(z,{class:"el-icon-QuestionFilled"})])])),default:c((()=>[V])),_:1})])),_:1}),p(k,{prop:"exitChatGroupTotalMemberNum",width:"120px",label:"退群人数",align:"center"},{header:c((()=>[p(_,{placement:"top",trigger:"hover"},{reference:c((()=>[u("div",null,[m(" 退群人数 "),p(z,{class:"el-icon-QuestionFilled"})])])),default:c((()=>[Q])),_:1})])),_:1}),p(k,{prop:"createBy",label:"创建人",align:"center"}),p(k,{prop:"updateTime",label:"最近操作时间",align:"center",width:"150"})],64)):"skcode"===t.type?(d(),n(w,{key:2},[p(k,{prop:"knowCustomerName",label:"识客码名称",align:"center"}),p(k,{prop:"knowCustomerQr",label:"二维码",align:"center",width:"130"},{default:c((({row:e})=>[p(_,{placement:"bottom",trigger:"hover"},{reference:c((()=>[p(C,{src:e.knowCustomerQr,class:"code-image--small"},null,8,["src"])])),default:c((()=>[p(C,{src:e.knowCustomerQr,class:"code-image"},null,8,["src"])])),_:2},1024)])),_:1}),p(k,{prop:"tdScanCodeNumber",width:"120px",label:"今日扫码次数",align:"center"}),p(k,{prop:"totalScanCodeNumber",width:"120px",label:"总扫码次数",align:"center"}),p(k,{prop:"createBy",label:"创建人",align:"center"}),p(k,{prop:"updateTime",label:"操作时间",align:"center",width:"160"})],64)):"lxcode"===t.type?(d(),n(w,{key:3},[p(k,{prop:"name",label:"活码名称",align:"center"}),p(k,{prop:"type",label:"拉新方式",align:"center"},{default:c((({row:e})=>[m(b(1===e.type?"红包拉新":"卡券拉新"),1)])),_:1}),p(k,{prop:"imageUrl",label:"二维码",align:"center",width:"130"},{default:c((({row:e})=>[p(_,{placement:"bottom",trigger:"hover"},{reference:c((()=>[p(C,{src:e.imageUrl,class:"code-image--small"},null,8,["src"])])),default:c((()=>[p(C,{src:e.imageUrl,class:"code-image"},null,8,["src"])])),_:2},1024)])),_:1}),p(k,{prop:"scanNum",width:"160px",label:"新增客户总数",align:"center"},{header:c((()=>[p(_,{placement:"top",trigger:"hover"},{reference:c((()=>[u("div",null,[m(" 新增客户总数 "),p(z,{class:"el-icon-QuestionFilled"})])])),default:c((()=>[G])),_:1})])),_:1}),p(k,{prop:"receiveNum",width:"160px",label:"新客领取总数",align:"center"},{header:c((()=>[p(_,{placement:"top",trigger:"hover"},{reference:c((()=>[u("div",null,[m(" 新客领取总数 "),p(z,{class:"el-icon-QuestionFilled"})])])),default:c((()=>[D])),_:1})])),_:1}),p(k,{prop:"createBy",label:"创建人",align:"center"}),p(k,{prop:"updateTime",label:"最近操作时间",align:"center",width:"200"})],64)):y("",!0)])),_:1},8,["data","onRowClick"])),[[$,o.loading]]),p(F,{total:o.total,page:o.query.pageNum,"onUpdate:page":l[0]||(l[0]=e=>o.query.pageNum=e),limit:o.query.pageSize,"onUpdate:limit":l[1]||(l[1]=e=>o.query.pageSize=e),onPagination:l[2]||(l[2]=e=>a.getList())},null,8,["total","page","limit"])])):o.loading||0!==o.list.length?y("",!0):(d(),n("div",M,[u("div",P,"暂无"+b(a.title)+"，点击下方按钮立即创建",1),p(I,{type:"primary",onClick:a.goAdd},{default:c((()=>[m("去创建")])),_:1},8,["onClick"])]))])),_:1},8,["title","modelValue","before-close"]),p(S,{title:"当前客群",modelValue:o.detailDialog,"onUpdate:modelValue":l[8]||(l[8]=e=>o.detailDialog=e),"append-to-body":"",width:"70%"},{footer:c((()=>[u("div",null,[p(I,{onClick:l[6]||(l[6]=e=>o.detailDialog=!1)},{default:c((()=>[m("取 消")])),_:1}),p(I,{type:"primary",onClick:l[7]||(l[7]=e=>o.detailDialog=!1)},{default:c((()=>[m("确 定")])),_:1})])])),default:c((()=>[g((d(),h(B,{data:o.tableList,style:{width:"100%"}},{default:c((()=>[p(k,{label:"客群名称",align:"center","min-width":"100",prop:"groupName","show-overflow-tooltip":""}),p(k,{label:"群主",align:"center","min-width":"100",prop:"groupOwner","show-overflow-tooltip":""}),p(k,{label:"群总人数",align:"center",prop:"chatGroupMemberTotalNum","min-width":"100","show-overflow-tooltip":""}),p(k,{label:"进群人数",align:"center",prop:"joinChatGroupTotalMemberNum","min-width":"100","show-overflow-tooltip":""}),p(k,{label:"退群人数",align:"center",prop:"exitChatGroupTotalMemberNum","min-width":"100","show-overflow-tooltip":""}),p(k,{label:"操作",align:"center",width:"180"},{default:c((({row:l})=>[p(I,{text:"",onClick:t=>e.$router.push({path:"/groupManage/customerGroupManage/group/groupDetail",query:{chatId:l.chatId}})},{default:c((()=>[m(" 查看详情 ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[$,o.tabLoading]])])),_:1},8,["modelValue"])])}],["__scopeId","data-v-48b30c96"]]);export{z as default};
