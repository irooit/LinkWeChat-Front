import{c as e,d as t}from"./pullNews-68e01d94.js";import{h as i}from"./moment-8163541f.js";import{_ as a}from"./quill-image-resize-module-c051113e.js";import{ai as l,aq as o,o as s,c as r,_ as n,U as d,a as p,Y as m,V as u,T as c,Z as h,X as g,bl as f,bj as _}from"./@vue-e400fd81.js";import"../index-044285d2.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";const b={props:{twoVisible:{type:Boolean,default:!1},qrType:{type:Number,default:1},redId:{type:String,default:null}},watch:{},data:()=>({loading:!1,list:[],query:{pageNum:1,pageSize:10,sceneType:"1,3",status:0},form:{offset:0,limit:10},total:0,cardItem:null,detailDialog:!1,tableList:[],dictStatusType:Object.freeze({0:"启用",1:"停用"}),dictSendSence:{1:"客户",2:"客群",3:"客户与客群"}}),computed:{Pvisible:{get(){return this.twoVisible},set(e){this.$emit("update:twoVisible",e)}}},created(){this.getList()},methods:{goRouter(){this.$router.push("/customerMaintain/redPacketTool/enterprisePacket")},handleClose(){this.Pvisible=!1,this.list=[]},submit(e){e?this.cardItem?(this.$emit("selectCard",this.cardItem),this.Pvisible=!1,this.list=[]):1===this.qrType?this.$message.error("请选择红包"):this.$message.error("请选择卡券"):this.Pvisible=!1},getList(){this.loading=!0,1===this.qrType?e(this.query).then((({rows:e,total:t})=>{this.list=e.map((e=>(e.money=(e.money/100).toFixed(2),e.checked=!1,this.redId&&e.id===this.redId&&(e.checked=!0,this.cardItem=e.checked?e:null),e))),this.total=Number(t),this.loading=!1})).catch((()=>{this.loading=!1})):t(this.form).then((({rows:e,total:t})=>{this.list=e.map((e=>(e.checked=!1,e.available_begin_time=i(e.available_begin_time.format(YYYY/MM/DD)),e.available_end_time=i(e.available_end_time.format(YYYY/MM/DD)),e.stock_use_rule.fixed_normal_coupon.transaction_minimum=this.dealMoney(e.stock_use_rule.fixed_normal_coupon.transaction_minimum),e.stock_use_rule.fixed_normal_coupon.coupon_amount=this.dealMoney(e.stock_use_rule.fixed_normal_coupon.coupon_amount),e))),this.total=Number(t),this.loading=!1})).catch((()=>{this.loading=!1}))},dealMoney:e=>(e/100).toFixed(2),onRowClick(e,t,i){if("INPUT"==i.target.nodeName.toUpperCase(0))return;const a=e.checked;a||this.list.forEach((e=>e.checked=!1)),e.checked=!a,this.cardItem=e.checked?e:null}}},y=e=>(f("data-v-2b2111ef"),e=e(),_(),e),k={key:0},w={key:0},j={class:"red-packet-message"},v={class:"red-packet-text"},q={key:1,class:"empty"},T=y((()=>p("div",{class:"tips"},"暂无红包，点击下方按钮立即创建",-1))),C={key:1},V={key:0},x={key:1,class:"empty"},U=y((()=>p("div",{class:"tips"},"暂无卡券，点击下方按钮立即创建",-1))),P={href:"https://pay.weixin.qq.com/",target:"blank"};const I=a(b,[["render",function(e,t,i,a,f,_){const b=l("el-radio"),y=l("el-table-column"),I=l("el-table"),N=l("pagination"),S=l("el-button"),M=l("el-tag"),R=l("el-dialog"),Y=o("loading");return s(),r("div",null,[n(R,{title:1===i.qrType?"选择红包卡券":"选择微信卡券",modelValue:_.Pvisible,"onUpdate:modelValue":t[8]||(t[8]=e=>_.Pvisible=e),width:"80%","append-to-body":"","destroy-on-close":"","before-close":_.handleClose},{footer:d((()=>[p("div",null,[n(S,{onClick:t[6]||(t[6]=e=>_.Pvisible=!1)},{default:d((()=>[m("取 消")])),_:1}),n(S,{type:"primary",onClick:t[7]||(t[7]=e=>_.submit(f.list.length))},{default:d((()=>[m("确 定")])),_:1})])])),default:d((()=>[1===i.qrType?(s(),r("div",k,[f.loading||0!==f.list.length?(s(),r("div",w,[u((s(),c(I,{data:f.list,onRowClick:_.onRowClick},{default:d((()=>[n(y,{width:"30"},{default:d((({row:e})=>[n(b,{modelValue:e.checked,"onUpdate:modelValue":t=>e.checked=t,label:!0},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),n(y,{width:"200",label:"红包",align:"center",prop:"name"},{default:d((({row:e})=>[p("div",j,[p("div",v,h(e.name),1)])])),_:1}),n(y,{label:"红包金额(元)",align:"center",prop:"money"}),n(y,{label:"发送次数",align:"center",prop:"sendTimes"}),n(y,{label:"发送场景",align:"center",prop:"sceneType"},{default:d((({row:e})=>[p("div",null,h(f.dictSendSence[e.sceneType]),1)])),_:1}),n(y,{label:"红包状态",align:"center",prop:"status"},{default:d((({row:e})=>[p("div",null,h(f.dictStatusType[e.status]),1)])),_:1}),n(y,{label:"最近更新时间",align:"center",width:"180",prop:"createTime"})])),_:1},8,["data","onRowClick"])),[[Y,f.loading]]),n(N,{total:f.total,page:f.query.pageNum,"onUpdate:page":t[0]||(t[0]=e=>f.query.pageNum=e),limit:f.query.pageSize,"onUpdate:limit":t[1]||(t[1]=e=>f.query.pageSize=e),onPagination:t[2]||(t[2]=e=>_.getList())},null,8,["total","page","limit"])])):f.loading||0!==f.list.length?g("",!0):(s(),r("div",q,[T,n(S,{type:"primary",onClick:_.goRouter},{default:d((()=>[m("去创建")])),_:1},8,["onClick"])]))])):(s(),r("div",C,[f.loading||0!==f.list.length?(s(),r("div",V,[u((s(),c(I,{data:f.list,onRowClick:_.onRowClick},{default:d((()=>[n(y,{width:"30"},{default:d((({row:e})=>[n(b,{modelValue:e.checked,"onUpdate:modelValue":t=>e.checked=t,label:!0},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),n(y,{label:"归属商户号",align:"center","min-width":"100",prop:"stock_creator_mchid"}),n(y,{label:"批次号",align:"center","min-width":"100",prop:"stock_id"}),n(y,{label:"批次名称",align:"center","min-width":"100",prop:"stock_name","show-overflow-tooltip":""}),n(y,{label:"面额",align:"center","min-width":"100",prop:"qrGroupName","show-overflow-tooltip":""},{default:d((({row:e})=>[m(h(e.stock_use_rule.fixed_normal_coupon.coupon_amount)+"元",1)])),_:1}),n(y,{label:"门槛",align:"center","min-width":"100",prop:"qrGroupName","show-overflow-tooltip":""},{default:d((({row:e})=>[m(" 满"+h(e.stock_use_rule.fixed_normal_coupon.transaction_minimum)+"元可用 ",1)])),_:1}),n(y,{label:"可用时间",align:"center",prop:"updateTime",width:"180"},{default:d((({row:e})=>[p("div",null,h(e.available_begin_time)+" 至 "+h(e.available_end_time),1)])),_:1}),n(y,{label:"卡券类型",align:"center","min-width":"100",prop:"status","show-overflow-tooltip":""},{default:d((({row:e})=>[p("div",null,["unactivated"===e.status?(s(),c(M,{key:0,type:"info"},{default:d((()=>[m("未激活")])),_:1})):"audit"===e.status?(s(),c(M,{key:1,type:"warning"},{default:d((()=>[m("审核中")])),_:1})):"running"===e.status?(s(),c(M,{key:2,type:"success"},{default:d((()=>[m("运行中")])),_:1})):"stoped"===e.status?(s(),c(M,{key:3,type:"danger"},{default:d((()=>[m("已停止")])),_:1})):"paused"===e.status?(s(),c(M,{key:4,type:"danger"},{default:d((()=>[m("暂停发放")])),_:1})):g("",!0)])])),_:1})])),_:1},8,["data","onRowClick"])),[[Y,f.loading]]),n(N,{total:f.total,page:f.form.offset,"onUpdate:page":t[3]||(t[3]=e=>f.form.offset=e),limit:f.form.limit,"onUpdate:limit":t[4]||(t[4]=e=>f.form.limit=e),onPagination:t[5]||(t[5]=e=>_.getList())},null,8,["total","page","limit"])])):f.loading||0!==f.list.length?g("",!0):(s(),r("div",x,[U,p("a",P,[n(S,{type:"primary"},{default:d((()=>[m("去创建")])),_:1})])]))]))])),_:1},8,["title","modelValue","before-close"])])}],["__scopeId","data-v-2b2111ef"]]);export{I as default};
