import{a as e}from"./organization-9bed3593.js";import"../index-044285d2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./js-cookie-8253c38e.js";import{_ as t}from"./quill-image-resize-module-c051113e.js";import{ai as s,o as i,T as l,U as r,a,_ as o,Y as d,c as p,K as n,a9 as u,Z as c,bl as h,bj as m}from"./@vue-e400fd81.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";import"./ali-oss-912914b8.js";const f={name:"SelectDept",components:{},props:{visible:{type:Boolean,default:!1},title:{type:String,default:"组织架构"},isSigleSelect:{type:Boolean,default:!1},defaultValues:{type:Array,default:()=>[],validator:e=>e.every((e=>e.deptId&&e.deptName))},disabledValues:{type:Array,default:()=>[]},destroyOnClose:Boolean},data:()=>({treeData:[],userList:[],defaultKeys:[]}),watch:{defaultValues:{deep:!0,handler(e){const t=[];Array.isArray(e)&&0!=e.length?(e.forEach((e=>{e.deptId&&t.push(e)})),this.userList=t):this.userList=[]}},Pvisible(e){e&&this.$refs.tree&&this.$refs.tree.setCheckedKeys(this.defaultValues.map((e=>e.deptId))),this.$refs.tree||setTimeout((()=>{this.$refs.tree&&this.$refs.tree.setCheckedKeys(this.defaultValues.map((e=>e.deptId)))}),300)}},computed:{Pvisible:{get(){return this.visible},set(e){this.$emit("update:visible",e)}},defaultProps:()=>({label:"deptName",children:"children",isLeaf:(e,t)=>!e.id})},created(){this.loadNode()},mounted(){},methods:{treeFormat(e){let t=[];return e.forEach((s=>{let i=e.findIndex((e=>e.deptId===s.parentId));!s.parentId&&0!==s.parentId&&!1!==s.parentId||-1===i?t.push(s):(e[i].children||(e[i].children=[]),e[i].children.push(s))})),t},loadNode(){e().then((({data:e})=>{this.treeData=this.treeFormat(e)}))},handleCheckChange(e,t,s){if(t){this.isSigleSelect&&this.$refs.tree.setCheckedKeys([e.deptId]);!(this.userList.findIndex((t=>t.deptId===e.deptId))>-1)&&this.userList.push(e)}else{let t=this.userList.findIndex((t=>t.deptId===e.deptId));t>-1&&this.userList.splice(t,1)}this.userList=this.unique(this.userList)},unique(e){for(var t=0;t<e.length;t++)for(var s=t+1;s<e.length;s++)e[t].deptId.split("_")[0]==e[s].deptId.split("_")[0]&&(e.splice(s,1),s--);return e},submit(){this.Pvisible=!1,this.$emit("success",[...this.userList])},cancle(e){this.$refs.tree.setChecked(e,!1);let t=this.userList.findIndex((t=>t.deptId===e));t>-1&&this.userList.splice(t,1);let s=this.defaultValues.findIndex((t=>t.deptId===e));s>-1&&this.defaultValues.slice().splice(s,1)}}},j={class:"head-container"},y=(e=>(h("data-v-5e66cdab"),e=e(),m(),e))((()=>a("div",{gutter:10},"选择部门列表",-1)));const I=t(f,[["render",function(e,t,h,m,f,I){const v=s("el-tree"),b=s("el-col"),k=s("el-icon-UserFilled"),g=s("el-icon-minus"),C=s("el-row"),L=s("el-button"),x=s("el-dialog");return i(),l(x,{title:h.title,modelValue:I.Pvisible,"onUpdate:modelValue":t[1]||(t[1]=e=>I.Pvisible=e),"close-on-click-modal":!1,"destroy-on-close":h.destroyOnClose},{footer:r((()=>[a("div",null,[o(L,{onClick:t[0]||(t[0]=e=>I.Pvisible=!1)},{default:r((()=>[d("取 消")])),_:1}),o(L,{type:"primary",onClick:I.submit},{default:r((()=>[d("确 定")])),_:1},8,["onClick"])])])),default:r((()=>[o(C,{gutter:20},{default:r((()=>[o(b,{span:12,xs:24},{default:r((()=>[a("div",j,[o(v,{"node-key":"deptId",data:f.treeData,ref:"tree",accordion:"","show-checkbox":"","check-on-click-node":!1,"expand-on-click-node":!0,props:I.defaultProps,"check-strictly":!0,onCheckChange:I.handleCheckChange},null,8,["data","props","onCheckChange"])])])),_:1}),o(b,{span:12,xs:24,class:"user-list"},{default:r((()=>[y,(i(!0),p(n,null,u(f.userList,((e,t)=>(i(),p("div",{key:t},[o(k,{class:"el-icon-UserFilled"}),d(" "+c(e.deptName)+" ",1),o(g,{class:"el-icon-minus fr cp",title:"取消选择",onClick:t=>I.cancle(e.deptId)},null,8,["onClick"])])))),128))])),_:1})])),_:1})])),_:1},8,["title","modelValue","destroy-on-close"])}],["__scopeId","data-v-5e66cdab"]]);export{I as default};
