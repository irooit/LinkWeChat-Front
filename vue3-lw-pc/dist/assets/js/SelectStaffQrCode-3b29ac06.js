import{g as e,a as t}from"./staff-48996164.js";import{ai as l,aq as i,o as s,c as a,_ as o,U as r,a as d,Y as p,K as u,a9 as n,P as m,Z as c,aa as g,V as h,T as y,$ as f,bl as b,bj as j}from"./@vue-e400fd81.js";import{_ as v}from"./quill-image-resize-module-c051113e.js";import"../index-044285d2.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";const q={components:{},props:{visible:{type:Boolean,default:!1},title:{type:String,default:"选择员工活码"},selected:{type:Array,default:()=>[]}},data:()=>({groupList:[],groupIndex:0,loading:!0,query:{pageNum:1,pageSize:10,groupId:"",orderByColumn:"wqc.update_time",isAsc:"desc"},list:[],userArray:[],total:0,radio:"",qrUserName:"",dialogVisible:!1}),watch:{selected:{deep:!0,handler(e){this.setSelected()}},list:{deep:!0,handler(e){this.setSelected()}}},computed:{Pvisible:{get(){return this.visible},set(e){this.$emit("update:visible",e)}}},created(){this.getCodeCategoryListFn()},mounted(){},methods:{switchGroup(e,t){this.groupIndex=e,this.query.groupId=t.id,this.search()},search(){this.query.pageNum=1,this.getList()},getCodeCategoryListFn(){e({mediaType:"6"}).then((e=>{200==e.code&&(this.groupList=e.data,this.query.groupId=this.groupList[0].id,this.groupIndex=0,this.query.pageNum=1,this.getList())}))},getList(e){e&&(this.query.pageNum=e),this.loading=!0,t(this.query).then((({rows:e,total:t})=>{this.list=e,this.total=+t,this.loading=!1})).catch((()=>{this.loading=!1}))},getSelectUser(e){this.userArray=e,this.qrUserName=e.map((e=>e.name))+"",this.query.qrUserIds=e.map((e=>e.userId))+""},submit(){this.Pvisible=!1,this.$emit("success",this.radio)},setSelected(){this.selected.length&&this.list.forEach((e=>{e.id==this.selected[0].id&&(this.radio=e)}))}}},w=e=>(b("data-v-6f7771ee"),e=e(),j(),e),_=w((()=>d("div",{class:"title"},[d("div",{class:"title-name"},"活码分组")],-1))),U={class:"item-list"},C=["onClick"],V={class:"name"},x=w((()=>d("div",{style:{"z-index":"9999999"}},null,-1)));const k=v(q,[["render",function(e,t,b,j,v,q){const w=l("el-col"),k=l("el-input"),L=l("el-button"),I=l("el-form-item"),S=l("el-form"),N=l("el-radio"),z=l("el-table-column"),A=l("el-image"),P=l("el-popover"),T=l("tag-ellipsis"),B=l("el-table"),K=l("pagination"),$=l("el-row"),E=l("el-dialog"),F=l("SelectUser"),G=i("loading");return s(),a("div",null,[o(E,{title:b.title,modelValue:q.Pvisible,"onUpdate:modelValue":t[10]||(t[10]=e=>q.Pvisible=e),width:"900px","append-to-body":"","close-on-click-modal":!1},{footer:r((()=>[d("div",null,[o(L,{onClick:t[9]||(t[9]=e=>q.Pvisible=!1)},{default:r((()=>[p("取 消")])),_:1}),o(L,{type:"primary",onClick:q.submit},{default:r((()=>[p("确 定")])),_:1},8,["onClick"])])])),default:r((()=>[o($,{type:"flex",justify:"space-between"},{default:r((()=>[o(w,{span:5,class:"left pad20",style:{"border-radius":"4px",background:"var(--bg-white)"}},{default:r((()=>[_,d("div",U,[(s(!0),a(u,null,n(v.groupList,((e,t)=>(s(),a("div",{class:m(["item",{active:v.groupIndex==t}]),key:e.id,onClick:l=>q.switchGroup(t,e)},[d("div",V,c(e.name),1)],10,C)))),128))])])),_:1}),o(w,{span:19,style:{"margin-top":"0px"}},{default:r((()=>[d("div",null,[o(S,{ref:"form",model:v.query,"label-width":""},{default:r((()=>[o(I,{label:""},{default:r((()=>[o(k,{modelValue:v.query.qrName,"onUpdate:modelValue":t[0]||(t[0]=e=>v.query.qrName=e),class:"mr10",clearable:"",style:{width:"150px"},placeholder:"请输入活码名称",onKeyup:t[1]||(t[1]=g((e=>q.getList(1)),["enter"]))},null,8,["modelValue"]),o(k,{"model-value":v.userArray.map((e=>e.name))+"",clearable:"",onClear:t[2]||(t[2]=e=>v.userArray=[]),onClick:t[3]||(t[3]=e=>v.dialogVisible=!0),class:"mr10",style:{width:"150px"},placeholder:"请选择员工"},null,8,["model-value"]),o(L,{icon:"el-icon-search",circle:"",onClick:t[4]||(t[4]=e=>q.getList(1))})])),_:1})])),_:1},8,["model"]),h((s(),y(B,{data:v.list},{default:r((()=>[o(z,{width:"30"},{default:r((({row:e})=>[o(N,{modelValue:v.radio,"onUpdate:modelValue":t[5]||(t[5]=e=>v.radio=e),label:e},null,8,["modelValue","label"])])),_:1}),o(z,{prop:"name",label:"活码名称",align:"center"}),o(z,{prop:"qrCode",label:"二维码",align:"center",width:"130"},{default:r((({row:e})=>[o(P,{placement:"bottom",trigger:"hover"},{reference:r((()=>[o(A,{src:e.qrCode,class:"code-image--small"},null,8,["src"])])),default:r((()=>[o(A,{src:e.qrCode,class:"code-image"},null,8,["src"])])),_:2},1024)])),_:1}),o(z,{label:"标签",align:"center"},{default:r((({row:e})=>[o(T,{limit:"1",list:e.qrTags},null,8,["list"])])),_:1}),o(z,{label:"使用员工",align:"center","min-width":"140",prop:"qrUserInfos","show-overflow-tooltip":""},{default:r((({row:e})=>[(s(!0),a(u,null,n(e.qrUserInfos,((e,t)=>(s(),a("div",{key:t,style:{display:"inline"}},[(s(!0),a(u,null,n(e.weQrUserList,((e,t)=>(s(),a("span",{key:t},c(e.userName+" "),1)))),128))])))),128))])),_:1}),o(z,{label:"最近更新时间",align:"center",prop:"updateTime",width:"180"})])),_:1},8,["data"])),[[G,v.loading]]),h(o(K,{total:v.total,page:v.query.pageNum,"onUpdate:page":t[6]||(t[6]=e=>v.query.pageNum=e),limit:v.query.pageSize,"onUpdate:limit":t[7]||(t[7]=e=>v.query.pageSize=e),layout:"total,prev, pager, next, jumper",onPagination:t[8]||(t[8]=e=>q.getList())},null,8,["total","page","limit"]),[[f,v.total>0]])])])),_:1})])),_:1}),x])),_:1},8,["title","modelValue"]),o(F,{visible:v.dialogVisible,"onUpdate:visible":t[11]||(t[11]=e=>v.dialogVisible=e),title:"组织架构",defaultValues:v.userArray,onSuccess:q.getSelectUser},null,8,["visible","defaultValues","onSuccess"])])}],["__scopeId","data-v-6f7771ee"]]);export{k as default};
