import{d as e}from"../index-044285d2.js";import{b as t,c as i}from"./circle-2faa2a32.js";import{_ as a}from"./quill-image-resize-module-c051113e.js";import{ai as s,aq as o,o as r,c as l,a as n,_ as p,T as m,U as d,X as u,Y as c,V as h,Z as g}from"./@vue-e400fd81.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";const y={class:"content-box"},j={style:{display:"flex","align-items":"center"}};const b=a({data:()=>({dateRange:[],query:{pageSize:10,pageNum:1,beginTime:"",endTime:"",status:"",weUserIds:[]},loading:!1,tableList:[],userName:"",userArray:[],dialogVisible:!1,id:void 0,type:void 0,name:"",total:0,exportLoading:!1}),mounted(){this.type=+this.$route.query.type,this.id=this.$route.query.id,this.name=this.$route.query.name,this.getList()},methods:{getSelectUser(e){this.userArray=e,this.userName=this.userArray.map((function(e,t){return e.name})).join(","),this.query.weUserIds=this.userArray.map((function(e,t){return e.userId})).join(",")},exportFn(){this.$confirm("确认导出吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>(this.exportLoading=!0,this.query.weMomentsTaskId=this.id,t(Object.assign({},this.query))))).then((t=>{if(!t)return;const i=new Blob([t],{type:"application/vnd.ms-excel"});if(window.navigator.msSaveOrOpenBlob)navigator.msSaveBlob(i,"互动统计");else{const t=URL.createObjectURL(i),a=document.createElement("a");a.style.display="none",a.href=t,a.download=e(new Date,"YYYY-MM-DD")+"-"+this.name+"-互动统计.xlsx",a.click(),URL.revokeObjectURL(a.href)}})).catch((e=>{})).finally((()=>{this.exportLoading=!1}))},getList(){this.dateRange?(this.query.beginTime=this.dateRange[0],this.query.endTime=this.dateRange[1]):(this.query.beginTime="",this.query.endTime=""),this.loading=!0,this.query.weMomentsTaskId=this.id,i(this.query).then((e=>{this.tableList=e.rows,this.total=+e.total,this.loading=!1}))},handleSearch(){this.getList()},resetQuery(){this.query={pageSize:10,pageNum:1,beginTime:"",endTime:"",interactType:"",weUserIds:""},this.userName="",this.dateRange=[],this.userArray=[],this.getList()}}},[["render",function(e,t,i,a,b,f){const v=s("el-date-picker"),w=s("el-input"),q=s("el-option"),x=s("el-select"),L=s("el-button"),U=s("el-table-column"),k=s("el-table"),S=s("pagination"),T=s("SelectUser"),V=o("loading");return r(),l("div",null,[n("div",y,[n("div",j,[p(v,{modelValue:b.dateRange,"onUpdate:modelValue":t[0]||(t[0]=e=>b.dateRange=e),"value-format":"YYYY-MM-DD HH:mm:ss",type:"datetimerange","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间",align:"right",clearable:""},null,8,["modelValue"]),p(w,{style:{width:"150px",margin:"0 20px"},"model-value":b.userName,readonly:"",onClick:t[1]||(t[1]=e=>b.dialogVisible=!0),placeholder:"请选择成员"},null,8,["model-value"]),1===b.type?(r(),m(x,{key:0,modelValue:b.query.surveyState,"onUpdate:modelValue":t[2]||(t[2]=e=>b.query.surveyState=e),placeholder:"请选择类型",style:{width:"150px","margin-right":"20px"}},{default:d((()=>[p(q,{label:"评论",value:0}),p(q,{label:"点赞",value:1})])),_:1},8,["modelValue"])):u("",!0),p(L,{type:"primary",onClick:f.handleSearch},{default:d((()=>[c("查询")])),_:1},8,["onClick"]),p(L,{onClick:f.resetQuery},{default:d((()=>[c("清空")])),_:1},8,["onClick"])]),n("div",null,[h((r(),m(L,{type:"primary",onClick:f.exportFn},{default:d((()=>[c("导出")])),_:1},8,["onClick"])),[[V,b.exportLoading]])])]),h((r(),m(k,{data:b.tableList,style:{width:"100%","margin-bottom":"20px"}},{default:d((()=>[p(U,{label:"客户名称",align:"center",prop:"customerName","min-width":"100","show-overflow-tooltip":""}),p(U,{label:"对应成员",align:"center",prop:"userName","min-width":"100","show-overflow-tooltip":""}),p(U,{label:"互动类型",align:"center",prop:"type","show-overflow-tooltip":""},{default:d((({row:e})=>[n("div",null,g(1===e.type?"点赞":"评论"),1)])),_:1}),p(U,{label:"互动时间",align:"center",prop:"interactTime","show-overflow-tooltip":""})])),_:1},8,["data"])),[[V,b.loading]]),p(S,{total:b.total,page:b.query.pageNum,"onUpdate:page":t[3]||(t[3]=e=>b.query.pageNum=e),limit:b.query.pageSize,"onUpdate:limit":t[4]||(t[4]=e=>b.query.pageSize=e),onPagination:t[5]||(t[5]=e=>f.getList())},null,8,["total","page","limit"]),p(T,{visible:b.dialogVisible,"onUpdate:visible":t[6]||(t[6]=e=>b.dialogVisible=e),title:"组织架构",defaultValues:b.userArray,onSuccess:f.getSelectUser},null,8,["visible","defaultValues","onSuccess"])])}],["__scopeId","data-v-174e556f"]]);export{b as default};
