import e from"./chatList-5fb10f1d.js";import{g as t}from"./content-6f300c2d.js";import{V as a}from"./ChatContent-f938bb33.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import{F as s,B as o}from"../index-044285d2.js";import{_ as i}from"./quill-image-resize-module-c051113e.js";import{ai as r,aq as l,V as n,o as p,c as m,_ as d,a as c,K as u,T as g,U as h,Y as f,Z as j,X as y}from"./@vue-e400fd81.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";import"./benz-amr-recorder-259e7c16.js";const b={class:"chatListClassTab"},w={class:"list"},_={key:0},v={key:1};const C=i({name:"",components:{chatList:e,Voice:a},props:{queryChat:{type:Object,default:()=>({})},type:{type:[String,Number],default:0}},data:()=>({loading:!1,currentPage:1,dateRange:[],list:[],total:0}),computed:{},watch:{queryChat(){this.getList(1)}},created(){this.getList(1)},mounted(){},methods:{setDate:(e,t)=>s(t,o(e)),getList(e){this.loading=!0;let a={msgType:"all"==this.type?"":this.type,pageSize:"10",orderByColumn:"t.msg_time",isAsc:"desc"};this.dateRange?(a.beginTime=this.dateRange[0],a.endTime=this.dateRange[1]):(a.beginTime="",a.endTime=""),e&&(a.pageNum=this.currentPage=e),Object.assign(a,this.queryChat),t(a).then((e=>{this.total=~~e.total,this.list=e.rows,this.loading=!1})).catch((e=>{this.loading=!1}))},filterSize(e){return e?e<t(1)?e+" B":e<t(2)?(e/t(1)).toFixed(2)+" KB":e<t(3)?(e/t(2)).toFixed(2)+" MB":e<t(4)?(e/t(3)).toFixed(2)+" GB":(e/t(4)).toFixed(2)+" TB":"";function t(e){return Math.pow(1024,e)}},downloadFile(e){this.$confirm("是否确认下载该文件?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((t=>{this.downloadNet(JSON.parse(e.contact).attachment,JSON.parse(e.contact).filename)})).catch((function(){}))}}},[["render",function(e,t,a,s,o,i){const C=r("el-date-picker"),k=r("chatList"),T=r("el-table-column"),q=r("el-button"),x=r("el-table"),S=r("voice"),z=r("el-empty"),B=r("el-pagination"),L=l("loading");return n((p(),m("div",b,[d(C,{modelValue:o.dateRange,"onUpdate:modelValue":t[0]||(t[0]=e=>o.dateRange=e),type:"daterange",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right",onChange:t[1]||(t[1]=e=>i.getList(1))},null,8,["modelValue"]),c("div",w,[o.list.length?(p(),m(u,{key:0},["all,image,video,link,".includes(a.type)?(p(),g(k,{key:0,queryChat:a.queryChat,data:o.list},null,8,["queryChat","data"])):"file"==a.type?(p(),g(x,{key:1,data:o.list,stripe:"",style:{width:"100%"},"header-cell-style":{background:"#fff"}},{default:h((()=>[d(T,{label:"名称"},{default:h((({row:e})=>[f(j(JSON.parse(e.contact).filename),1)])),_:1}),d(T,{label:"大小"},{default:h((({row:e})=>[f(j(i.filterSize(JSON.parse(e.contact).filesize)),1)])),_:1}),d(T,{label:"来源"},{default:h((({row:e})=>[f(j(e.name),1)])),_:1}),d(T,{prop:"name",label:"发送时间"},{default:h((({row:e})=>[f(j(e.msgTime),1)])),_:1}),d(T,{prop:"action",label:"操作"},{default:h((({row:e})=>[d(q,{text:"",onClick:t=>i.downloadFile(e)},{default:h((()=>[f("下载")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])):"voice,meeting_voice_call".includes(a.type)?(p(),g(x,{key:2,data:o.list,stripe:"","header-cell-style":{background:"#fff"}},{default:h((()=>[d(T,{prop:"date",label:"发起人"},{default:h((({row:e})=>[f(j(e.name),1)])),_:1}),d(T,{prop:"name",label:"通话时间"},{default:h((({row:e})=>[f(j(e.msgTime),1)])),_:1}),d(T,{prop:"address",label:"时长","min-width":"50"},{default:h((({row:e})=>["voice"==e.msgType?(p(),m("span",_,j(JSON.parse(e.contact).play_length)+"s",1)):(p(),m("span",v,j(i.setDate(JSON.parse(e.contact).endtime,e.msgTime)),1))])),_:1}),d(T,{prop:"msgType",label:"类型"},{default:h((({row:e})=>[f(j("voice"===e.msgType?"语音消息":"语音通话"),1)])),_:1}),d(T,{prop:"address","min-width":"80",label:"操作"},{default:h((({row:e})=>[d(S,{amrUrl:JSON.parse(e.contact).attachment},null,8,["amrUrl"])])),_:1})])),_:1},8,["data"])):y("",!0)],64)):(p(),g(z,{key:1,"image-size":100}))]),o.total?(p(),g(B,{key:0,layout:"prev, pager, next","current-page":o.currentPage,"onUpdate:currentPage":t[2]||(t[2]=e=>o.currentPage=e),onCurrentChange:i.getList,total:o.total},null,8,["current-page","onCurrentChange","total"])):y("",!0)])),[[L,o.loading]])}],["__scopeId","data-v-393cfe5b"]]);export{C as default};
