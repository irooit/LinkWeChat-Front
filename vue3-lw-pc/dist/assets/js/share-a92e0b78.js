import e from"./PreviewInPhone-9ed75a0f.js";import{f as t,d as a,u as s,h as l,i as r,j as i}from"./liveBroadcast-636e81cb.js";import{_ as o}from"./quill-image-resize-module-c051113e.js";import{ai as u,aq as d,o as n,c as p,a as m,Z as g,_ as h,U as c,K as y,a9 as f,T as v,Y as b,X as N,V as w,bl as j,bj as T}from"./@vue-e400fd81.js";import"./quill-c6b3d2fb.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";import"../index-044285d2.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";const D={components:{PreviewInPhone:e},data:()=>({topData:"",activeName:"first",cardData:[{title:"应执行员工数 ",value:0,noArrow:!0},{title:"已发送员工数 ",value:0},{title:"未发送员工数 ",value:0}],customerCardData:[{title:"目标触达客户数 ",value:0,noArrow:!0},{title:"已送达客户数 ",value:0},{title:"未送达客户数 ",value:0}],groupCardData:[{title:"目标触达客群数",value:0,noArrow:!0},{title:"已送达客群数",value:0},{title:"未送达客群数 ",value:0}],firstQuery:{pageNum:1,pageSize:10},query:{pageNum:1,pageSize:10},status:[{value:0,label:"非送达"},{value:1,label:"已送达"},{value:2,label:"非好友"},{value:3,label:"接收达上线"}],firstTotal:0,secondTotal:0,firstList:[],secondList:[],loading:!1,tabForm:{},templateInfo:"",stepLoading:!1,targetType:1,sendWeuserNames:[],tagNamesOrGroupOwners:[]}),created(){this.getDeatil(this.$route.query.id)},mounted(){this.query.liveId=this.$route.query.id,this.firstQuery.liveId=this.$route.query.id,this.getUserDetailTab()},methods:{oneStep(){this.$confirm("确认同步?","提示",{confirmButtonText:"确认同步",cancelButtonText:"放弃",type:"warning"}).then((()=>{this.stepLoading=!0,t(this.query.liveId).then((e=>{200===e.code&&(this.getUserDetailTab(),this.getList(),this.getFirstList(),this.stepLoading=!1,this.$message.success("同步成功"))})).catch()}))},resetQuery(){let e=this.query.pageSize,t=this.query.sendTargetType;this.query={},this.query.pageNum=1,this.query.pageSize=e,this.query.sendTargetType=t,this.getList()},resetFirstQuery(){let e=this.firstQuery.sendTargetType;this.firstQuery.pageNum=1,this.firstQuery.userName="",this.firstQuery.sendTargetType=e,this.getFirstList()},getDeatil(e){a(e).then((e=>{this.topData=e.data,this.query.sendTargetType=e.data.targetType,this.firstQuery.sendTargetType=e.data.targetType,this.targetType=e.data.targetType,this.getList(),this.getFirstList(),this.templateInfo=e.data.weLiveAttachments[0].content,this.topData.weLiveAttachments=e.data.weLiveAttachments,this.topData.sendWeuserNames=e.data.sendWeuserNames?e.data.sendWeuserNames.split(","):e.data.sendWeuserNames,this.sendWeuserNames=this.dealTage(e.data.sendWeuserNames),this.topData.tagNamesOrGroupOwners=e.data.tagNamesOrGroupOwners?e.data.tagNamesOrGroupOwners.split(","):e.data.tagNamesOrGroupOwners,this.tagNamesOrGroupOwners=this.dealTage(e.data.tagNamesOrGroupOwners)})).catch((()=>{}))},dealTage(e){let t=JSON.parse(JSON.stringify(e));return t&&t.length>2?t.splice(0,2):t},getFirstList(e){e&&(this.firstQuery.pageNum=e),this.loading=!0,this.firstQuery.liveId=this.$route.query.id,s(this.firstQuery).then((e=>{this.firstList=e.rows,this.firstTotal=+e.total,this.loading=!1})).catch((()=>{this.loading=!1}))},getList(e){e&&(this.query.pageNum=e),this.query.liveId=this.$route.query.id,this.loading=!0,l(this.query).then((e=>{this.secondList=e.rows,this.secondTotal=+e.total,this.loading=!1})).catch((()=>{this.loading=!1}))},coverContent:e=>(e&&e.length>20&&(e=e.substr(0,20)+"..."),e),getUserDetailTab(){this.tabForm.liveId=this.$route.query.id,r(this.tabForm).then((e=>{this.cardData[0].value=e.data.estimateSendNumber,this.cardData[1].value=e.data.actualSendNumber,this.cardData[2].value=e.data.noSendNumber})),i(this.tabForm).then((e=>{this.customerCardData[0].value=e.data.estimateSendNumber,this.customerCardData[1].value=e.data.actualSendNumber,this.customerCardData[2].value=e.data.noSendNumber,this.groupCardData[0].value=e.data.estimateSendNumber,this.groupCardData[1].value=e.data.actualSendNumber,this.groupCardData[2].value=e.data.noSendNumber}))},dealState(e){switch(e){case 0:return"非送达";case 1:return"已送达";case 2:return"非好友";case 3:return"接收达上线"}}}},_=e=>(j("data-v-d0a2af03"),e=e(),T(),e),q={class:"flex"},O={style:{width:"calc(100% - 425px)","padding-right":"var(--card-margin)"}},L={class:"g-card"},S=_((()=>m("div",{class:"g-card-title"},"直播预约人数",-1))),C={class:"fxbw"},k={style:{display:"flex"}},Q=_((()=>m("span",{class:"titleColor"},"发送员工：",-1))),I={key:0},x={key:1},G={class:"mt10"},U={style:{display:"flex"}},W={class:"titleColor"},V={key:0},z={key:1},F={class:"numStyle"},A={class:"g-card"},P={key:0},$={class:"bottom"},B={key:0},J={class:"g-card",style:{width:"425px","margin-top":"0"}};const K=o(D,[["render",function(e,t,a,s,l,r){const i=u("el-tag"),o=u("el-popover"),j=u("el-button"),T=u("CardGroupIndex"),D=u("el-input"),_=u("el-form-item"),K=u("el-form"),E=u("el-table-column"),M=u("el-table"),X=u("pagination"),Y=u("el-tab-pane"),Z=u("el-option"),H=u("el-select"),R=u("el-tabs"),ee=u("PreviewInPhone"),te=d("loading");return n(),p("div",null,[m("div",q,[m("div",O,[m("div",L,[S,m("div",C,[m("div",null,[m("div",k,[Q,null===l.topData.sendWeuserNames?(n(),p("div",I,[m("span",null,g(1===l.targetType?"全部员工":"全部群主"),1)])):(n(),p("div",x,[h(o,{placement:"bottom",trigger:"hover",disabled:!!l.topData.sendWeuserNames&&l.topData.sendWeuserNames.length<3},{reference:c((()=>[m("div",null,[(n(!0),p(y,null,f(l.sendWeuserNames,((e,t)=>(n(),v(i,{key:t},{default:c((()=>[b(g(e),1)])),_:2},1024)))),128)),l.topData.sendWeuserNames&&l.topData.sendWeuserNames.length>2?(n(),v(i,{key:0},{default:c((()=>[b("...")])),_:1})):N("",!0)])])),default:c((()=>[m("div",null,[(n(!0),p(y,null,f(l.topData.sendWeuserNames,((e,t)=>(n(),v(i,{key:t},{default:c((()=>[b(g(e),1)])),_:2},1024)))),128))])])),_:1},8,["disabled"])]))]),m("div",G,[m("div",U,[m("span",W,g(1===l.targetType?"发送客户：":"发送客群："),1),null===l.topData.tagNamesOrGroupOwners?(n(),p("div",V,[m("span",null,g(1===l.targetType?"全部客户":"全部群主"),1)])):(n(),p("div",z,[h(o,{placement:"bottom",trigger:"hover",disabled:!!l.topData.tagNamesOrGroupOwners&&l.topData.tagNamesOrGroupOwners.length<3},{reference:c((()=>[m("div",null,[(n(!0),p(y,null,f(l.tagNamesOrGroupOwners,((e,t)=>(n(),v(i,{key:t},{default:c((()=>[b(g(e),1)])),_:2},1024)))),128)),l.topData.tagNamesOrGroupOwners&&l.topData.tagNamesOrGroupOwners.length>2?(n(),v(i,{key:0},{default:c((()=>[b(" ... ")])),_:1})):N("",!0)])])),default:c((()=>[m("div",null,[(n(!0),p(y,null,f(l.topData.tagNamesOrGroupOwners,((e,t)=>(n(),v(i,{key:t},{default:c((()=>[b(g(e),1)])),_:2},1024)))),128))])])),_:1},8,["disabled"])]))])])]),m("div",F,g(l.topData.subscribeCount),1)])]),m("div",A,[h(j,{type:"primary",onClick:r.oneStep,class:"fr",loading:l.stepLoading},{default:c((()=>[b("同步")])),_:1},8,["onClick","loading"]),h(R,{modelValue:l.activeName,"onUpdate:modelValue":t[11]||(t[11]=e=>l.activeName=e)},{default:c((()=>[h(Y,{label:"员工详情",name:"first"},{default:c((()=>["first"===l.activeName?(n(),p("div",P,[h(T,{data:l.cardData},null,8,["data"]),h(K,{"label-position":"left",inline:"","label-width":"70px"},{default:c((()=>[h(_,{label:""},{default:c((()=>[h(D,{placeholder:"请输入员工名称",modelValue:l.firstQuery.userName,"onUpdate:modelValue":t[0]||(t[0]=e=>l.firstQuery.userName=e),style:{width:"260px"}},null,8,["modelValue"])])),_:1}),h(_,{label:""},{default:c((()=>[h(j,{type:"primary",onClick:t[1]||(t[1]=e=>r.getFirstList(0))},{default:c((()=>[b("查询")])),_:1}),h(j,{onClick:r.resetFirstQuery},{default:c((()=>[b("重置")])),_:1},8,["onClick"])])),_:1})])),_:1}),w((n(),v(M,{class:"mt0",data:l.firstList},{default:c((()=>[h(E,{label:"发送员工",align:"center","show-overflow-tooltip":""},{default:c((e=>[b(g(r.coverContent(e.row.userName)),1)])),_:1}),h(E,{label:1===l.targetType?"预计发送客户":"预计发送客群",align:"center","show-overflow-tooltip":""},{default:c((e=>[b(g(r.coverContent(e.row.estimateSendNumber)),1)])),_:1},8,["label"]),h(E,{label:1===l.targetType?"实际发送客户":"实际发送客群",align:"center","show-overflow-tooltip":""},{default:c((e=>[b(g(r.coverContent(e.row.actualSendNumber)),1)])),_:1},8,["label"])])),_:1},8,["data"])),[[te,l.loading]]),m("div",$,[h(X,{total:l.firstTotal,page:l.firstQuery.pageNum,"onUpdate:page":t[2]||(t[2]=e=>l.firstQuery.pageNum=e),limit:l.firstQuery.pageSize,"onUpdate:limit":t[3]||(t[3]=e=>l.firstQuery.pageSize=e),onPagination:t[4]||(t[4]=e=>r.getFirstList())},null,8,["total","page","limit"])])])):N("",!0)])),_:1}),h(Y,{label:1===l.targetType?"客户详情":"客群详情",name:"second"},{default:c((()=>["second"===l.activeName?(n(),p("div",B,[h(T,{data:1===l.targetType?l.customerCardData:l.groupCardData},null,8,["data"]),h(K,{"label-position":"left",inline:"","label-width":"80px"},{default:c((()=>[h(_,{"label-width":"0"},{default:c((()=>[h(D,{placeholder:1===l.targetType?"请输入员工名称":"请输入群主",modelValue:l.query.userName,"onUpdate:modelValue":t[5]||(t[5]=e=>l.query.userName=e),style:{width:"260px"}},null,8,["placeholder","modelValue"])])),_:1}),h(_,{"label-width":"0"},{default:c((()=>[h(H,{modelValue:l.query.sendState,"onUpdate:modelValue":t[6]||(t[6]=e=>l.query.sendState=e),placeholder:"请选择送达状态"},{default:c((()=>[(n(!0),p(y,null,f(l.status,(e=>(n(),v(Z,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),h(_,{"label-width":"0"},{default:c((()=>[h(j,{type:"primary",onClick:t[7]||(t[7]=e=>r.getList(0))},{default:c((()=>[b("查询")])),_:1}),h(j,{onClick:r.resetQuery},{default:c((()=>[b("重置")])),_:1},8,["onClick"])])),_:1})])),_:1}),w((n(),v(M,{class:"mt0",data:l.secondList},{default:c((()=>[h(E,{label:1===l.targetType?"客户名称":"客群名称",align:"center","show-overflow-tooltip":""},{default:c((e=>[b(g(r.coverContent(e.row.customerOrGroupName)),1)])),_:1},8,["label"]),h(E,{label:1===l.targetType?"所属员工":"所属群主",align:"center","show-overflow-tooltip":""},{default:c((e=>[b(g(r.coverContent(e.row.userName)),1)])),_:1},8,["label"]),h(E,{label:"送达时间",prop:"updateTime",align:"center"}),h(E,{label:"送达状态",align:"center"},{default:c((e=>[b(g(r.dealState(e.row.sendState)),1)])),_:1})])),_:1},8,["data"])),[[te,l.loading]]),h(X,{total:l.secondTotal,page:l.query.pageNum,"onUpdate:page":t[8]||(t[8]=e=>l.query.pageNum=e),limit:l.query.pageSize,"onUpdate:limit":t[9]||(t[9]=e=>l.query.pageSize=e),onPagination:t[10]||(t[10]=e=>r.getList())},null,8,["total","page","limit"])])):N("",!0)])),_:1},8,["label"])])),_:1},8,["modelValue"])])]),m("div",J,[h(ee,{templateInfo:l.templateInfo,originList:l.topData.weLiveAttachments,liveUrl:l.topData.shareOrJoinUrl},null,8,["templateInfo","originList","liveUrl"])])])])}],["__scopeId","data-v-d0a2af03"]]);export{K as default};
