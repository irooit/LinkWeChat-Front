import{u as e}from"./vue-router-f8d53be7.js";import{c as a,g as t,e as l,f as r,h as o,i}from"./api-f4eece6a.js";import{r as s,ai as d,o as u,c as p,_ as n,u as m,U as c,R as j,K as g,a9 as f,T as b,Y as T,Z as h,a as q,i as v}from"./@vue-e400fd81.js";import"../index-044285d2.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./quill-image-resize-module-c051113e.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";const _=["onClick"],U={__name:"statistics",setup(U){let y=s(!1),C=e().query.id,R=s([]),x={0:"未进群",1:"已进群"},J=s(!1);function N(e,a,t){t.length=0,a.length=0;let l=[[],[]];e.forEach((e=>{t.push(e.date),l[0].push(e.addCustomerNumber),l[1].push(e.joinGroupCustomerNumber)})),a.push(...l)}function V(e){return e.id=C,e.dateRangeAddTime?(e.startAddTime=e.dateRangeAddTime[0],e.endAddTime=e.dateRangeAddTime[1]):(delete e.startAddTime,delete e.endAddTime),delete e.dateRangeAddTime,e.dateRangeJoinTime?(e.startJoinTime=e.dateRangeJoinTime[0],e.endJoinTime=e.dateRangeJoinTime[1]):(delete e.startJoinTime,delete e.endJoinTime),delete e.dateRangeJoinTime,i(e)}return y.value=!0,a(C).then((({data:e})=>{R.value=[{title:"添加客户总数",tips:"通过此活码添加的客户总数(去重)",value:e.addCustomerNumber},{title:"进群客户总数",tips:"添加客户中成功进群的总数(去重)",value:e.joinGroupCustomerNumber},{title:"今日添加客户数",tips:"今日通过此活码添加的客户数(去重)",value:e.tdAddCustomerNumber},{title:"今日进群客户数",tips:"今日添加客户中成功进群数(去重)",value:e.tdJoinGroupCustomerNumber}]})).finally((()=>{y.value=!1})),t(C).then((({data:e})=>{e.groups})),(e,a)=>{const t=d("CardGroupIndex"),i=d("RequestChartTable"),s=d("el-input"),U=d("el-form-item"),y=d("el-date-picker"),C=d("el-option"),A=d("el-select"),k=d("el-table-column"),G=d("el-button"),w=d("el-table"),E=d("el-dialog");return u(),p("div",null,[n(t,{data:m(R)},null,8,["data"]),n(i,{type:"lineChart",title:"数据趋势",isTimeQuery:"",isCreateRequest:!1,request:a=>(a.id=e.$route.query.id,l(a)),legend:["今日添加客户数","今日进群客户数"],dealDataFun:N},null,8,["request"]),n(i,{title:"数据明细",ref:"importRecord",request:V,requestExport:a=>(a.id=e.$route.query.id,r(a)),exportFileName:"新客拉群数据明细导出.xls"},{queryMiddle:c((({query:a})=>[n(U,{label:"",prop:"customerName"},{default:c((()=>[n(s,{modelValue:a.customerName,"onUpdate:modelValue":e=>a.customerName=e,placeholder:"请输入客户名称"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),n(U,{label:""},{default:c((()=>[n(y,j({modelValue:a.dateRangeAddTime,"onUpdate:modelValue":e=>a.dateRangeAddTime=e,"value-format":"YYYY-MM-DD",type:"daterange"},e.pickerOptions,{"range-separator":"-","start-placeholder":"添加开始","end-placeholder":"结束日期",align:"right"}),null,16,["modelValue","onUpdate:modelValue"])])),_:2},1024),n(U,{label:"",prop:"isJoinGroup"},{default:c((()=>[n(A,{modelValue:a.isJoinGroup,"onUpdate:modelValue":e=>a.isJoinGroup=e,placeholder:"请选择是否进群"},{default:c((()=>[(u(!0),p(g,null,f(m(x),((e,a)=>(u(),b(C,{key:a,label:e,value:a},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),default:c((({data:a})=>[n(w,{data:a},{default:c((()=>[n(k,{align:"center",prop:"customerName",label:"客户名称"}),n(k,{align:"center",prop:"addUserId",label:"添加员工"}),n(k,{align:"center",prop:"addTime",label:"添加时间"}),n(k,{align:"center",prop:"isJoinGroup",label:"是否进群"},{default:c((({row:e})=>[T(h(m(x)[e.isJoinGroup]),1)])),_:1}),n(k,{align:"center",prop:"groupName",label:"进入客群"},{default:c((({row:a})=>[q("div",{class:"g-color cp",onClick:t=>{var l;e.externalUserid=a.externalUserid,v(J)?J.value=!0:J=!0,null==(l=e.$refs.RequestChartTableDialog)||l.getList()}},h(a.joinGroupNumber),9,_)])),_:1}),n(k,{label:"操作",align:"center"},{default:c((({row:a})=>[n(G,{text:"",onClick:t=>e.$router.push({name:e.lwConfig.CUSTOMER_DETAIL_ROUTE_NAME,query:{externalUserid:a.externalUserid,userId:a.addUserId}})},{default:c((()=>[T(" 客户详情 ")])),_:2},1032,["onClick"])])),_:1})])),_:2},1032,["data"])])),_:1},8,["requestExport"]),n(E,{title:"进入客群",modelValue:m(J),"onUpdate:modelValue":a[0]||(a[0]=e=>v(J)?J.value=e:J=e),"close-on-click-modal":!1},{default:c((()=>[n(i,{ref:"RequestChartTableDialog",style:{padding:"0 0 20px 0"},request:a=>(a.id=e.$route.query.id,a.externalUserid=e.externalUserid,o(a))},{default:c((({data:e})=>[n(w,{data:e},{default:c((()=>[n(k,{label:"客群名称",align:"center",prop:"groupName"}),n(k,{align:"center",prop:"joinTime",label:"进群时间"},{default:c((({row:e})=>[T(h(e.joinTime||"—"),1)])),_:1})])),_:2},1032,["data"])])),_:1},8,["request"])])),_:1},8,["modelValue"])])}}};export{U as default};
