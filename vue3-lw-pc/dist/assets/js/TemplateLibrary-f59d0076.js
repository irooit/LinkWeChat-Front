import e from"./PreviewInPhone-9ed75a0f.js";import{g as t}from"./welcome-6ff4c53e.js";import{t as l}from"./modleCenter-5112f339.js";import{_ as a}from"./quill-image-resize-module-c051113e.js";import{ai as i,aq as r,o,c as s,a as n,_ as d,U as p,Y as u,V as m,T as h,X as g,Z as c}from"./@vue-e400fd81.js";const f={name:"Tab2",components:{PreviewInPhone:e},props:{type:{type:[Number,String],default:"1"},isGroup:{type:Boolean,default:!1}},data:()=>({welSelected:{id:""},userArray:[],qrUserName:void 0,ids:[],query:{pageNum:1,pageSize:10,templateType:1},loading:!1,total:0,list:[],showPreviewDialog:!1,previewList:[],templateInfo:"",materialMsgList:[]}),watch:{},computed:{},created(){this.getList()},mounted(){},methods:{currentChange(e){this.welSelected=e,e&&this.$emit("changeObj",e.id)},resetQuery(){this.query.templateInfo="",this.userArray=[],this.qrUserName="",this.query.pageNum=1,this.getList()},getSelectUser(e){this.userArray=e,this.qrUserName=this.userArray.map((function(e,t){return e.name})).join(","),this.query.qrUserIds=this.userArray.map((function(e,t){return e.userId})).join(",")},handleSelectionChange(e){this.ids=e.map((e=>e.id))},getList(e){e&&(this.query.pageNum=e),this.loading=!0,this.query.templateType=this.isGroup?2:1,t(this.query).then((({rows:e,total:t})=>{this.list=e,this.total=+t,this.loading=!1})).catch((()=>{this.loading=!1}))},showPreview(e){this.templateInfo=e.templateInfo,this.getDeatil(e.id),this.showPreviewDialog=!0},getDeatil(e){this.loading=!0,l(e).then((e=>{this.previewList=e.data.weMaterialList,this.loading=!1})).catch((()=>{this.loading=!1}))},setEditList(e){let t=[];return e&&e.length&&e.forEach((e=>{if("image"===e.msgType){let l={msgType:"0",materialUrl:e.picUrl};t.push(l)}else if("link"===e.msgType){let l={msgType:"8",materialName:e.title,materialUrl:e.linkUrl};t.push(l)}else if("miniprogram"===e.msgType){let l={msgType:"9",digest:e.appId,materialName:e.title,coverUrl:e.picUrl,materialUrl:e.linkUrl};t.push(l)}})),t}}},w={class:"left",style:{"border-radius":"4px",background:"var(--bg-white)"}},y={class:"bottom"},v={class:"dialog-footer"};const b=a(f,[["render",function(e,t,l,a,f,b){const q=i("el-input"),U=i("el-form-item"),I=i("el-button"),_=i("el-form"),C=i("el-icon-check"),P=i("el-table-column"),k=i("el-table"),T=i("pagination"),N=i("PreviewInPhone"),L=i("el-dialog"),S=r("loading");return o(),s("div",w,[n("div",null,[d(_,{"label-position":"left",inline:"","label-width":"80px"},{default:p((()=>[d(U,null,{default:p((()=>[d(q,{placeholder:l.isGroup?"请输入群发内容":"请输入欢迎语",modelValue:f.query.templateInfo,"onUpdate:modelValue":t[0]||(t[0]=e=>f.query.templateInfo=e),style:{width:"260px"}},null,8,["placeholder","modelValue"])])),_:1}),d(U,{"label-width":"0"},{default:p((()=>[d(I,{type:"primary",onClick:t[1]||(t[1]=e=>b.getList(0))},{default:p((()=>[u("查询")])),_:1}),d(I,{onClick:b.resetQuery},{default:p((()=>[u("重置")])),_:1},8,["onClick"])])),_:1})])),_:1})]),n("div",null,[m((o(),h(k,{data:f.list,onCurrentChange:b.currentChange},{default:p((()=>[d(P,{width:"60"},{default:p((({row:e})=>[f.welSelected&&f.welSelected.id===e.id?(o(),h(C,{key:0,class:"el-icon-check",style:{color:"rgb(65, 133, 244)","font-size":"25px"}})):g("",!0)])),_:1}),d(P,{label:l.isGroup?"群发内容":"欢迎语",align:"center","min-width":"200","show-overflow-tooltip":""},{default:p((e=>[u(c(e.row.templateInfo),1)])),_:1},8,["label"]),d(P,{label:"附件",align:"center",prop:"attachTotalNum"}),d(P,{label:"最近更新",align:"center"},{default:p((e=>[n("div",null,c(e.row.updateBy),1),n("span",null,c(e.row.createTime),1)])),_:1}),d(P,{label:"操作",align:"center"},{default:p((e=>[d(I,{text:"",onClick:t=>b.showPreview(e.row)},{default:p((()=>[u("预览")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","onCurrentChange"])),[[S,f.loading]]),n("div",y,[d(T,{total:f.total,page:f.query.pageNum,"onUpdate:page":t[2]||(t[2]=e=>f.query.pageNum=e),limit:f.query.pageSize,"onUpdate:limit":t[3]||(t[3]=e=>f.query.pageSize=e),onPagination:t[4]||(t[4]=e=>b.getList())},null,8,["total","page","limit"])])]),d(L,{title:"预览",modelValue:f.showPreviewDialog,"onUpdate:modelValue":t[6]||(t[6]=e=>f.showPreviewDialog=e),width:"50%","append-to-body":""},{footer:p((()=>[n("span",v,[d(I,{type:"primary",onClick:t[5]||(t[5]=e=>f.showPreviewDialog=!1)},{default:p((()=>[u("关闭")])),_:1})])])),default:p((()=>[n("div",null,[d(N,{list:f.previewList,templateInfo:f.templateInfo},null,8,["list","templateInfo"])])])),_:1},8,["modelValue"])])}],["__scopeId","data-v-b9af63fb"]]);export{b as T};
