import e from"./baseInfo-156b5558.js";import t from"./pullNews-e99cbc18.js";import s from"./groupCode-e5acab20.js";import{u as o,a as i,b as r}from"./pullNews-68e01d94.js";import{_ as a}from"./quill-image-resize-module-c051113e.js";import{ai as p,aq as d,o as l,c as n,a as u,_ as m,U as c,X as h,K as j,Y as y,V as g,T as f}from"./@vue-e400fd81.js";import"./SelectMember-1a9dc1ee.js";import"./organization-9bed3593.js";import"../index-044285d2.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";import"./SelectDept-7a07b4de.js";import"./SelectPost-d0ccd09d.js";import"./IdentityAttachment-8108ffd0.js";import"./PreviewInPhone-9ed75a0f.js";import"./index-0bf429ac.js";import"./scriptCenter-9e8c6ca2.js";import"./modleCenter-5112f339.js";import"./DragTable-97e90e96.js";import"./sortablejs-b0ad9b27.js";import"./MessageContentForm-5a22ed37.js";import"./staff-48996164.js";import"./PicTitContent-8b500b6d.js";import"./PosterAdd-51b39872.js";import"./index-618cff16.js";import"./tag-13936295.js";import"./fabric-8da0df30.js";import"./poster-241340a9.js";import"./liveCodeTable-73b404a8.js";import"./group-16414119.js";import"./TemplateLibrary-f59d0076.js";import"./welcome-6ff4c53e.js";import"./IdentitySelect-1f4fc77b.js";import"./IdentitySelectBase-8ee7d5fd.js";import"./PreViewInIdentity-7e6832fa.js";import"./code-ab4e587b.js";import"./cardTable-2c055b95.js";import"./moment-8163541f.js";const q={class:"g-card"},C={class:"g-card"},I={key:0},b={key:1},v={key:2},k={class:"ar",style:{"margin-top":"30px"}};const N=a({components:{BaseInfo:e,PullNews:t,GroupCode:s},data:()=>({loading:!1,groupCodeId:null,active:0,baseInfo:{},functionType:0,query:{},pullNewsObj:{},groupCodeQuery:{}}),created(){this.$route.query.groupCodeId&&(this.groupCodeId=this.$route.query.groupCodeId,this.getDetail(this.$route.query.groupCodeId))},methods:{nextBaseInfo(e){this.query=Object.assign(this.query,e)},createLiveCode(e){this.query=Object.assign(this.query,e)},getGroupCode(e){},prev(e){this.active-=1,this.active<0&&(this.active=0),"one"===e?this.$refs.pullNews.transInfo():this.$refs.groupCode.transInfo(),this.query.qrName&&(this.query.name=this.query.qrName)},finished(){this.$router.back()},infoNext(){this.$refs.baseInfo.handleValidateFn().then((()=>{this.pullNewsObj=this.query,this.active+=1}))},handleGroupCode(){this.$refs.pullNews.handleValidateFn()&&(this.loading=!0,this.submit())},submit(){delete this.query.tags,this.groupCodeId&&(this.query.id=this.groupCodeId),this.groupCodeQuery.attachments?this.query=Object.assign(this.query,this.groupCodeQuery):this.groupCodeQuery=Object.assign(this.groupCodeQuery,this.query),(this.groupCodeId?o:i)(this.query).then((e=>{if(200===e.code){if(this.groupCodeId){let e={imageUrl:"",linkPath:"",qrName:""};e.imageUrl=this.query.imageUrl,e.linkPath=this.query.linkPath,e.qrName=this.query.qrName,e.qrId=this.groupCodeId,this.baseInfo=e}else e.data.qrName=this.query.qrName,this.baseInfo=e.data;this.active=2,this.loading=!1}})).catch((()=>{this.loading=!1}))},getDetail(e){r(e).then((e=>{let t={qrTags:[],tags:[]};e.data.qrTags.forEach((e=>{t.qrTags.push(e.tagId),t.tags.push(e.tagName)}));let s=[{scopeType:1,userIds:[]},{scopeType:2,partys:[]},{scopeType:3,positions:[]}];e.data.qrUserInfos&&e.data.qrUserInfos.forEach((e=>{switch(e.scopeType){case 1:e.userId&&s[0].userIds.push(e.userId);break;case 2:e.party&&s[1].partys.push(e.party);break;case 3:e.position&&s[2].positions.push(e.position)}})),this.query=Object.assign(e.data,t),this.query.qrUserInfos=s}))}}},[["render",function(e,t,s,o,i,r){const a=p("el-step"),N=p("el-steps"),w=p("BaseInfo"),T=p("PullNews"),P=p("GroupCode"),_=p("el-button"),x=d("loading");return l(),n("div",null,[u("div",q,[m(N,{active:i.active,"align-center":""},{default:c((()=>[m(a,{title:"活码设置"}),m(a,{title:"拉新设置"}),m(a,{title:"生成活码"})])),_:1},8,["active"])]),u("div",C,[u("div",null,[0===i.active?(l(),n("div",I,[m(w,{ref:"baseInfo",query:i.query,onNextBaseInfo:r.nextBaseInfo},null,8,["query","onNextBaseInfo"])])):h("",!0),1===i.active?(l(),n("div",b,[m(T,{ref:"pullNews",query:i.pullNewsObj,onCreateLiveCode:r.createLiveCode},null,8,["query","onCreateLiveCode"])])):h("",!0),2===i.active?(l(),n("div",v,[m(P,{ref:"groupCode",query:i.baseInfo,groupCode:i.groupCodeQuery,onGetGroupCode:r.getGroupCode},null,8,["query","groupCode","onGetGroupCode"])])):h("",!0)]),u("div",k,[0===i.active?(l(),n(j,{key:0},[m(_,{onClick:t[0]||(t[0]=t=>e.$router.back())},{default:c((()=>[y("取消")])),_:1}),g((l(),f(_,{type:"primary",disabled:i.loading,onClick:r.infoNext},{default:c((()=>[y("下一步")])),_:1},8,["disabled","onClick"])),[[x,i.loading]])],64)):1===i.active?(l(),n(j,{key:1},[m(_,{onClick:t[1]||(t[1]=e=>r.prev("one"))},{default:c((()=>[y("上一步")])),_:1}),g((l(),f(_,{type:"primary",disabled:i.loading,onClick:r.handleGroupCode},{default:c((()=>[y(" 生成活码 ")])),_:1},8,["disabled","onClick"])),[[x,i.loading]])],64)):(l(),n(j,{key:2},[m(_,{onClick:t[2]||(t[2]=e=>r.prev("two"))},{default:c((()=>[y("上一步")])),_:1}),m(_,{type:"primary",onClick:r.finished},{default:c((()=>[y("确定")])),_:1},8,["onClick"])],64))])])])}],["__scopeId","data-v-dd678622"]]);export{N as default};
