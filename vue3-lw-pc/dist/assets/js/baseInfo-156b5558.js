import e from"./SelectMember-1a9dc1ee.js";import{_ as t}from"./quill-image-resize-module-c051113e.js";import{ai as s,o as a,c as i,_ as o,U as r,a as l,K as n,a9 as d,T as p,P as m,Z as c,Y as u,X as f,bl as g,bj as h}from"./@vue-e400fd81.js";import"./organization-9bed3593.js";import"../index-044285d2.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";import"./SelectDept-7a07b4de.js";import"./SelectPost-d0ccd09d.js";const j={props:{query:{type:Object,default:{}}},components:{SelectMember:e},watch:{query:{handler(e){if(e.qrUserInfos&&(this.form=Object.assign(this.form,e),this.form.qrName=e.name,this.addWeUser=this.dealVal(e.qrUserInfos)),e.qrType&&this.functionList.forEach(((t,s)=>{t.active=!1,s+1===e.qrType&&(t.active=!0)})),e.tags&&e.qrTags){let t=[],s=e.tags?e.tags:[];(e.qrTags?e.qrTags:[]).forEach(((e,a)=>{let i={name:s[a],tagId:e};t.push(i)})),this.tagList=t}},immediate:!0}},data:()=>({functionList:[{svg:"redBox",name:"红包拉新",content:"给新客户发送红包",active:!0,type:1},{svg:"card",name:"卡券拉新",content:"给新客户发送微信卡券",active:!1,type:2}],addWeUser:{executeUserCondit:{change:!1,weUserIds:[]},executeDeptCondit:{change:!1,deptIds:[],posts:[]}},showSelectTag:!1,form:{qrName:"",qrTags:[],qrType:1,qrUserInfos:[]},a:"",rules:{qrName:[{required:!0,message:"请输入拉新活码名称",trigger:"blur"}]},tagList:[]}),mounted(){},methods:{dealPartys(e){if(e)return e=e.map((e=>e.toString()))},dealVal(e){let t={executeUserCondit:{change:!1,weUserIds:[]},executeDeptCondit:{change:!1,deptIds:[],posts:[]}};return t.executeUserCondit.weUserIds=e[0]?e[0].userIds:[],t.executeDeptCondit.deptIds=e[1]?this.dealPartys(e[1].partys):[],t.executeDeptCondit.posts=e[2]?e[2].positions:[],t.executeDeptCondit.change=!!(e[1]&&e[1].partys&&e[1].partys.length||e[2]&&e[2].positions&&e[2].positions.length),t.executeUserCondit.change=!!(e[0]&&e[0].userIds&&e[0].userIds.length),t},getExecuteData(e){this.addWeUser=e;let t=[{scopeType:1,userIds:e.executeUserCondit.weUserIds},{scopeType:2,partys:e.executeDeptCondit.deptIds},{scopeType:3,positions:e.executeDeptCondit.posts}];this.form.qrUserInfos=t},boxChange(e){this.functionList.forEach((e=>e.active=!1)),e.active=!0,this.form.qrType=e.type},async handleValidateFn(){if(await this.$refs.form.validate(),this.$emit("nextBaseInfo",this.form),!this.$refs.selectMember.validateFn())return Promise.reject()},getSelectTag(e){this.tagList=e,this.form.qrTags=this.tagList.map((e=>e.tagId)),this.form.tags=this.tagList.map((e=>e.name)).join(",")},getGroupDetail(){if(!this.groupCodeId)return;let e=[],t=this.form.tags?this.form.tags.split(","):[];(this.form.qrTags?this.form.qrTags.split(","):[]).forEach(((s,a)=>{let i={name:t[a],tagId:s};e.push(i)})),this.tagList=e}}},v=e=>(g("data-v-0a25ab00"),e=e(),h(),e),b={class:"function"},y={class:"item-text"},q={class:"function-tip"},x=v((()=>l("span",{class:"tips"},"红包拉新需要在管理中心配置微信支付，卡券拉新需要配置公众号",-1))),I=v((()=>l("div",{class:"sub-des"},"引导新客户扫码时添加以下任意成员为好友",-1))),U=v((()=>l("div",{class:"sub-des"},"通过扫描该二维码添加员工好友的新客户会自动打上此处设置的标签",-1)));const T=t(j,[["render",function(e,t,g,h,j,v){const T=s("el-input"),w=s("el-form-item"),_=s("svg-icon"),C=s("el-tooltip"),S=s("el-icon-QuestionFilled"),D=s("SelectMember"),L=s("el-tag"),k=s("el-button"),E=s("el-col"),M=s("el-row"),N=s("el-form"),V=s("SelectTag");return a(),i("div",null,[o(M,null,{default:r((()=>[o(E,{sm:24,md:16,lg:14},{default:r((()=>[o(N,{model:j.form,rules:j.rules,ref:"form","label-width":"140px"},{default:r((()=>[o(M,null,{default:r((()=>[o(E,{sm:24,md:18},{default:r((()=>[o(w,{label:"活码名称:",prop:"qrName"},{default:r((()=>[o(T,{modelValue:j.form.qrName,"onUpdate:modelValue":t[0]||(t[0]=e=>j.form.qrName=e),placeholder:"请输入名称","show-word-limit":"",maxlength:"15"},null,8,["modelValue"])])),_:1}),o(w,{label:"拉新方式:",required:""},{default:r((()=>[l("div",b,[(a(!0),i(n,null,d(j.functionList,((e,t)=>(a(),p(C,{effect:"dark",content:"即将上线,敬请期待",placement:"bottom",key:t,disabled:e.active},{default:r((()=>[l("div",{class:m(["function-item",e.active?"active-item":""])},[o(_,{class:"icon-style",icon:e.svg},null,8,["icon"]),l("div",null,[l("span",null,c(e.name),1),l("div",y,c(e.content),1)])],2)])),_:2},1032,["disabled"])))),128))]),l("div",q,[o(S,{class:"el-icon-QuestionFilled mr10"}),x])])),_:1}),o(w,{label:"添加员工:",required:""},{default:r((()=>[I,o(D,{ref:"selectMember",initData:j.addWeUser,onUpdate:v.getExecuteData},null,8,["initData","onUpdate"])])),_:1}),o(w,{label:"添加标签:"},{default:r((()=>[U,(a(!0),i(n,null,d(j.tagList,((e,t)=>(a(),i(n,{key:t},[e.name?(a(),p(L,{key:0},{default:r((()=>[u(c(e.name),1)])),_:2},1024)):f("",!0)],64)))),128)),l("div",null,[o(k,{type:"primary",icon:"el-icon-plus",onClick:t[1]||(t[1]=e=>j.showSelectTag=!0)},{default:r((()=>[u(c(j.tagList.length?"编辑":"添加")+"标签 ",1)])),_:1})])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1})])),_:1}),o(V,{visible:j.showSelectTag,"onUpdate:visible":t[2]||(t[2]=e=>j.showSelectTag=e),type:"1",selected:j.tagList,onSuccess:v.getSelectTag},null,8,["visible","selected","onSuccess"])])}],["__scopeId","data-v-0a25ab00"]]);export{T as default};
