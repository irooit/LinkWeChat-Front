import{_ as e}from"../index-044285d2.js";import{g as t}from"./group-e56f61ac.js";import{_ as a}from"./quill-image-resize-module-c051113e.js";import{aU as i,c as s,a as r,K as l,_ as o,U as n,T as p,R as u,X as d,O as y,V as m,ai as h,aq as g,o as c,Y as f,a9 as j}from"./@vue-e400fd81.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";const q={name:"",components:{ChartLine:i((()=>e((()=>import("./ChartLine-b009fc4d.js")),["assets/js/ChartLine-b009fc4d.js","assets/js/echarts-8e7b9cd7.js","assets/js/tslib-a4e99503.js","assets/js/zrender-da4e2cf7.js","assets/index-044285d2.js","assets/js/js-cookie-8253c38e.js","assets/js/@vue-e400fd81.js","assets/js/vue-router-f8d53be7.js","assets/js/element-plus-68ba2566.js","assets/js/lodash-es-d4f5f48c.js","assets/js/@element-plus-214e0f7b.js","assets/js/@popperjs-b78c3215.js","assets/js/@ctrl-91de2ec7.js","assets/js/dayjs-c17bc6b2.js","assets/js/@babel-efd68da6.js","assets/js/to-fast-properties-1160b370.js","assets/js/async-validator-cf877c1f.js","assets/js/memoize-one-63ab667a.js","assets/js/normalize-wheel-es-3222b0a2.js","assets/js/@floating-ui-36fbce82.js","assets/css/element-plus-3888a320.css","assets/js/quill-image-resize-module-c051113e.js","assets/js/quill-c6b3d2fb.js","assets/js/quill-delta-a1872f89.js","assets/js/fast-diff-d5a53119.js","assets/js/lodash.clonedeep-1b6eefdc.js","assets/js/lodash.isequal-e7d08617.js","assets/js/@vueup-7cf8cfdd.js","assets/css/@vueup-da05906a.css","assets/css/quill-image-resize-module-44eb40f8.css","assets/js/pinia-1b56b17e.js","assets/js/vue-demi-71ba0ef2.js","assets/js/jsencrypt-43f479c1.js","assets/js/crypto-js-d6a67473.js","assets/js/ali-oss-912914b8.js","assets/js/axios-fb5f9e0e.js","assets/js/@vueuse-4025ce01.js","assets/js/path-browserify-289407ee.js","assets/js/nprogress-a39edb90.js","assets/css/nprogress-771398e6.css","assets/js/clipboard-7a0da8dc.js","assets/css/index-b5531375.css","assets/css/normalize-9d9ae4af.css","assets/js/lodash.merge-f1a4e0c2.js","assets/css/ChartLine-9d5ca891.css"]))),ChartBar:i((()=>e((()=>import("./ChartBar-39a01942.js")),["assets/js/ChartBar-39a01942.js","assets/js/echarts-8e7b9cd7.js","assets/js/tslib-a4e99503.js","assets/js/zrender-da4e2cf7.js","assets/index-044285d2.js","assets/js/js-cookie-8253c38e.js","assets/js/@vue-e400fd81.js","assets/js/vue-router-f8d53be7.js","assets/js/element-plus-68ba2566.js","assets/js/lodash-es-d4f5f48c.js","assets/js/@element-plus-214e0f7b.js","assets/js/@popperjs-b78c3215.js","assets/js/@ctrl-91de2ec7.js","assets/js/dayjs-c17bc6b2.js","assets/js/@babel-efd68da6.js","assets/js/to-fast-properties-1160b370.js","assets/js/async-validator-cf877c1f.js","assets/js/memoize-one-63ab667a.js","assets/js/normalize-wheel-es-3222b0a2.js","assets/js/@floating-ui-36fbce82.js","assets/css/element-plus-3888a320.css","assets/js/quill-image-resize-module-c051113e.js","assets/js/quill-c6b3d2fb.js","assets/js/quill-delta-a1872f89.js","assets/js/fast-diff-d5a53119.js","assets/js/lodash.clonedeep-1b6eefdc.js","assets/js/lodash.isequal-e7d08617.js","assets/js/@vueup-7cf8cfdd.js","assets/css/@vueup-da05906a.css","assets/css/quill-image-resize-module-44eb40f8.css","assets/js/pinia-1b56b17e.js","assets/js/vue-demi-71ba0ef2.js","assets/js/jsencrypt-43f479c1.js","assets/js/crypto-js-d6a67473.js","assets/js/ali-oss-912914b8.js","assets/js/axios-fb5f9e0e.js","assets/js/@vueuse-4025ce01.js","assets/js/path-browserify-289407ee.js","assets/js/nprogress-a39edb90.js","assets/css/nprogress-771398e6.css","assets/js/clipboard-7a0da8dc.js","assets/css/index-b5531375.css","assets/css/normalize-9d9ae4af.css","assets/js/lodash.merge-f1a4e0c2.js","assets/css/ChartBar-e0d67a11.css"])))},props:{type:{type:String,default:"lineChart"},request:{type:Function},isTimeQuery:{type:Boolean,default:!0},isStaffQuery:{type:Boolean,default:!1},staffQueryPlaceholder:{type:String,default:"请选择部门或员工"},isOnlyStaff:{type:Boolean,default:!1},isOnlyDepart:{type:Boolean,default:!1},isGroupQuery:{type:Boolean,default:!1},dealQueryFun:{type:Function,default:null},dealDataFun:{type:Function,default:null},requestExport:{type:Function,default:null},exportFileName:{type:String},legend:{type:[Array,String],default:null},option:{type:Object,default:null}},data:()=>({loading:!1,timeRange:7,total:0,data:[],xData:[],dateRange:[],query:{pageNum:1,pageSize:void 0,deptIds:[],userIds:[],chatIds:[],ownerIds:[],beginTime:void 0,endTime:void 0},groupChats:[],tableProps:[],userArray:[],dialogVisible:!1,dialogType:""}),computed:{},watch:{},created(){this.setTime(7),this.isGroupQuery&&this.getGroupList()},mounted(){},methods:{getList(e){"table"==this.type&&(this.query.pageSize||(this.query.pageSize=10)),this.dateRange?(this.query.beginTime=this.dateRange[0],this.query.endTime=this.dateRange[1]):(this.query.beginTime="",this.query.endTime=""),this.dealQueryFun&&this.dealQueryFun(this.query),Array.isArray(this.userArray)?(this.query.deptIds=this.userArray.filter((e=>e.isParty)).map((e=>e.id)).join(","),this.query.userIds=this.userArray.filter((e=>!e.isParty)).map((e=>e.userId)).join(","),this.isGroupQuery&&(this.query.ownerIds=this.userArray.filter((e=>!e.isParty)).map((e=>e.userId)).join(","))):this.query.deptIds=this.query.userIds=this.query.ownerIds="",this.loading=!0,e&&(this.query.pageNum=e),this.request(this.query).then((({rows:e,total:t,data:a})=>{a=a||e,"table"==this.type?(this.data=a,this.total=+t):this.dealDataFun&&this.dealDataFun(a,this.data,this.xData)})).catch((e=>{})).finally((()=>{this.loading=!1}))},getTime(e){const t=e?new Date(e):new Date;return t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),t.toJSON().substr(0,10)},setTime(e){if(this.timeRange=e,e){let t=new Date;t.setDate(t.getDate()-e),this.dateRange=[this.getTime(t),this.getTime()],this.getList()}else this.dateRange=null},getSelectUser(e){this.userArray=e,this.isGroupQuery&&(this.query.chatIds="",this.getGroupList({userIds:e.map((e=>e.userId)).join(",")})),this.getList()},getGroupList(e){t(e).then((({rows:e})=>{this.groupChats=e})).catch((()=>{}))},exprotTable(){this.$confirm("是否确认导出吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.loading=!0;let e=Object.assign({},this.query,{pageNum:void 0,pageSize:void 0});return this.requestExport(e)})).then((e=>{this.downloadBlob(e,this.exportFileName)})).catch((e=>{})).finally((()=>{this.loading=!1}))}}},b={class:"operation"};const v=a(q,[["render",function(e,t,a,i,q,v){const x=h("el-button"),D=h("el-button-group"),T=h("el-date-picker"),I=h("el-input"),_=h("el-option"),C=h("el-select"),S=h("ChartLine"),k=h("ChartBar"),R=h("pagination"),L=h("SelectUser"),O=g("loading");return c(),s("div",null,[r("div",b,[a.isTimeQuery?(c(),s(l,{key:0},[o(D,null,{default:n((()=>[o(x,{type:"primary",plain:7!=q.timeRange,onClick:t[0]||(t[0]=e=>v.setTime(7))},{default:n((()=>[f("近一周")])),_:1},8,["plain"]),o(x,{type:"primary",plain:30!=q.timeRange,onClick:t[1]||(t[1]=e=>v.setTime(30))},{default:n((()=>[f("近一月")])),_:1},8,["plain"]),o(x,{type:"primary",plain:!!q.timeRange,onClick:t[2]||(t[2]=e=>v.setTime())},{default:n((()=>[f("自定义")])),_:1},8,["plain"])])),_:1}),q.timeRange?d("",!0):(c(),p(T,u({key:0,modelValue:q.dateRange,"onUpdate:modelValue":t[3]||(t[3]=e=>q.dateRange=e),class:"ml20",style:{width:"260px"},"value-format":"YYYY-MM-DD",type:"daterange",clearable:!1},e.pickerOptions,{"range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期",onChange:t[4]||(t[4]=e=>v.getList(1))}),null,16,["modelValue"]))],64)):d("",!0),a.isStaffQuery?(c(),p(I,{key:1,style:{width:"180px","margin-left":"20px"},"model-value":q.userArray.map((e=>e.name))+"",readonly:"",onClick:t[5]||(t[5]=e=>q.dialogVisible=!0),placeholder:a.staffQueryPlaceholder},null,8,["model-value","placeholder"])):d("",!0),a.isGroupQuery?(c(),p(C,{key:2,style:{"margin-left":"20px","vertical-align":"middle"},modelValue:q.query.chatIds,"onUpdate:modelValue":t[6]||(t[6]=e=>q.query.chatIds=e),placeholder:"请选择群聊",clearable:"",onChange:t[7]||(t[7]=e=>v.getList())},{default:n((()=>[(c(!0),s(l,null,j(q.groupChats,(e=>(c(),p(_,{key:e.chatId,label:e.groupName,value:e.chatId},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])):d("",!0),y(e.$slots,"query",{query:q.query},void 0,!0),a.requestExport?(c(),p(x,{key:3,style:{position:"absolute",right:"0"},type:"primary",onClick:v.exprotTable},{default:n((()=>[f(" 导出 Excel ")])),_:1},8,["onClick"])):d("",!0)]),m((c(),s("div",null,["lineChart"==a.type?(c(),p(S,{key:0,xData:q.xData,legend:a.legend,series:q.data,option:a.option},null,8,["xData","legend","series","option"])):"barChart".includes(a.type)?(c(),p(k,{key:1,xData:q.xData,series:q.data,option:a.option},null,8,["xData","series","option"])):"table"==a.type?(c(),s(l,{key:2},[y(e.$slots,"table",{data:q.data},void 0,!0),o(R,{total:q.total,page:q.query.pageNum,"onUpdate:page":t[8]||(t[8]=e=>q.query.pageNum=e),limit:q.query.pageSize,"onUpdate:limit":t[9]||(t[9]=e=>q.query.pageSize=e),onPagination:t[10]||(t[10]=e=>v.getList())},null,8,["total","page","limit"])],64)):d("",!0)])),[[O,q.loading]]),o(L,{visible:q.dialogVisible,"onUpdate:visible":t[11]||(t[11]=e=>q.dialogVisible=e),title:"组织架构",departReplaceUser:"",defaultValues:q.userArray,isOnlyDepart:a.isOnlyDepart,isOnlyLeaf:a.isOnlyStaff,onSuccess:v.getSelectUser},null,8,["visible","defaultValues","isOnlyDepart","isOnlyLeaf","onSuccess"])])}],["__scopeId","data-v-03369c76"]]);export{v as default};
