import e from"./ChinaMap-88d14cbb.js";import{g as t,h as a,e as i}from"./smartForms-eaa9db9a.js";import s from"./SearchTitle-0bef2c19.js";import{_ as l}from"./quill-image-resize-module-c051113e.js";import{ai as o,aq as r,o as n,c as p,a as d,_ as m,V as u,T as c,U as h,Y as g,Z as f,X as b,K as j,a9 as y}from"./@vue-e400fd81.js";import"./echarts-8e7b9cd7.js";import"./tslib-a4e99503.js";import"./zrender-da4e2cf7.js";import"./china-f0a80fd5.js";import"../index-044285d2.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";import"./moment-8163541f.js";const w={style:{"padding-bottom":"30px"}},L={class:"g-card"},v={class:"mid-action"},S={style:{display:"flex","justify-content":"center"}},q={style:{display:"flex","justify-content":"center"}},x={class:"toe"},k={key:0},T={key:1},z={key:2},C={key:3},V={key:0,class:"g-card"},I={class:"g-card-title"};const N=l({props:["formId"],components:{SearchTitle:s,ChinaMap:e},data:()=>({params:"",loading1:!1,total:0,baseList:"",query:{pageSize:10,pageNum:1},baseListMap:{},tableList:[],exportLoading:!1}),methods:{toBackMap(e){e.hidden=1},exportFn(){this.$confirm("确认导出吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>(this.exportLoading=!0,t(Object.assign({belongId:this.$route.query.id},this.tableSearch))))).then((e=>{if(null!=e){let t=new Blob([e],{type:"application/vnd.ms-excel"}),a=window.URL.createObjectURL(t);const i=document.createElement("a");i.href=a,i.download="数据统计.xlsx",i.click(),URL.revokeObjectURL(a)}})).finally((()=>{this.exportLoading=!1}))},getTableChangeSize(e,t){let i=this;this.loading=!0;let s=this.tableSearch;s.pageNum=e,s.pageSize=t,a(s).then((({rows:e,total:t})=>{i.loading1=!1;let a=[];if(e&&e.length){i.tableList=[];for(let t=0;t<e.length;t++)e[t].answer&&(e[t].answer=i.uniq(JSON.parse(e[t].answer)),a.push(e[t]));i.tableList=a}else i.tableList=[];this.total=Number(t)}))},uniq(e){for(let t=0;t<e.length;t++)for(let a=t+1;a<e.length;a++)e[t].questionNumber==e[a].questionNumber&&(e[t].defaultValue=e[t].defaultValue+","+e[a].defaultValue,e.splice(a,1),a--);return e},getTableFn(e){let t=this;this.loading1=!0,e.belongId=this.$route.query.id,e.dataSource?(this.tableSearch=e,t.getTableChangeSize(1,10)):t.loading1=!1},areaStatisticF(e){i(e).then((e=>{let t=e.data[0].data;e.data.map((e=>e.data.find((e=>e.value)))).forEach((e=>{let a=t.find((t=>e.name===t.name));Object.assign(a,e)})),this.baseListMap={data:t,label:e.data[0].label,hidden:1}}))},multipleTrans:e=>((e=JSON.parse(JSON.stringify(e))).viewValue=[],e.defaultValue+="",e.defaultValue=e.defaultValue.split(","),e.options=e.options.split(","),e.viewValue=e.options.filter(((t,a)=>e.defaultValue.includes(a+""))),e.viewValue.join())},mounted(){let e={areaType:1,formId:this.formId};this.areaStatisticF(e)}},[["render",function(e,t,a,i,s,l){const N=o("search-title"),_=o("el-button"),M=o("el-table-column"),O=o("el-table"),U=o("pagination"),F=o("ChinaMap"),B=r("loading");return n(),p("div",w,[d("div",L,[d("div",v,[m(N,{id:e.$route.query.id,showScene:!0,onSearch:l.getTableFn},null,8,["id","onSearch"]),u((n(),c(_,{type:"primary",onClick:l.exportFn},{default:h((()=>[g("导出Excel")])),_:1},8,["onClick"])),[[B,s.exportLoading]])]),s.tableList[0]?b("",!0):u((n(),c(O,{key:0,data:s.tableList,style:{width:"100%"}},{default:h((()=>[m(M,{label:"日期",align:"center","min-width":"100","show-overflow-tooltip":""},{default:h((({row:e})=>[d("div",S,f(e.updateTime.substring(0,10)),1)])),_:1})])),_:1},8,["data"])),[[B,s.loading1]]),s.tableList[0]?(n(),p(j,{key:1},[u((n(),c(O,{data:s.tableList,style:{width:"100%"}},{default:h((()=>[m(M,{align:"center",label:"序号",width:"50"},{default:h((e=>[g(f(e.$index+1),1)])),_:1}),m(M,{label:"日期",align:"center","min-width":"100","show-overflow-tooltip":""},{default:h((({row:e})=>[d("div",q,f(e.updateTime.substring(0,10)),1)])),_:1}),s.tableList&&s.tableList[0]?(n(!0),p(j,{key:0},y(s.tableList[0].answer,((e,t)=>(n(),c(M,{label:e.label,align:"center","min-width":"100","show-overflow-tooltip":"",key:t},{default:h((({row:e})=>[d("div",x,[[8,9,10,6].includes(e.answer[t].formCodeId)?[8,6].includes(e.answer[t].formCodeId)?(n(),p("span",T,f(l.multipleTrans(e.answer[t])),1)):9==e.answer[t].formCodeId?(n(),p("span",z,f(e.answer[t].ssq),1)):10==e.answer[t].formCodeId?(n(),p("span",C,f(e.answer[t].timeS),1)):b("",!0):(n(),p("span",k,f(e.answer[t].defaultValue),1))])])),_:2},1032,["label"])))),128)):b("",!0)])),_:1},8,["data"])),[[B,s.loading1]]),m(U,{total:s.total,page:s.query.pageNum,"onUpdate:page":t[0]||(t[0]=e=>s.query.pageNum=e),limit:s.query.pageSize,"onUpdate:limit":t[1]||(t[1]=e=>s.query.pageSize=e),onPagination:t[2]||(t[2]=e=>l.getTableChangeSize(s.query.pageNum,s.query.pageSize))},null,8,["total","page","limit"])],64)):b("",!0)]),s.baseListMap.label?(n(),p("div",V,[d("div",I,f(s.baseListMap.label),1),m(F,{style:{height:"600px"},Datas:s.baseListMap},null,8,["Datas"])])):b("",!0)])}],["__scopeId","data-v-0d27cdcf"]]);export{N as default};
