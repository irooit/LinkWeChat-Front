import e from"./SelectPosterSingle-95abcb6f.js";import t from"./PreviewInPhone-ee866b94.js";import{g as i}from"./intelligentShortLink-f7529ad3.js";import{t as l}from"./mixin-7ecaaf69.js";import{ai as s,aq as o,o as a,c as r,_ as n,ab as p,U as d,a as m,Y as c,T as u,K as h,a9 as y,V as g,Z as f,$ as j,X as v,P as b,bl as k,bj as _}from"./@vue-e400fd81.js";import{_ as S}from"./quill-image-resize-module-c051113e.js";import L from"./Step3-d2e4c1f7.js";import w from"./ShowShortLink-b9e51bca.js";import{s as C,g as x}from"./api-afde1919.js";import{_ as I,a as q,b as U,c as T}from"./app_active-ed3600f5.js";import{_ as P,a as V,b as N,c as F}from"./app-1d57b1ae.js";import"./PicTitContent-8b500b6d.js";import"./quill-c6b3d2fb.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";import"./code-ab4e587b.js";import"../index-044285d2.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./groupMessage-f31c8fd2.js";import"./PreviewInPhone-9ed75a0f.js";import"./Step3Type1-66818cc7.js";import"./IdentityAttachment-b9bf008d.js";import"./index-0bf429ac.js";import"./scriptCenter-9e8c6ca2.js";import"./modleCenter-5112f339.js";import"./DragTable-b6be070d.js";import"./sortablejs-b0ad9b27.js";import"./MessageContentForm-5a22ed37.js";import"./staff-48996164.js";import"./PosterAdd-51b39872.js";import"./index-618cff16.js";import"./tag-13936295.js";import"./fabric-8da0df30.js";import"./poster-241340a9.js";import"./liveCodeTable-73b404a8.js";import"./group-16414119.js";import"./pullNews-68e01d94.js";import"./TemplateLibrary-f59d0076.js";import"./welcome-6ff4c53e.js";import"./SelectCustomer-88c1f692.js";import"./businessConver-2b86f97c.js";import"./SelectEndDate-6c9f798c.js";import"./moment-8163541f.js";import"./SelectSendType-b1e10e8d.js";import"./Step3Type2-084f3476.js";import"./SelectGroup-82211b43.js";import"./Step3Type3-32e1f72c.js";import"./Step3Type4-e2c75edf.js";import"./SelectMember-7e073ac7.js";import"./organization-9bed3593.js";import"./SelectDept-7a07b4de.js";import"./SelectPost-d0ccd09d.js";import"./FriendsCircPreview-70a3a02c.js";import"./AppPreview-1f4ca0cc.js";const A={components:{},props:{visible:{type:Boolean,default:!1},title:{type:String,default:"选择短链"},selected:{type:Array,default:()=>[]}},data:()=>({isInit:!0,touchTypeDict:l,loading:!0,query:{pageNum:1,pageSize:10,type:null,shortLinkName:""},list:[],total:0,radio:"",dialogVisible:!1}),watch:{selected:{deep:!0,handler(e){this.setSelected()}},list:{deep:!0,handler(e){this.setSelected()}}},computed:{Pvisible:{get(){return this.visible},set(e){this.$emit("update:visible",e)}}},created(){this.getList()},mounted(){},methods:{resetForm(){this.$refs.queryForm.resetFields(),this.isInit=!0,this.getList(1)},search(){this.isInit=!1,this.query.pageNum=1,this.getList()},getList(e){e&&(this.query.pageNum=e),this.loading=!0,i(this.query).then((({rows:e,total:t})=>{this.radio="",this.list=e||[],this.total=+t,this.loading=!1})).catch((()=>{this.loading=!1}))},submit(){this.radio?(this.Pvisible=!1,this.$emit("success",this.radio)):this.msgError("请选择一项！")},setSelected(){this.selected.length&&this.list.forEach((e=>{e.id==this.selected[0].id&&(this.radio=e)}))}}},D={style:{padding:"10px 0"}},O={key:1,class:"empty"},$={style:{"margin-top":"30px"}};const z={name:"short-link-popularize-add",components:{Preview:t,SelectPosterSingle:e,SelectShortLink:S(A,[["render",function(e,t,i,l,b,k){const _=s("el-input"),S=s("el-form-item"),L=s("el-option"),w=s("el-select"),C=s("el-button"),x=s("el-form"),I=s("el-radio"),q=s("el-table-column"),U=s("el-icon-copy-document"),T=s("el-table"),P=s("pagination"),V=s("el-col"),N=s("el-row"),F=s("el-dialog"),A=o("loading");return a(),r("div",null,[n(F,{title:i.title,modelValue:k.Pvisible,"onUpdate:modelValue":t[10]||(t[10]=e=>k.Pvisible=e),width:"800px","append-to-body":"","close-on-click-modal":!1},p({default:d((()=>[b.list.length||!b.isInit?(a(),u(N,{key:0,type:"flex",justify:"space-between",style:{"max-height":"500px"}},{default:d((()=>[n(V,{style:{"margin-top":"0px"}},{default:d((()=>[m("div",null,[n(x,{ref:"queryForm",model:b.query,inline:!0,"label-width":""},{default:d((()=>[n(S,{label:"短链名称",prop:"shortLinkName"},{default:d((()=>[n(_,{clearable:"",modelValue:b.query.shortLinkName,"onUpdate:modelValue":t[0]||(t[0]=e=>b.query.shortLinkName=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1}),n(S,{label:"类型",prop:"type"},{default:d((()=>[n(w,{clearable:"",modelValue:b.query.type,"onUpdate:modelValue":t[1]||(t[1]=e=>b.query.type=e),placeholder:"请选择"},{default:d((()=>[(a(!0),r(h,null,y(b.touchTypeDict,((e,t)=>(a(),u(L,{key:t,label:e.allName,value:+t},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),n(S,{label:""},{default:d((()=>[n(C,{type:"primary",onClick:t[2]||(t[2]=e=>k.search())},{default:d((()=>[c("查询")])),_:1}),n(C,{onClick:t[3]||(t[3]=e=>k.resetForm())},{default:d((()=>[c("重置")])),_:1})])),_:1})])),_:1},8,["model"]),g((a(),u(T,{data:b.list},{default:d((()=>[n(q,{width:"30"},{default:d((({row:e})=>[n(I,{modelValue:b.radio,"onUpdate:modelValue":t[4]||(t[4]=e=>b.radio=e),label:e},null,8,["modelValue","label"])])),_:1}),n(q,{label:"短链名称",align:"center",prop:"shortLinkName","show-overflow-tooltip":""}),n(q,{label:"类型",align:"center",prop:"type"},{default:d((({row:e})=>[c(f(b.touchTypeDict[e.type+""].allName),1)])),_:1}),n(q,{label:"短链地址",align:"center",prop:"shortLink","show-overflow-tooltip":""},{default:d((({row:e})=>[m("span",null,f(e.shortLink),1),n(U,{class:"el-icon-copy-document copy-btn cp ml20",title:"复制","data-clipboard-text":e.shortLink},null,8,["data-clipboard-text"])])),_:1}),n(q,{label:"最近更新时间",align:"center",prop:"updateTime",width:"180"})])),_:1},8,["data"])),[[A,b.loading]]),g(n(P,{total:b.total,page:b.query.pageNum,"onUpdate:page":t[5]||(t[5]=e=>b.query.pageNum=e),limit:b.query.pageSize,"onUpdate:limit":t[6]||(t[6]=e=>b.query.pageSize=e),onPagination:t[7]||(t[7]=e=>k.getList())},null,8,["total","page","limit"]),[[j,b.total>0]])])])),_:1})])),_:1})):v("",!0),!b.list.length&&b.isInit?(a(),r("div",O,[m("div",null,[c(" 暂无短链，点击下方按钮立即创建 "),m("div",$,[n(C,{type:"primary",onClick:t[9]||(t[9]=t=>e.$router.push("/drainageCode/publicCustomer/IntelligentShortLink/index"))},{default:d((()=>[c(" 去新建 ")])),_:1})])])])):v("",!0)])),_:2},[b.list.length||!b.isInit?{name:"footer",fn:d((()=>[m("div",D,[n(C,{onClick:t[8]||(t[8]=e=>k.Pvisible=!1)},{default:d((()=>[c("取 消")])),_:1}),n(C,{type:"primary",onClick:k.submit},{default:d((()=>[c("确 定")])),_:1},8,["onClick"])])])),key:"0"}:void 0]),1032,["title","modelValue"])])}],["__scopeId","data-v-08205fb1"]]),ShowShortLinkVue:w,Step3:L},data:()=>({loading:!1,form:{taskName:"",shortLinkId:"",style:0,materialId:"",type:0,client:{type:0,sex:null,trackState:null,addBeginTime:"",addEndTime:"",labelIds:"",userIds:"",sendType:0,taskSendTime:"",taskEndTime:""},attachments:[],senderList:[]},currentActive:0,choseDialog:!1,showShortLink:!1,shortLinkObj:[],posterUrl:"",posterObj:{},rules:{taskName:[{required:!0,message:"请输入任务名称",trigger:"blur"}],shortLinkId:[{required:!0,message:"请选择短链",trigger:"blur"}],style:[{required:!0,message:"请选择推广样式",trigger:"blur"}],materialId:[{required:!0,message:"请选择海报",trigger:"blur"}]}}),methods:{setTypeFn(e){this.form.type=e},setChange(e){0==e&&(this.posterUrl="",this.posterObj={},this.form.materialId="")},saveFn(){C(this.form).then((e=>{200==e.code&&(this.msgSuccess("操作成功!"),this.$router.back()),this.loading=!1})).catch((()=>{this.loading=!1}))},gotoNext(){this.$refs.baseForm.validate((e=>{e&&(this.currentActive=1)}))},handleRemove(){this.posterUrl="",this.posterObj={},this.form.materialId=""},getItemArry(e){this.posterUrl=e.materialUrl,this.posterObj=e,this.form.materialId=e.id},getShortLink(e){this.form.shortLinkId=e.id,this.shortLinkObj=[e]},getUpdateData(e){this.form=e},updateSteps(e){this.currentActive=e},getDetailFn(){x(this.id).then((e=>{this.form=e.data,this.setEdit()}))},setEdit(){this.form.shortLinkId&&(this.shortLinkObj=[this.form.shortLink]),1==this.form.style&&(this.posterObj=this.form.weMaterial,this.posterUrl=this.posterObj.materialUrl)}},created(){this.id=this.$route.query.id,this.$route.query.promotion&&(this.currentActive=1),this.id&&this.getDetailFn()}},E=e=>(k("data-v-beac0ec1"),e=e(),_(),e),M={class:"g-card"},B={class:"g-card"},G={style:{"margin-top":"10px"}},K={key:0,class:"sub-des"},R={key:1,class:"sub-des"},Z={key:0,style:{"margin-top":"10px"}},J={class:"el-upload-list el-upload-list--picture-card"},X={class:"el-upload-list__item is-success"},Y=["src"],H={class:"el-upload-list__item-actions"},Q={class:"el-upload-list__item-delete"},W={class:"g-card",style:{"text-align":"right"}},ee={class:"g-card",style:{height:"100%"}},te=E((()=>m("div",{class:"info_title"},"消息预览",-1))),ie={class:"g-card"},le=E((()=>m("div",{class:"unit"},[m("div",{class:"title"},"推广方式")],-1))),se={class:"unit"},oe={key:0,class:"icon-style",src:I,alt:""},ae={key:1,class:"icon-style",src:P,alt:""},re=E((()=>m("div",null,[m("div",{class:"item-title"},"群发客户"),m("div",{class:"item-text"},"员工将推广内容一键群发给客户")],-1))),ne={key:0,class:"icon-style",src:q,alt:""},pe={key:1,class:"icon-style",src:V,alt:""},de=E((()=>m("div",null,[m("div",{class:"item-title"},"群发客户群"),m("div",{class:"item-text"},"员工将推广内容一键群发给客户群")],-1))),me={key:0,class:"icon-style",src:U,alt:""},ce={key:1,class:"icon-style",src:N,alt:""},ue=E((()=>m("div",null,[m("div",{class:"item-title"},"群发朋友圈"),m("div",{class:"item-text"},"员工将推广内容一键群发到朋友圈")],-1))),he={key:0,class:"icon-style",src:T,alt:""},ye={key:1,class:"icon-style",src:F,alt:""},ge=E((()=>m("div",null,[m("div",{class:"item-title"},"应用消息"),m("div",{class:"item-text"},"员工收到应用消息，选择客户发送")],-1))),fe={class:"g-card",style:{"text-align":"right"}};const je=S(z,[["render",function(e,t,i,l,p,y){const j=s("el-step"),k=s("el-steps"),_=s("el-input"),S=s("el-form-item"),L=s("el-button"),w=s("ShowShortLinkVue"),C=s("el-radio"),x=s("el-radio-group"),I=s("el-icon-delete"),q=s("el-form"),U=s("el-col"),T=s("Preview"),P=s("el-row"),V=s("Step3"),N=s("SelectPosterSingle"),F=s("SelectShortLink"),A=o("loading");return a(),r("div",null,[m("div",M,[n(k,{active:p.currentActive,"align-center":"","finish-status":"success"},{default:d((()=>[n(j,{title:"基本信息"}),n(j,{title:"推广方式"}),n(j,{title:"推广设置"})])),_:1},8,["active"])]),0==p.currentActive?(a(),u(P,{key:0,gutter:20,type:"flex",style:{"margin-top":"20px"}},{default:d((()=>[n(U,null,{default:d((()=>[m("div",B,[n(q,{ref:"baseForm",rules:p.rules,model:p.form,"label-position":"right","label-width":"100px"},{default:d((()=>[n(S,{label:"任务名称:",prop:"taskName"},{default:d((()=>[n(_,{maxlength:"15",placeholder:"请输入名称",modelValue:p.form.taskName,"onUpdate:modelValue":t[0]||(t[0]=e=>p.form.taskName=e),"show-word-limit":"",clearable:""},null,8,["modelValue"])])),_:1}),n(S,{label:"推广短链:",prop:"shortLinkId"},{default:d((()=>[n(L,{type:"primary",icon:"el-icon-plus",onClick:t[1]||(t[1]=e=>p.showShortLink=!0)},{default:d((()=>[c(f(p.form.shortLinkId?"编辑":"选择")+"短链 ",1)])),_:1}),n(L,{type:"primary",onClick:t[2]||(t[2]=t=>e.$router.push("/drainageCode/publicCustomer/IntelligentShortLink/index"))},{default:d((()=>[c(" 去新建 ")])),_:1}),m("div",G,[n(w,{data:p.shortLinkObj},null,8,["data"])])])),_:1}),n(S,{label:"推广样式:",prop:"style"},{default:d((()=>[n(x,{modelValue:p.form.style,"onUpdate:modelValue":t[3]||(t[3]=e=>p.form.style=e),onChange:y.setChange},{default:d((()=>[n(C,{label:0},{default:d((()=>[c("短链二维码")])),_:1}),n(C,{label:1},{default:d((()=>[c("短链海报")])),_:1})])),_:1},8,["modelValue","onChange"]),0==p.form.style?(a(),r("div",K,"以二维码图片形式触达客户")):v("",!0),1==p.form.style?(a(),r("div",R,"在海报中附加二维码触达客户")):v("",!0)])),_:1}),1==p.form.style?(a(),u(S,{key:0,label:"推广海报:",prop:"materialId"},{default:d((()=>[n(L,{type:"primary",icon:"el-icon-plus",onClick:t[4]||(t[4]=e=>p.choseDialog=!0)},{default:d((()=>[c(f(p.form.materialId?"编辑":"选择")+"海报 ",1)])),_:1}),p.posterUrl?(a(),r("div",Z,[m("ul",J,[m("li",X,[m("img",{style:{width:"100%",height:"100%"},src:p.posterUrl},null,8,Y),m("span",H,[m("span",Q,[n(I,{class:"el-icon-delete",onClick:y.handleRemove},null,8,["onClick"])])])])])])):v("",!0)])),_:1})):v("",!0)])),_:1},8,["rules","model"])]),m("div",W,[n(L,{plain:"",onClick:t[5]||(t[5]=t=>e.$router.go(-1))},{default:d((()=>[c("取消")])),_:1}),n(L,{type:"primary",onClick:y.gotoNext},{default:d((()=>[c("下一步")])),_:1},8,["onClick"])])])),_:1}),n(U,{style:{"flex-basis":"370px"}},{default:d((()=>[m("div",ee,[te,n(T,{value:p.posterUrl},null,8,["value"])])])),_:1})])),_:1})):v("",!0),1==p.currentActive?(a(),r(h,{key:1},[m("div",ie,[le,m("div",se,[m("div",{class:b(["unit-item",{active_item:0==p.form.type}]),onClick:t[6]||(t[6]=e=>y.setTypeFn(0))},[m("div",null,[0==p.form.type?(a(),r("img",oe)):(a(),r("img",ae))]),re],2),m("div",{class:b(["unit-item",{active_item:1==p.form.type}]),onClick:t[7]||(t[7]=e=>y.setTypeFn(1))},[m("div",null,[1==p.form.type?(a(),r("img",ne)):(a(),r("img",pe))]),de],2),m("div",{class:b(["unit-item",{active_item:2==p.form.type}]),onClick:t[8]||(t[8]=e=>y.setTypeFn(2))},[m("div",null,[2==p.form.type?(a(),r("img",me)):(a(),r("img",ce))]),ue],2),m("div",{class:b(["unit-item",{active_item:3==p.form.type}]),onClick:t[9]||(t[9]=e=>y.setTypeFn(3))},[m("div",null,[3==p.form.type?(a(),r("img",he)):(a(),r("img",ye))]),ge],2)])]),m("div",fe,[n(L,{plain:"",onClick:t[10]||(t[10]=e=>p.currentActive=0)},{default:d((()=>[c("上一步")])),_:1}),g((a(),u(L,{plain:"",onClick:y.saveFn},{default:d((()=>[c("保存，暂不推广")])),_:1},8,["onClick"])),[[A,p.loading]]),n(L,{type:"primary",onClick:t[11]||(t[11]=e=>p.currentActive=2)},{default:d((()=>[c("下一步")])),_:1})])],64)):v("",!0),2==p.currentActive?(a(),u(V,{key:2,posterObj:p.posterObj,data:p.form,onUpdate:y.getUpdateData,onSteps:y.updateSteps},null,8,["posterObj","data","onUpdate","onSteps"])):v("",!0),n(N,{visible:p.choseDialog,"onUpdate:visible":t[12]||(t[12]=e=>p.choseDialog=e),onSuccess:y.getItemArry},null,8,["visible","onSuccess"]),n(F,{visible:p.showShortLink,"onUpdate:visible":t[13]||(t[13]=e=>p.showShortLink=e),onSuccess:y.getShortLink},null,8,["visible","onSuccess"])])}],["__scopeId","data-v-beac0ec1"]]);export{je as default};
