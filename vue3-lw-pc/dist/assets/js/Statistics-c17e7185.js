import{d as e}from"../index-044285d2.js";import t from"./ChartLine-b009fc4d.js";import a from"./SearchTitle-ceb204ee.js";import{g as i,b as s,c as o,d as l}from"./api-0004a25c.js";import{_ as r}from"./quill-image-resize-module-c051113e.js";import{ai as n,aq as p,o as m,c as d,_ as u,a as h,V as c,T as g,U as j,Y as f}from"./@vue-e400fd81.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";import"./echarts-8e7b9cd7.js";import"./tslib-a4e99503.js";import"./zrender-da4e2cf7.js";import"./lodash.merge-f1a4e0c2.js";import"./moment-8163541f.js";const b={name:"fission-statistics",components:{SearchTitle:a,ChartLine:t},props:{fassionType:{type:Number,default:1}},watch:{fassionType:{handler(e){this.legend=1==e?["完成任务老客数","裂变新客数"]:["完成任务客户数","裂变新客数"]},immediate:!0}},data(){return{legend:["完成任务老客数","裂变新客数"],xdata:[],series:[],cardData:[{title:1==this.fassionType?"员工邀请老客总数":"员工触达客群总数",tips:1==this.fassionType?"在当前任务中员工已送达的客户总数":"在当前任务中员工已送达的客群总数",value:0},{title:1==this.fassionType?"完成任务老客总数":"完成任务客户总数",tips:1==this.fassionType?"在当前任务中完成裂变任务的老客总数":"在当前任务中完成裂变任务的客户总数",value:0},{title:"裂变新客总数",tips:1==this.fassionType?"在当前任务中成功添加员工的新客总数":"在当前任务中成功添加客群的新客总数",value:0},{title:1==this.fassionType?"今日完成任务老客数":"今日完成任务客户数",tips:1==this.fassionType?"在当前任务中今日完成裂变任务的老客数":"在当前任务中今日完成裂变任务的客户数",value:0,title1:"较昨日",value1:0},{title:"今日裂变新客数",tips:1==this.fassionType?"在当前任务中今日成功添加员工的新客数":"在当前任务中今日成功添加客群的新客总数",value:0,title1:"较昨日",value1:0}],value:[],id:"",exportLoading:!1,tableList:[],loading:!1,total:0,query:{pageSize:10,pageNum:1,beginTime:"",endTime:""},tableSearch:{}}},methods:{getTabTotalFn(){i(this.id).then((e=>{this.cardData[0].value=e.data.inviterOldCustomerNum,this.cardData[1].value=e.data.completeTaskOldCustomerNum,this.cardData[2].value=e.data.fissionCustomerNum,this.cardData[3].value=e.data.tdCompleteTaskOldCustomerNum,this.cardData[3].value1=Number(e.data.tdCompleteTaskOldCustomerNum)-Number(e.data.ydCompleteTaskOldCustomerNum),this.cardData[4].value=e.data.tdFissionCustomerNum,this.cardData[4].value1=Number(e.data.tdFissionCustomerNum)-Number(e.data.ydFissionCustomerNum)}))},getLineData(e){e.id=this.id,s(e).then((({data:e})=>{let t=[],a=[],i=[];e.forEach((e=>{t.push(e.date),a.push(e.completeTaskOldCustomerNum),i.push(e.fissionCustomerNum)})),this.xdata=t,this.series=[a,i]}))},exportFn(){this.$confirm("确认导出吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>(this.exportLoading=!0,o(Object.assign({},this.tableSearch))))).then((t=>{if(t){let a=new Blob([t],{type:"application/vnd.ms-excel"}),i=window.URL.createObjectURL(a);const s=document.createElement("a");s.href=i,s.download="数据明细-"+e(new Date)+".xlsx",s.click(),URL.revokeObjectURL(i)}})).catch((e=>{})).finally((()=>{this.exportLoading=!1}))},getTableChangeSize(){this.loading=!0,l(Object.assign({},this.query)).then((e=>{this.tableList=e.rows,this.total=Number(e.total),this.loading=!1}))},getTableFn(e){this.tableSearch=e,this.loading=!0,this.query.id=this.id,this.query.beginTime=e.beginTime,this.query.endTime=e.endTime,this.getTableChangeSize()}},created(){this.id=this.$route.query.id,this.getTabTotalFn()}},y={class:"g-card"},T=h("div",{class:"g-card-title"},"数据趋势",-1),v={class:"g-card"},w=h("div",{class:"g-card-title"},"数据报表",-1),C={style:{display:"flex","justify-content":"space-between"}};const N=r(b,[["render",function(e,t,a,i,s,o){const l=n("CardGroupIndex"),r=n("search-title"),b=n("chart-line"),N=n("el-button"),x=n("el-table-column"),q=n("el-table"),L=n("pagination"),D=p("loading");return m(),d("div",null,[u(l,{data:s.cardData},null,8,["data"]),h("div",y,[T,u(r,{showMore:!0,onSearch:o.getLineData},null,8,["onSearch"]),u(b,{style:{height:"300px"},legend:s.legend,xData:s.xdata,series:s.series},null,8,["legend","xData","series"])]),h("div",v,[w,h("div",C,[u(r,{showMore:!0,onSearch:o.getTableFn},null,8,["onSearch"]),c((m(),g(N,{type:"primary",onClick:o.exportFn},{default:j((()=>[f("导出Excel")])),_:1},8,["onClick"])),[[D,s.exportLoading]])]),c((m(),g(q,{data:s.tableList,style:{width:"100%"}},{default:j((()=>[u(x,{label:"日期",align:"center","min-width":"100",prop:"date","show-overflow-tooltip":""}),u(x,{label:1==a.fassionType?"完成任务老客总数":"完成任务客户总数",align:"center",prop:"completeTaskOldCustomerNum","min-width":"100","show-overflow-tooltip":""},null,8,["label"]),u(x,{label:"裂变新客总数",align:"center",prop:"fissionCustomerNum","min-width":"100","show-overflow-tooltip":""}),u(x,{label:1==a.fassionType?"今日完成任务老客数":"今日完成任务客户数",align:"center",prop:"tdCompleteTaskOldCustomerNum","min-width":"120","show-overflow-tooltip":""},null,8,["label"]),u(x,{label:"今日裂变新客数",align:"center",prop:"tdFissionCustomerNum","min-width":"120","show-overflow-tooltip":""})])),_:1},8,["data"])),[[D,s.loading]]),u(L,{total:s.total,page:s.query.pageNum,"onUpdate:page":t[0]||(t[0]=e=>s.query.pageNum=e),limit:s.query.pageSize,"onUpdate:limit":t[1]||(t[1]=e=>s.query.pageSize=e),onPagination:t[2]||(t[2]=e=>o.getTableChangeSize())},null,8,["total","page","limit"])])])}]]);export{N as default};
