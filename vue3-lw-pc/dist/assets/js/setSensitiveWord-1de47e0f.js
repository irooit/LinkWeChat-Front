import{c as e,d as t,m as a,e as s,f as i}from"./security-61ce0ef0.js";import{ai as l,o as r,c as o,a as d,_ as n,U as p,Y as u,T as m,K as g,V as c,$ as h,a9 as U,Z as f,bl as b,bj as S}from"./@vue-e400fd81.js";import{_ as y}from"./quill-image-resize-module-c051113e.js";import"../index-044285d2.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";const j={components:{},data:()=>({form:{pageSize:10,pageNum:1,patternWords:""},addForm:{strategyName:"",patternWords:""},alertFlag:0,tableData:[],errorMsg:"",rangeErrorMsg:"",query:{pageNum:1,pageSize:10},auditUserRange:[],auditUser:[],total:0,dialogVisibleSelectUser:!1,dialogVisibleSelectAuditUser:!1,open:!1,submitFlag:"",rowId:"",rules:{strategyName:[{required:!0,message:"敏感词策略不能为空",trigger:"blur"}],patternWords:[{required:!0,message:"匹配词不能为空",trigger:"blur"}]}}),mounted(){this.getSettingList()},methods:{getSettingList(){this.form.pageSize=this.query.pageSize,this.form.pageNum=this.query.pageNum,e(this.form).then((e=>{200===e.code&&(this.tableData=e.rows,this.total=Number(e.total))}))},addSensitiveForm(){this.$refs.addForm.validate((e=>{if(e){if(0===this.auditUser.length)return void(this.errorMsg="请选择审计人");this.rangeErrorMsg="";const e=this.addForm;if(this.auditUserRange.length){let t=[];const a={scopeType:2,auditScopeId:this.auditUserRange.map((e=>e.userId))+"",auditScopeName:this.auditUserRange.map((e=>e.name))+""};t.push(a),e.auditUserScope=t}else e.auditUserScope=[];e.auditUserId=this.auditUser.map((e=>e.userId))+"",e.auditUserName=this.auditUser.map((e=>e.name))+"",e.alertFlag=this.alertFlag,"add"===this.submitFlag&&t(e).then((e=>{200===e.code&&(this.open=!1,this.getSettingList())})),"modify"===this.submitFlag&&(e.id=this.rowId,a(e).then((e=>{200===e.code&&(this.open=!1,this.getSettingList())})))}}))},openAuditUserRange(){this.dialogVisibleSelectUser=!0},openAuditUser(){this.dialogVisibleSelectAuditUser=!0},resetForm(){this.addForm={strategyName:"",patternWords:""},this.auditUserRange=[],this.auditUser=[],this.alertFlag=0,this.errorMsg=""},addSensitive(){this.submitFlag="add",this.resetForm(),this.open=!0},selectedUser(e){this.auditUserRange=e},selectedAuditUser(e){this.auditUser=e},handleUpdate(e){this.submitFlag="modify",this.errorMsg="",this.rowId=e.id,s(this.rowId).then((e=>{200===e.code&&(this.addForm.strategyName=e.data.strategyName,this.addForm.patternWords=e.data.patternWords,this.auditUser=[{name:e.data.auditUserName,userId:e.data.auditUserId}],e.data.auditUserScope.length?this.auditUserRange=[{name:e.data.auditUserScope[0].auditScopeName,userId:e.data.auditUserScope[0].auditScopeId,department:e.data.auditUserScope[0].scopeType}]:this.auditUserRange=[],this.alertFlag=e.data.alertFlag)})),this.open=!0},handleDelete(e){this.$confirm("是否确认删除吗?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then((()=>i(e.id).then((e=>{200===e.code&&(this.msgSuccess("删除成功"),this.getSettingList())}))))},handleStatusChange(e){a(e).then((e=>{200===e.code&&(this.msgSuccess("操作成功"),this.getSettingList())}))}}},v=e=>(b("data-v-a31f508f"),e=e(),S(),e),F={class:"add-sensitive-word"},V={class:"g-card"},k={class:"mid-action"},N=v((()=>d("div",{class:"sub-title"},"匹配词间用逗号隔开",-1))),_={key:0,class:"tag-place"},w=v((()=>d("span",{class:"prompt-title"},"若不选择，则默认全体成员",-1))),C={key:0,class:"tag-place"},q=v((()=>d("span",{class:"prompt-title"},"请选择部门负责人",-1))),I={class:"dialog-footer"};const A=y(j,[["render",function(e,t,a,s,i,b){const S=l("el-button"),y=l("el-input"),j=l("el-table-column"),v=l("TagEllipsis"),A=l("el-switch"),R=l("el-table"),x=l("pagination"),W=l("el-form-item"),z=l("el-tag"),L=l("el-form"),M=l("el-dialog"),T=l("SelectUser");return r(),o("div",F,[d("div",V,[d("div",k,[n(y,{modelValue:i.form.patternWords,"onUpdate:modelValue":t[0]||(t[0]=e=>i.form.patternWords=e),placeholder:"搜索关键词",style:{width:"300px"}},{append:p((()=>[n(S,{icon:"el-icon-search",onClick:b.getSettingList},null,8,["onClick"])])),_:1},8,["modelValue"]),n(S,{type:"primary",class:"add-btn",onClick:b.addSensitive},{default:p((()=>[u("添加敏感词")])),_:1},8,["onClick"])]),n(R,{data:i.tableData},{default:p((()=>[n(j,{prop:"strategyName",label:"策略名称"}),n(j,{prop:"patternWords",label:"匹配词"}),n(j,{prop:"auditScopeName",label:"审计范围"},{default:p((({row:e})=>[e.auditUserScope&&e.auditUserScope.length?(r(),m(v,{key:0,list:e.auditUserScope[0].auditScopeName.split(",")},null,8,["list"])):(r(),o(g,{key:1},[u("全体成员")],64))])),_:1}),n(j,{prop:"auditUserName",label:"审计人"}),n(j,{label:"消息通知"},{default:p((e=>[n(A,{modelValue:e.row.alertFlag,"onUpdate:modelValue":t=>e.row.alertFlag=t,"active-value":1,"inactive-value":0,onChange:t=>b.handleStatusChange(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),n(j,{label:"操作"},{default:p((e=>[n(S,{text:"",onClick:t=>b.handleUpdate(e.row)},{default:p((()=>[u("修改")])),_:2},1032,["onClick"]),n(S,{text:"",onClick:t=>b.handleDelete(e.row)},{default:p((()=>[u("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),c(n(x,{total:i.total,page:i.query.pageNum,"onUpdate:page":t[1]||(t[1]=e=>i.query.pageNum=e),limit:i.query.pageSize,"onUpdate:limit":t[2]||(t[2]=e=>i.query.pageSize=e),onPagination:t[3]||(t[3]=e=>b.getSettingList())},null,8,["total","page","limit"]),[[h,i.total>0]])]),n(M,{title:"添加敏感词",modelValue:i.open,"onUpdate:modelValue":t[10]||(t[10]=e=>i.open=e),width:"600px","append-to-body":"","close-on-click-modal":!1},{footer:p((()=>[d("div",I,[n(S,{type:"primary",onClick:b.addSensitiveForm},{default:p((()=>[u("确 定")])),_:1},8,["onClick"]),n(S,{onClick:t[9]||(t[9]=e=>i.open=!1)},{default:p((()=>[u("取 消")])),_:1})])])),default:p((()=>[n(L,{ref:"addForm",model:i.addForm,rules:i.rules,"label-width":"130px"},{default:p((()=>[n(W,{label:"敏感词策略名称",prop:"strategyName"},{default:p((()=>[n(y,{modelValue:i.addForm.strategyName,"onUpdate:modelValue":t[4]||(t[4]=e=>i.addForm.strategyName=e),placeholder:"例：红包"},null,8,["modelValue"])])),_:1}),n(W,{label:"匹配词",prop:"patternWords"},{default:p((()=>[n(y,{modelValue:i.addForm.patternWords,"onUpdate:modelValue":t[5]||(t[5]=e=>i.addForm.patternWords=e),placeholder:"例：红包,hongbao,hb"},null,8,["modelValue"]),N])),_:1}),n(W,{label:"审计范围",error:i.rangeErrorMsg},{default:p((()=>[d("div",{class:"tag-input",style:{width:"auto"},onClick:t[6]||(t[6]=(...e)=>b.openAuditUserRange&&b.openAuditUserRange(...e))},[i.auditUserRange.length?(r(!0),o(g,{key:1},U(i.auditUserRange,((e,t)=>(r(),m(z,{type:"info",key:t},{default:p((()=>[u(f(e.name),1)])),_:2},1024)))),128)):(r(),o("span",_,[u(" 请选择 "),w]))])])),_:1},8,["error"]),n(W,{label:"审计人",required:!0,error:i.errorMsg},{default:p((()=>[d("div",{class:"tag-input",style:{width:"auto"},onClick:t[7]||(t[7]=(...e)=>b.openAuditUser&&b.openAuditUser(...e))},[i.auditUser.length?(r(!0),o(g,{key:1},U(i.auditUser,((e,t)=>(r(),m(z,{type:"info",key:t},{default:p((()=>[u(f(e.name),1)])),_:2},1024)))),128)):(r(),o("span",C,[u(" 请选择 "),q]))])])),_:1},8,["error"]),n(W,{label:"消息通知"},{default:p((()=>[n(A,{modelValue:i.alertFlag,"onUpdate:modelValue":t[8]||(t[8]=e=>i.alertFlag=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"]),n(T,{visible:i.dialogVisibleSelectUser,"onUpdate:visible":t[11]||(t[11]=e=>i.dialogVisibleSelectUser=e),title:"选择添加人",onSuccess:b.selectedUser},null,8,["visible","onSuccess"]),n(T,{visible:i.dialogVisibleSelectAuditUser,"onUpdate:visible":t[12]||(t[12]=e=>i.dialogVisibleSelectAuditUser=e),title:"选择添加人",isSigleSelect:"",onSuccess:b.selectedAuditUser},null,8,["visible","onSuccess"])])}],["__scopeId","data-v-a31f508f"]]);export{A as default};
