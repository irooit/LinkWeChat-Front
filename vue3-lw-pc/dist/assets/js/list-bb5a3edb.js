import{a2 as e}from"../index-044285d2.js";import t from"./ImportStore-91dc7261.js";import{g as o,q as i,c as s,r as a}from"./store-1f3cfa19.js";import{_ as r}from"./quill-image-resize-module-c051113e.js";import{ai as l,aq as d,o as n,c as p,a as u,V as c,Y as m,Z as g,_ as f,U as h,K as C,bl as v,bj as y}from"./@vue-e400fd81.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";const j={name:"store-list",data:()=>({getList:o,remove:i,list:[],total:0,ids:[],loading:!1,areaIds:[],query:{area:""},cityTree:[],props:{label:"name",value:"id"},importDialogVisible:!1,storeCode:{raidus:"",storeCodeConfigUrl:"",storeCodeConfigQr:""},storeGuide:{raidus:"",storeCodeConfigUrl:"",storeCodeConfigQr:""},storeLoading:!1,guideLoading:!1}),components:{ImportStore:t},created(){this.$store.setBusininessDesc("\n        <div>生成永久二维码，客户扫码后根据定位加入附近门店店主或门店群</div>\n      "),e({isExtName:!0}).then((({data:e})=>{this.cityTree=e})),this.guideLoading=!0,s(1).then((({data:e})=>{this.storeGuide=e,this.guideLoading=!1})),this.storeLoading=!0,s(2).then((({data:e})=>{this.storeCode=e,this.storeLoading=!1}))},methods:{switchFn(e){e.shopGuideName||e.groupCodeName?a(e.id,{storeState:e.storeState}).then((e=>{this.$refs.rct.getList()})):(e.storeState=1==e.storeState?0:1,this.msgError("开启门店必须要求保证导购人员或群活码至少设置一项"))},switchMultFn(e,t){if(!t.length)return void this.msgInfo("请选择要操作项！");if(!this.storeCode.storeCodeConfigQr&&!this.storeGuide.storeCodeConfigQr)return void this.msgInfo("门店导购及群活码都未配置, 无法操作！");const o=t.join(",");this.$confirm(`是否确认批量${e}已选门店？${e}后立即生效，请谨慎操作。`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>a(o,{storeState:"启用"===e?0:1}))).then((()=>{this.$refs.rct.getList(),this.msgSuccess("操作成功")})).catch((function(){}))},addNow(e){var t;(null==(t=this.$refs.rct.data)?void 0:t.length)?this.goRoute(e):this.$confirm(`暂无可用门店，请先创建门店后再尝试创建${"guideCode"===e?"门店导购码":"门店群活码"}。`,"提示",{confirmButtonText:"去新建",cancelButtonText:"取消",type:"warning"}).then((()=>this.goRoute("add"))).catch((function(){}))},reset(){this.areaIds=[],this.query={area:""}},handleChange(e){let t=this.$refs.tree.getCheckedNodes();t[0]&&(this.query.area=t[0].pathLabels.join(""))},goRoute(e,t){this.$router.push({path:e,query:{id:t}})}}},b=e=>(v("data-v-19ce4d89"),e=e(),y(),e),w={class:"tab flex"},_={class:"g-card mr20 fxauto"},k=b((()=>u("div",{class:"g-card-title"},[m(" 门店导购码 "),u("span",{class:"desc mr10"},"根据客户最近位置，引导添加最近门店的导购")],-1))),x={class:"unit_content"},V={key:0,class:"value"},q=["src"],N={class:"con"},U={class:"operate"},$={key:1,class:"empty"},L={class:"g-card mt0 fxauto"},S=b((()=>u("div",{class:"g-card-title"},[m(" 门店群活码 "),u("span",{class:"desc mr10"},"根据客户最近位置，引导添加最近门店的客户群")],-1))),Q={class:"unit_content"},T={key:0,class:"value"},G=["src"],I={class:"con"},R={class:"operate"},B={key:1,class:"empty"},D={class:"fxbw"},F=b((()=>u("div",null," 门店状态开启时必须要求保证导购人员或群活码至少设置一项；启用后，范围内的客户扫码可正常添加门店导购或群活码；停用后，扫码无法就近添加 ",-1))),z={class:"mb5"},E=["src"],M={key:1};const K=r(j,[["render",function(e,t,o,i,s,a){const r=l("el-button"),v=l("el-input"),y=l("el-form-item"),j=l("el-cascader"),b=l("el-option"),K=l("el-select"),O=l("el-table-column"),A=l("el-icon-QuestionFilled"),J=l("el-popover"),Y=l("el-switch"),Z=l("TagEllipsis"),H=l("RequestChartTable"),P=l("import-store"),W=d("loading");return n(),p("div",null,[u("div",w,[u("div",_,[k,c((n(),p("div",x,[s.storeGuide.storeCodeConfigQr?(n(),p("div",V,[u("img",{style:{height:"80px",width:"80px"},src:s.storeGuide.storeCodeConfigQr},null,8,q),u("div",N,[m(" 门店范围：距离门店"+g(s.storeGuide.raidus)+"公里内，客户可扫码添加门店导购 ",1),u("div",U,[u("div",null,[f(r,{type:"primary",onClick:t[0]||(t[0]=t=>e.downloadBlob(s.storeGuide.storeCodeConfigQr,"门店导购码.jpg","image"))},{default:h((()=>[m(" 下载活码 ")])),_:1}),f(r,{type:"primary",plain:"",onClick:t[1]||(t[1]=t=>e.$copyText(s.storeGuide.storeCodeConfigUrl))},{default:h((()=>[m("复制链接")])),_:1})]),f(r,{text:"",onClick:t[2]||(t[2]=e=>a.goRoute("guideDetail"))},{default:h((()=>[m("详情|统计>>")])),_:1})])])])):(n(),p("div",$,[f(r,{type:"primary",icon:"el-icon-plus",onClick:t[3]||(t[3]=e=>a.addNow("guideCode"))},{default:h((()=>[m("立即新建")])),_:1})]))])),[[W,s.storeLoading]])]),u("div",L,[S,c((n(),p("div",Q,[s.storeCode.storeCodeConfigQr?(n(),p("div",T,[u("img",{style:{height:"80px",width:"80px"},src:s.storeCode.storeCodeConfigQr},null,8,G),u("div",I,[m(" 门店范围：距离门店"+g(s.storeCode.raidus)+"公里内，客户可扫码添加门店群 ",1),u("div",R,[u("div",null,[f(r,{type:"primary",onClick:t[4]||(t[4]=t=>e.downloadBlob(s.storeCode.storeCodeConfigQr,"门店群活码.jpg","image"))},{default:h((()=>[m(" 下载活码 ")])),_:1}),f(r,{type:"primary",plain:"",onClick:t[5]||(t[5]=t=>e.$copyText(s.storeCode.storeCodeConfigUrl))},{default:h((()=>[m("复制链接")])),_:1})]),f(r,{text:"",onClick:t[6]||(t[6]=e=>a.goRoute("storeDetail"))},{default:h((()=>[m("详情|统计>>")])),_:1})])])])):(n(),p("div",B,[f(r,{type:"primary",icon:"el-icon-plus",onClick:t[7]||(t[7]=e=>a.addNow("storeCode"))},{default:h((()=>[m("立即新建")])),_:1})]))])),[[W,s.guideLoading]])])]),f(H,{class:"g-margin-t",ref:"rct",params:s.query,request:s.getList,onReset:a.reset},{query:h((({query:e})=>[f(y,{label:"门店名称",prop:"storeName"},{default:h((()=>[f(v,{modelValue:e.storeName,"onUpdate:modelValue":t=>e.storeName=t,placeholder:"请输入门店名称",clearable:""},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),f(y,{label:"所属地区"},{default:h((()=>[f(j,{modelValue:s.areaIds,"onUpdate:modelValue":t[8]||(t[8]=e=>s.areaIds=e),props:s.props,options:s.cityTree,ref:"tree",onChange:a.handleChange},null,8,["modelValue","props","options","onChange"])])),_:1}),f(y,{label:"状态",prop:"storeState"},{default:h((()=>[f(K,{modelValue:e.storeState,"onUpdate:modelValue":t=>e.storeState=t,"popper-append-to-body":!1},{default:h((()=>[f(b,{label:"全部状态",value:""}),f(b,{label:"启用",value:"0"}),f(b,{label:"停用",value:"1"})])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),operation:h((({selectedIds:o})=>[u("div",D,[u("div",null,[f(r,{type:"primary",onClick:t[9]||(t[9]=e=>a.goRoute("add"))},{default:h((()=>[m("新建")])),_:1}),f(r,{type:"primary",plain:"",onClick:t[10]||(t[10]=e=>s.importDialogVisible=!0)},{default:h((()=>[m("批量导入")])),_:1})]),u("div",null,[f(r,{type:"primary",plain:"",onClick:e=>a.switchMultFn("启用",o)},{default:h((()=>[m("批量启用")])),_:2},1032,["onClick"]),f(r,{type:"primary",plain:"",onClick:e=>a.switchMultFn("停用",o)},{default:h((()=>[m("批量停用")])),_:2},1032,["onClick"]),f(r,{type:"primary",plain:"",onClick:t[11]||(t[11]=t=>e.$refs.rct.remove(s.remove))},{default:h((()=>[m("批量删除")])),_:1})])])])),table:h((()=>[f(O,{label:"门店名称",align:"center",prop:"storeName","show-overflow-tooltip":""}),f(O,{label:"所属地区",align:"center",prop:"area","show-overflow-tooltip":""}),f(O,{label:"详细地址",align:"center",prop:"address"}),f(O,{label:"门店状态",align:"center",prop:"storeState","show-overflow-tooltip":""},{header:h((()=>[f(J,{placement:"top",trigger:"hover"},{reference:h((()=>[u("div",null,[m(" 门店状态 "),f(A,{class:"el-icon-QuestionFilled"})])])),default:h((()=>[F])),_:1})])),default:h((({row:e})=>[f(Y,{onChange:t=>a.switchFn(e),modelValue:e.storeState,"onUpdate:modelValue":t=>e.storeState=t,"active-value":0,"inactive-value":1},null,8,["onChange","modelValue","onUpdate:modelValue"])])),_:1}),f(O,{label:"门店导购",align:"center",prop:"shopGuideName"},{default:h((({row:e})=>[f(Z,{list:e.shopGuideName,emptyText:"-"},null,8,["list"])])),_:1}),f(O,{label:"门店群活码",align:"center",prop:"groupCodeName","show-overflow-tooltip":""},{default:h((({row:e})=>[e.groupCodeName?(n(),p(C,{key:0},[u("div",z,g(e.groupCodeName),1),u("img",{style:{height:"80px",width:"80px"},src:e.groupCodeUrl},null,8,E)],64)):(n(),p("div",M,"-"))])),_:1}),f(O,{label:"操作",align:"center",fixed:"right"},{default:h((({row:t})=>[f(r,{text:"",onClick:e=>a.goRoute("detail",t.id)},{default:h((()=>[m("详情|统计")])),_:2},1032,["onClick"]),f(r,{text:"",onClick:e=>a.goRoute("add",t.id)},{default:h((()=>[m("编辑")])),_:2},1032,["onClick"]),f(r,{text:"",onClick:o=>e.$refs.rct.remove(s.remove,t.id)},{default:h((()=>[m("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["params","request","onReset"]),f(P,{visible:s.importDialogVisible,"onUpdate:visible":t[12]||(t[12]=e=>s.importDialogVisible=e),onUpdate:t[13]||(t[13]=t=>e.$refs.rct.getList(1))},null,8,["visible"])])}],["__scopeId","data-v-19ce4d89"]]);export{K as default};
