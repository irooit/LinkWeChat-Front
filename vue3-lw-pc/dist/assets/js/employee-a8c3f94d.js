import e from"./chatListClass-6b90b481.js";import t from"./userList-5f5fa420.js";import s from"./groupList-461a49a8.js";import{a,g as i}from"./organization-9bed3593.js";import{b as o,c as r,a as l}from"./content-6f300c2d.js";import{ai as d,o as n,c as p,_ as m,U as h,a as c,aa as u,V as f,K as j,a9 as y,P as g,Z as k,$ as v,T as C,X as N}from"./@vue-e400fd81.js";import{_ as I}from"./quill-image-resize-module-c051113e.js";import"./chatListClassTab-8f19ff1a.js";import"./chatList-5fb10f1d.js";import"./ChatContent-f938bb33.js";import"../index-044285d2.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";import"./benz-amr-recorder-259e7c16.js";const L={class:"employ"},b={class:"ct_box",style:{height:"calc(100vh - 197px)"}},x={class:"search-list"},_=["onClick"],w={class:"ct_box",style:{height:"calc(100vh - 197px)"}},q={class:"name pd15"},F={class:"ct_box",style:{height:"calc(100vh - 197px)"}};const z=I({components:{grouplist:s,userList:t,chatListClass:e},data:()=>({keywords:"",searchResult:[],fromId:"",talkName:"",defaultExpandedKeys:[],defaultProps:{label:"name",children:"children",isLeaf:"isLeaf"},activeName:"0",chat:{},personList:[],loading:!1,queryChat:{}}),watch:{},mounted(){},methods:{chatFn(e){this.queryChat={fromId:this.fromId,receiveName:e.name,toList:e.receiver}},groupFn(e){this.queryChat={receiveName:e.name,roomId:e.receiver}},tabClick(e){this.personList=[],this.fromId&&(e&&(this.loading=!0),0==this.activeName?o(this.fromId).then((({data:e})=>{this.loading=!1,this.personList=e})).catch((e=>{this.loading=!1})):1==this.activeName?r(this.fromId).then((({data:e})=>{this.loading=!1,this.personList=e})).catch((e=>{this.loading=!1})):l(this.fromId).then((({data:e})=>{this.loading=!1,this.personList=e})).catch((e=>{this.loading=!1})))},filterNode:(e,t)=>!e||-1!==t.name.indexOf(e),loadNode(e,t){if(0==e.level)a().then((({data:e})=>{let s=this.treeFormat(this.handleDepart(e));s[0]&&(this.defaultExpandedKeys=[s[0].id]),t(s)}));else if(e.data.userId)t([]);else{let s={pageNum:"1",pageSize:"999",isActivate:"",deptId:e.data.id};i(s).then((({rows:s})=>{let a=this.handleUser(s);e.data.children&&a.push(...e.data.children),a.forEach((e=>{e.isLeaf=!!e.userId})),t(a)}))}},getDeptUser(){this.keywords&&(this.searchResult=[],i({userName:this.keywords}).then((e=>{this.searchResult=this.handleUser(e.rows)})))},treeFormat(e){let t=[];return e.forEach((s=>{let a=e.findIndex((e=>e.id===s.parentId));!s.parentId&&0!==s.parentId&&!1!==s.parentId||-1===a?t.push(s):(e[a].children||(e[a].children=[]),e[a].children.push(s))})),t},handleUser:e=>e.map((e=>(e.userName&&(e.userId=e.weUserId,e.name=e.userName),e))),handleDepart:e=>e.map((e=>(e.deptId&&(e.name=e.deptName,e.id=e.deptId,e.isParty=!0),e))),handleNodeClick(e){e.userId&&(this.talkName=e.name,this.fromId=e.userId,this.tabClick(),this.queryChat={fromId:e.userId})}}},[["render",function(e,t,s,a,i,o){const r=d("el-button"),l=d("el-input"),I=d("el-tree"),z=d("el-col"),U=d("userList"),K=d("el-tab-pane"),V=d("grouplist"),D=d("el-tabs"),E=d("el-empty"),P=d("chatListClass"),R=d("el-row");return n(),p("div",L,[m(R,{type:"flex",align:"center",gutter:10},{default:h((()=>[m(z,{span:6},{default:h((()=>[c("div",b,[m(l,{class:"mb10",placeholder:"搜索员工名称",clearable:"",modelValue:i.keywords,"onUpdate:modelValue":t[0]||(t[0]=e=>i.keywords=e),modelModifiers:{trim:!0},onKeyup:u(o.getDeptUser,["enter"])},{append:h((()=>[m(r,{icon:"el-icon-search",onClick:o.getDeptUser},null,8,["onClick"])])),_:1},8,["modelValue","onKeyup"]),f(c("div",x,[(n(!0),p(j,null,y(i.searchResult,((t,s)=>(n(),p("div",{key:s,class:g(["customer-li",{active:s==e.personIndex}]),onClick:e=>o.handleNodeClick(t)},k(t.name),11,_)))),128))],512),[[v,i.keywords]]),f(m(I,{ref:"tree",class:"filter-tree",props:i.defaultProps,"filter-node-method":o.filterNode,"highlight-current":"","node-key":"id",onNodeClick:o.handleNodeClick,"default-expanded-keys":i.defaultExpandedKeys,load:o.loadNode,lazy:""},null,8,["props","filter-node-method","onNodeClick","default-expanded-keys","load"]),[[v,!i.keywords]])])])),_:1}),m(z,{span:6},{default:h((()=>[c("div",w,[i.talkName?(n(),p(j,{key:0},[c("div",q,k(i.talkName),1),m(D,{modelValue:i.activeName,"onUpdate:modelValue":t[1]||(t[1]=e=>i.activeName=e),onTabChange:t[2]||(t[2]=e=>o.tabClick(!0))},{default:h((()=>[m(K,{label:"内部联系人",name:"0"},{default:h((()=>[0==i.activeName?(n(),C(U,{key:0,personList:i.personList,loading:i.loading,onChatFn:o.chatFn},null,8,["personList","loading","onChatFn"])):N("",!0)])),_:1}),m(K,{label:"外部联系人",name:"1"},{default:h((()=>[1==i.activeName?(n(),C(U,{key:0,personList:i.personList,loading:i.loading,onChatFn:o.chatFn},null,8,["personList","loading","onChatFn"])):N("",!0)])),_:1}),m(K,{label:"群聊",name:"2"},{default:h((()=>[2==i.activeName?(n(),C(V,{key:0,personList:i.personList,loading:i.loading,onGroupFn:o.groupFn},null,8,["personList","loading","onGroupFn"])):N("",!0)])),_:1})])),_:1},8,["modelValue"])],64)):(n(),C(E,{key:1,"image-size":100,description:"请选择员工"}))])])),_:1}),m(z,{span:12},{default:h((()=>[c("div",F,[f(m(P,{queryChat:i.queryChat},null,8,["queryChat"]),[[v,i.queryChat.receiveName]]),i.queryChat.receiveName?N("",!0):(n(),C(E,{key:0,description:"请选择联系人","image-size":100}))])])),_:1})])),_:1})])}],["__scopeId","data-v-9475ced0"]]);export{z as default};
