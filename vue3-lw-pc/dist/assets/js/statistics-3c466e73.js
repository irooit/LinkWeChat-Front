import{j as e,k as a,l as t,m as r,n as l}from"./api-a484694c.js";import{u as o}from"./vue-router-f8d53be7.js";import{_ as i}from"./quill-image-resize-module-c051113e.js";import{r as s,ai as d,o as m,c as u,_ as p,u as n,U as c,R as j,a as f,Z as g,P as b,Q as T,Y as v,i as y}from"./@vue-e400fd81.js";import"../index-044285d2.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";const q={class:"cp flex aic"},_={class:"ml10"},h={class:"blod"},N=["onClick"],R={key:1},U=i({__name:"statistics",setup(i){let U=s(!1),w=o().query.id,x=s([]),k=s(!1);function A(e,a,t){t.length=0,a.length=0;let r=[[],[]];e.forEach((e=>{t.push(e.date),r[0].push(e.tdViewNumber),r[1].push(e.tdJoinGroupNmber)})),a.push(...r)}function V(e){return e.id=w,e.dateRangeAddTime?(e.startAddTime=e.dateRangeAddTime[0],e.endAddTime=e.dateRangeAddTime[1]):(delete e.startAddTime,delete e.endAddTime),delete e.dateRangeAddTime,e.dateRangeJoinTime?(e.startJoinTime=e.dateRangeJoinTime[0],e.endJoinTime=e.dateRangeJoinTime[1]):(delete e.startJoinTime,delete e.endJoinTime),delete e.dateRangeJoinTime,l(e)}return U.value=!0,e(w).then((({data:e})=>{x.value=[{title:"访问客户总数",tips:"访问关键词链接的客户总数(去重)",value:e.totalViewNumber},{title:"进群客户总数",tips:"访问客户中成功进群的总数(去重)",value:e.totalJoinGroupNmber},{title:"今日访问客户数",tips:"今日访问关键词链接的客户数(去重)",value:e.tdViewNumber},{title:"今日进群客户数",tips:"今日访问客户中成功进群数(去重)",value:e.tdJoinGroupNmber}]})).finally((()=>{U.value=!1})),(e,l)=>{const o=d("CardGroupIndex"),i=d("RequestChartTable"),s=d("el-input"),U=d("el-form-item"),w=d("el-date-picker"),C=d("el-image"),J=d("el-icon-Avatar"),G=d("el-table-column"),I=d("el-button"),E=d("el-table"),D=d("el-dialog");return m(),u("div",null,[p(o,{data:n(x)},null,8,["data"]),p(i,{type:"lineChart",title:"数据趋势",isTimeQuery:"",isCreateRequest:!1,params:{keywordGroupId:e.$route.query.id},request:a,legend:["今日访问客户数","今日进群客户数"],dealDataFun:A},null,8,["params","request"]),p(i,{title:"数据明细",ref:"importRecord",request:V,params:{keywordGroupId:e.$route.query.id},requestExport:t,exportFileName:"关键词群数据明细导出.xls"},{queryMiddle:c((({query:a})=>[p(U,{label:"",prop:"customerName"},{default:c((()=>[p(s,{modelValue:a.customerName,"onUpdate:modelValue":e=>a.customerName=e,placeholder:"请输入客户名称"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),p(U,{label:""},{default:c((()=>[p(w,j({modelValue:a.dateRangeAddTime,"onUpdate:modelValue":e=>a.dateRangeAddTime=e,"value-format":"YYYY-MM-DD",type:"daterange"},e.pickerOptions,{"range-separator":"-","start-placeholder":"添加开始","end-placeholder":"结束日期",align:"right"}),null,16,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),default:c((({data:a})=>[p(E,{data:a},{default:c((()=>[p(G,{align:"center",prop:"customerName",label:"客户"},{default:c((({row:e})=>[f("div",q,[p(C,{class:"avatar",src:e.avatar,fit:"fill"},null,8,["src"]),f("div",_,[f("p",h,g(e.customerName),1),p(J,{class:b(["el-icon-Avatar",{1:"man",2:"woman"}[e.gender]])},null,8,["class"]),f("span",{style:T({color:1===e.customerType?"#4bde03":"#f9a90b"})},g({1:"@微信",2:"@企业微信"}[e.customerType]),5)])])])),_:1}),p(G,{align:"center",prop:"addUserName",label:"添加员工"},{default:c((({row:e})=>[v(g(e.addUserName||"—"),1)])),_:1}),p(G,{align:"center",prop:"addTime",label:"添加时间"},{default:c((({row:e})=>[v(g(e.addTime||"—"),1)])),_:1}),p(G,{align:"center",prop:"groupName",label:"进入客群"},{default:c((({row:a})=>[a.joinGroupNumber&&a.joinGroupNumber+"">="0"?(m(),u("div",{key:0,class:"g-color cp",onClick:t=>{var r;e.externalUserid=a.externalUserid,y(k)?k.value=!0:k=!0,null==(r=e.$refs.RequestChartTableDialog)||r.getList()}},g(a.joinGroupNumber),9,N)):(m(),u("div",R,"—"))])),_:1}),p(G,{label:"操作",align:"center"},{default:c((({row:a})=>[p(I,{text:"",onClick:t=>e.$router.push({name:e.lwConfig.CUSTOMER_DETAIL_ROUTE_NAME,query:{externalUserid:a.externalUserid,userId:a.addUserId}})},{default:c((()=>[v(" 客户详情 ")])),_:2},1032,["onClick"])])),_:1})])),_:2},1032,["data"])])),_:1},8,["params","requestExport"]),p(D,{title:"进入客群",modelValue:n(k),"onUpdate:modelValue":l[0]||(l[0]=e=>y(k)?k.value=e:k=e),"close-on-click-modal":!1},{default:c((()=>[p(i,{ref:"RequestChartTableDialog",style:{padding:"0 0 20px 0"},params:{keywordGroupId:e.$route.query.id,externalUserid:e.externalUserid},request:r},{default:c((({data:e})=>[p(E,{data:e},{default:c((()=>[p(G,{label:"客群名称",align:"center",prop:"groupName"}),p(G,{align:"center",prop:"joinTime",label:"进群时间"},{default:c((({row:e})=>[v(g(e.joinTime||"—"),1)])),_:1})])),_:2},1032,["data"])])),_:1},8,["params","request"])])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-9d7bb52d"]]);export{U as default};
