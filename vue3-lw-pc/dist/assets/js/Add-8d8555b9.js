import{_ as e}from"../index-044285d2.js";import{t as l}from"./mixin-7ecaaf69.js";import{c as r}from"./store-1f3cfa19.js";import{_ as o}from"./quill-image-resize-module-c051113e.js";import{aU as a,ai as t,aq as i,o as s,c as m,_ as d,U as p,a as f,Z as n,T as u,X as c,K as h,Y as b,V as g,P as y,W as j,aE as q,bl as C,bj as _}from"./@vue-e400fd81.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";const k={components:{},props:{form:{type:Object,defaut:()=>({})}},data(){return{rules:{shortLinkName:[{required:!0,message:"必填项",trigger:"blur"}],name:[{required:!0,message:"必填项",trigger:"blur"}],describe:[{required:!0,message:"必填项",trigger:"blur"}],longLink:[{required:!0,message:"必填项",trigger:"blur"},{validator:(e,l,r)=>{0==this.form.type&&l&&!/^http/gi.test(l)?r("链接格式错误，需以http(s)开头"):r()},trigger:"blur"}],avatar:[{required:!0,message:"必填项",trigger:"change"}],qrCode:[{required:!0,message:"必填项",trigger:"change"}],qrCodeId:[{required:!0,message:"必填项",trigger:"change"}],appId:[{required:!0,message:"必填项",trigger:"blur"}],secret:[{required:!0,message:"必填项",trigger:"blur"}]},touchTypeDict:l,prefixFormLabel:Object.freeze({1:"公众号",2:"微信",3:"微信群",10:"小程序"}),selectQrCode:a((()=>e((()=>import("./SelectQrCode-804bbb54.js")),["assets/js/SelectQrCode-804bbb54.js","assets/js/group-16414119.js","assets/index-044285d2.js","assets/js/js-cookie-8253c38e.js","assets/js/@vue-e400fd81.js","assets/js/vue-router-f8d53be7.js","assets/js/element-plus-68ba2566.js","assets/js/lodash-es-d4f5f48c.js","assets/js/@element-plus-214e0f7b.js","assets/js/@popperjs-b78c3215.js","assets/js/@ctrl-91de2ec7.js","assets/js/dayjs-c17bc6b2.js","assets/js/@babel-efd68da6.js","assets/js/to-fast-properties-1160b370.js","assets/js/async-validator-cf877c1f.js","assets/js/memoize-one-63ab667a.js","assets/js/normalize-wheel-es-3222b0a2.js","assets/js/@floating-ui-36fbce82.js","assets/css/element-plus-3888a320.css","assets/js/quill-image-resize-module-c051113e.js","assets/js/quill-c6b3d2fb.js","assets/js/quill-delta-a1872f89.js","assets/js/fast-diff-d5a53119.js","assets/js/lodash.clonedeep-1b6eefdc.js","assets/js/lodash.isequal-e7d08617.js","assets/js/@vueup-7cf8cfdd.js","assets/css/@vueup-da05906a.css","assets/css/quill-image-resize-module-44eb40f8.css","assets/js/pinia-1b56b17e.js","assets/js/vue-demi-71ba0ef2.js","assets/js/jsencrypt-43f479c1.js","assets/js/crypto-js-d6a67473.js","assets/js/ali-oss-912914b8.js","assets/js/axios-fb5f9e0e.js","assets/js/@vueuse-4025ce01.js","assets/js/path-browserify-289407ee.js","assets/js/nprogress-a39edb90.js","assets/css/nprogress-771398e6.css","assets/js/clipboard-7a0da8dc.js","assets/css/index-b5531375.css","assets/css/normalize-9d9ae4af.css","assets/css/SelectQrCode-2d007cc5.css"]))),selectStaffQrCode:a((()=>e((()=>import("./SelectStaffQrCode-3b29ac06.js")),["assets/js/SelectStaffQrCode-3b29ac06.js","assets/js/staff-48996164.js","assets/index-044285d2.js","assets/js/js-cookie-8253c38e.js","assets/js/@vue-e400fd81.js","assets/js/vue-router-f8d53be7.js","assets/js/element-plus-68ba2566.js","assets/js/lodash-es-d4f5f48c.js","assets/js/@element-plus-214e0f7b.js","assets/js/@popperjs-b78c3215.js","assets/js/@ctrl-91de2ec7.js","assets/js/dayjs-c17bc6b2.js","assets/js/@babel-efd68da6.js","assets/js/to-fast-properties-1160b370.js","assets/js/async-validator-cf877c1f.js","assets/js/memoize-one-63ab667a.js","assets/js/normalize-wheel-es-3222b0a2.js","assets/js/@floating-ui-36fbce82.js","assets/css/element-plus-3888a320.css","assets/js/quill-image-resize-module-c051113e.js","assets/js/quill-c6b3d2fb.js","assets/js/quill-delta-a1872f89.js","assets/js/fast-diff-d5a53119.js","assets/js/lodash.clonedeep-1b6eefdc.js","assets/js/lodash.isequal-e7d08617.js","assets/js/@vueup-7cf8cfdd.js","assets/css/@vueup-da05906a.css","assets/css/quill-image-resize-module-44eb40f8.css","assets/js/pinia-1b56b17e.js","assets/js/vue-demi-71ba0ef2.js","assets/js/jsencrypt-43f479c1.js","assets/js/crypto-js-d6a67473.js","assets/js/ali-oss-912914b8.js","assets/js/axios-fb5f9e0e.js","assets/js/@vueuse-4025ce01.js","assets/js/path-browserify-289407ee.js","assets/js/nprogress-a39edb90.js","assets/css/nprogress-771398e6.css","assets/js/clipboard-7a0da8dc.js","assets/css/index-b5531375.css","assets/css/normalize-9d9ae4af.css","assets/css/SelectStaffQrCode-1d816660.css"]))),component:"",qrCodeVisible:!1,storeLoading:!1,isLoadForm:!1}},computed:{isDetail(){return this.$route.path.endsWith("/detail")}},watch:{"form.id"(e){this.isLoadForm=!0},"form.type"(e,l){if(!this.form.id||this.isLoadForm){let{id:e,jumpType:l,extensionType:r,type:o}=this.form;this.$emit("update:form",{id:e,jumpType:l,extensionType:r,type:o})}this.isLoadForm=!0,[6,8].includes(+e)&&this.getCode()}},created(){},mounted(){},methods:{getCode(){this.storeLoading=!0,r({6:1,8:2}[this.form.type]).then((({data:e})=>{this.form.qrCode=e&&e.storeCodeConfigQr,this.storeLoading=!1})).finally((()=>{this.storeLoading=!1}))},choiceQqcode(e){this.qrCodeVisible=!0,this.component=this[4==e?"selectStaffQrCode":"selectQrCode"]},submitSelectQrCode(e){if(this.form.qrCodeId=e.id,4==this.form.type){let l=[];e.qrUserInfos&&e.qrUserInfos.forEach((e=>{e.weQrUserList&&e.weQrUserList.forEach((e=>{l.push(e.userName)}))})),this.form.describe=l+"",this.form.name=e.name,this.form.qrCode=e.qrCode}else this.form.describe=e.tags,this.form.name=e.activityName,this.form.qrCode=e.codeUrl}}},L={key:0,class:"tips"},U={key:1},V={key:0,class:"tips"},v=(e=>(C("data-v-e84fc1a9"),e=e(),_(),e))((()=>f("a",{href:"https://www.yuque.com/linkwechat/help/gy4ghv#a1bXG",target:"_blank"},"如何添加小程序页面路径?",-1)));const w=o(k,[["render",function(e,l,r,o,a,C){const _=t("el-form-item"),k=t("el-input"),w=t("upload"),x=t("el-button"),D=t("tag-ellipsis"),I=t("el-image"),Q=t("el-form"),T=i("loading");return s(),m("div",null,[d(Q,{class:y(C.isDetail&&"form-detail"),disabled:C.isDetail,ref:"form",model:r.form,"label-suffix":"：","label-width":"160px",rules:a.rules},{default:p((()=>[d(_,{label:"短链类型"},{default:p((()=>[f("span",null,n(a.touchTypeDict[r.form.type].allName),1)])),_:1}),d(_,{label:"短链名称",prop:"shortLinkName"},{default:p((()=>[d(k,{clearable:"",modelValue:r.form.shortLinkName,"onUpdate:modelValue":l[0]||(l[0]=e=>r.form.shortLinkName=e),placeholder:"请输入",maxlength:"30","show-word-limit":""},null,8,["modelValue"])])),_:1}),0==r.form.type?(s(),u(_,{key:0,prop:"longLink",label:"公众号文章链接"},{default:p((()=>[d(k,{clearable:"",modelValue:r.form.longLink,"onUpdate:modelValue":l[1]||(l[1]=e=>r.form.longLink=e),placeholder:"请输入"},null,8,["modelValue"]),C.isDetail?c("",!0):(s(),m("div",L,"请在公众号后台文章发布列表页中获取并复制文章的永久链接"))])),_:1})):Object.keys(a.prefixFormLabel).includes(r.form.type+"")?(s(),m(h,{key:1},[d(_,{prop:"name",label:a.prefixFormLabel[r.form.type]+"名称"},{default:p((()=>[d(k,{clearable:"",modelValue:r.form.name,"onUpdate:modelValue":l[2]||(l[2]=e=>r.form.name=e),placeholder:"请输入",maxlength:"15","show-word-limit":""},null,8,["modelValue"])])),_:1},8,["label"]),d(_,{prop:"describe",label:a.prefixFormLabel[r.form.type]+"描述"},{default:p((()=>[d(k,{clearable:"",modelValue:r.form.describe,"onUpdate:modelValue":l[3]||(l[3]=e=>r.form.describe=e),placeholder:"请输入",maxlength:"30","show-word-limit":""},null,8,["modelValue"])])),_:1},8,["label"]),d(_,{prop:"avatar",label:a.prefixFormLabel[r.form.type]+"头像"},{default:p((()=>[d(w,{class:"image-uploader",fileUrl:r.form.avatar,"onUpdate:fileUrl":l[4]||(l[4]=e=>r.form.avatar=e)},null,8,["fileUrl"])])),_:1},8,["label"]),d(_,{prop:"qrCode",label:a.prefixFormLabel[r.form.type]+"二维码"},{default:p((()=>[d(w,{class:"image-uploader",fileUrl:r.form.qrCode,"onUpdate:fileUrl":l[5]||(l[5]=e=>r.form.qrCode=e)},null,8,["fileUrl"])])),_:1},8,["label"])],64)):[4,5].includes(+r.form.type)?(s(),u(_,{key:2,prop:"qrCode",label:a.touchTypeDict[r.form.type].name},{default:p((()=>[r.form.qrCode||C.isDetail?(s(),u(Q,{key:1,"label-width":""},{default:p((()=>[d(_,{label:"活码名称"},{default:p((()=>[b(n(r.form.name),1)])),_:1}),d(_,{label:4==r.form.type?"使用员工":"活码客群"},{default:p((()=>[r.form.describe?(s(),u(D,{key:0,limit:"2",list:r.form.describe.split(",")},null,8,["list"])):c("",!0)])),_:1},8,["label"]),d(_,{label:"二维码"},{default:p((()=>[d(I,{class:"mr10 qrCode",src:r.form.qrCode,fit:"fill"},null,8,["src"]),C.isDetail?c("",!0):(s(),u(x,{key:0,text:"",onClick:l[7]||(l[7]=e=>C.choiceQqcode(r.form.type))},{default:p((()=>[b("修改")])),_:1}))])),_:1})])),_:1})):(s(),u(x,{key:0,type:"primary",plain:"",onClick:l[6]||(l[6]=e=>C.choiceQqcode(r.form.type))},{default:p((()=>[b(n("选择"+a.touchTypeDict[r.form.type].name),1)])),_:1}))])),_:1},8,["label"])):[6,8].includes(+r.form.type)?(s(),u(_,{key:3,prop:"qrCode",label:"选择"+a.touchTypeDict[r.form.type].name},{default:p((()=>[r.form.qrCode||C.isDetail?(s(),m("div",U,[g(d(I,{class:"mr10 qrCode",src:r.form.qrCode,fit:"fill"},null,8,["src"]),[[T,a.storeLoading]]),C.isDetail?c("",!0):(s(),u(x,{key:0,text:"",onClick:l[9]||(l[9]=e=>C.getCode())},{default:p((()=>[b("同步")])),_:1}))])):g((s(),u(x,{key:0,type:"primary",plain:"",onClick:l[8]||(l[8]=l=>e.$router.push("/drainageCode/qrCode/store/list"))},{default:p((()=>[b(" 暂无"+n(a.touchTypeDict[r.form.type].name)+"，去配置 ",1)])),_:1})),[[T,a.storeLoading]])])),_:1},8,["label"])):[7,9].includes(+r.form.type)?(s(),m(h,{key:4},[d(_,{prop:"name",label:"小程序名称"},{default:p((()=>[d(k,{clearable:"",modelValue:r.form.name,"onUpdate:modelValue":l[10]||(l[10]=e=>r.form.name=e),placeholder:"请输入",maxlength:"15","show-word-limit":""},null,8,["modelValue"])])),_:1}),d(_,{prop:"avatar",label:"小程序头像"},{default:p((()=>[d(w,{class:"image-uploader",fileUrl:r.form.avatar,"onUpdate:fileUrl":l[11]||(l[11]=e=>r.form.avatar=e)},null,8,["fileUrl"])])),_:1}),d(_,{prop:"appId",label:"小程序AppID"},{default:p((()=>[d(k,{clearable:"",modelValue:r.form.appId,"onUpdate:modelValue":l[12]||(l[12]=e=>r.form.appId=e),placeholder:"请输入","show-word-limit":""},null,8,["modelValue"])])),_:1}),d(_,{prop:"longLink",label:"小程序页面路径"},{default:p((()=>[d(k,{clearable:"",modelValue:r.form.longLink,"onUpdate:modelValue":l[13]||(l[13]=e=>r.form.longLink=e),placeholder:"请输入小程序页面路径（不含.html）","show-word-limit":""},null,8,["modelValue"]),C.isDetail?c("",!0):(s(),m("div",V,[b(" 示例：page/index/index、page/index/index?id=123； "),v]))])),_:1})],64)):c("",!0)])),_:1},8,["class","disabled","model","rules"]),(s(),u(q,null,[(s(),u(j(a.component),{visible:a.qrCodeVisible,"onUpdate:visible":l[14]||(l[14]=e=>a.qrCodeVisible=e),onSuccess:C.submitSelectQrCode,selected:[r.form.qrCodeId].filter((e=>!!e))},null,40,["visible","onSuccess","selected"]))],1024))])}],["__scopeId","data-v-e84fc1a9"]]);export{w as default};
