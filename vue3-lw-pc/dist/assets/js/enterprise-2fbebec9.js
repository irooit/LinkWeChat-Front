import{h as e}from"./moment-8163541f.js";import{i as t,j as i,k as l}from"./circle-2faa2a32.js";import{_ as a}from"./quill-image-resize-module-c051113e.js";import{ai as s,aq as o,o as r,c as n,_ as d,U as p,Y as m,a as u,Z as c,V as h,T as y,X as g,K as f,a9 as b,bl as v,bj as j}from"./@vue-e400fd81.js";import"../index-044285d2.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";const w={name:"enterprise",components:{},data:()=>({disable:!1,value1:[],dialogVisible:!1,userArray:[],query:{pageSize:10,pageNum:1,beginTime:"",endTime:"",creator:"",type:0},loading:!1,tableData:[],total:0,lastSyncTime:"",detailDialogVisible:!1,detail:{}}),methods:{gotoRoute(){this.$router.push({path:"/customerMaintain/friendCircle/publish"})},setTimeChange(t){t?(this.query.beginTime=e(t[0]).format("YYYY-MM-DD"),this.query.endTime=e(t[1]).format("YYYY-MM-DD")):(this.query.beginTime="",this.query.endTime="")},detailFn(e){this.detailDialogVisible=!0,t(e).then((e=>{200===e.code&&(this.detail=e.data)}))},syncFn(){i({filterType:0}).then((e=>{200===e.code&&(this.msgSuccess(e.msg),this.getList())}))},getSelectUser(e){this.userArray=e,this.query.creator=this.userArray.map((function(e,t){return e.name})).join(",")},resetQuery(){this.query={pageSize:10,pageNum:1,beginTime:"",endTime:"",creator:"",type:0},this.userArray=[],this.value1=[],this.getList()},getList(e){e&&(this.query.pageNum=e),this.loading=!0,l(this.query).then((e=>{this.tableData=e.rows,this.lastSyncTime=e.lastSyncTime,this.setTimeDiff(),this.total=Number(e.total),this.loading=!1})).catch((()=>{this.loading=!1}))},setTimeDiff(){if(this.lastSyncTime){let t=e(this.lastSyncTime),i=e().diff(t,"minute");const l=Math.floor(i/60);this.disable=!(l>=2)}}},mounted(){},created(){this.value1[1]=e(new Date).format("YYYY-MM-DD"),this.value1[0]=e(new Date).subtract(1,"months").format("YYYY-MM-DD"),this.query.beginTime=e(this.value1[0]).format("YYYY-MM-DD"),this.query.endTime=e(this.value1[1]).format("YYYY-MM-DD"),this.getList()}},T={class:"g-card"},k={class:"mid-action"},x={key:0,class:"desc"},_={key:1,class:"desc"},Y=["src"],D={key:2},U={key:0},q={key:0},S={key:1},C=(e=>(v("data-v-29615b1a"),e=e(),j(),e))((()=>u("span",{style:{"margin-left":"40px","font-size":"16px"}},"内容：",-1))),M={style:{display:"inline-block","margin-right":"10px"}},V=["src"],N={style:{display:"inline-block","margin-right":"10px"}},A={style:{width:"100px",height:"100px"}},z={class:"img_list"},L={class:"dialog-footer"};const F=a(w,[["render",function(e,t,i,l,a,v){const j=s("el-date-picker"),w=s("el-form-item"),F=s("el-button"),B=s("el-form"),E=s("ButtonSync"),I=s("el-image"),K=s("el-table-column"),Q=s("TagEllipsis"),R=s("el-table"),$=s("pagination"),G=s("SelectUser"),J=s("el-tag"),O=s("el-dialog"),P=o("loading");return r(),n("div",null,[d(B,{model:a.query,"label-position":"left",ref:"queryForm",inline:!0,"label-width":"70px",class:"top-search"},{default:p((()=>[d(w,{label:"时间范围"},{default:p((()=>[d(j,{clearable:"",modelValue:a.value1,"onUpdate:modelValue":t[0]||(t[0]=e=>a.value1=e),format:"YYYY-MM-DD",onChange:v.setTimeChange,type:"daterange","range-separator":"—","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue","onChange"])])),_:1}),d(w,null,{default:p((()=>[d(F,{type:"primary",onClick:t[1]||(t[1]=e=>v.getList(1))},{default:p((()=>[m("查询")])),_:1}),d(F,{onClick:v.resetQuery},{default:p((()=>[m("重置")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"]),u("div",T,[u("div",k,[d(F,{type:"primary",onClick:v.gotoRoute,style:{"margin-right":"10px"}},{default:p((()=>[m("发表动态")])),_:1},8,["onClick"]),u("div",null,[a.lastSyncTime?(r(),n("span",x,"最近同步："+c(a.lastSyncTime),1)):(r(),n("span",_,"暂无记录，请手动点击同步")),d(E,{lastSyncTime:a.lastSyncTime,onClick:v.syncFn},{default:p((()=>[m("同步朋友圈")])),_:1},8,["lastSyncTime","onClick"])])]),h((r(),y(R,{ref:"table",data:a.tableData},{default:p((()=>[d(K,{"show-overflow-tooltip":"",prop:"content",label:"朋友圈内容"},{default:p((({row:e})=>["image"===e.contentType?(r(),y(I,{key:0,src:e.content,fit:"fill","preview-src-list":[e.content],style:{width:"100px",height:"100px"}},null,8,["src","preview-src-list"])):"video"===e.contentType?(r(),n("video",{key:1,style:{width:"100px",height:"100px"},src:e.content},null,8,Y)):(r(),n("div",D,c(e.content),1))])),_:1}),d(K,{"show-overflow-tooltip":"",prop:"contentType",label:"类型"},{default:p((({row:t})=>{var i;return[u("div",null,c(null==(i=e.$dictMaterialType[t.realType])?void 0:i.name),1)]})),_:1}),d(K,{"show-overflow-tooltip":"",prop:"addUserName","min-width":"140px",label:"已发送员工"},{default:p((({row:e})=>[e.addUserName?(r(),n("div",U,[d(Q,{list:e.addUserName.split(",")},null,8,["list"])])):g("",!0)])),_:1}),d(K,{"show-overflow-tooltip":"",prop:"noAddUserName","min-width":"140px",label:"未发送员工"},{default:p((({row:e})=>[e.noAddUserName?(r(),n("div",q,[d(Q,{list:e.noAddUserName.split(",")},null,8,["list"])])):(r(),n("div",S,"全部"))])),_:1}),d(K,{label:"任务状态",prop:"status"},{default:p((({row:e})=>[u("span",null,c(1==e.status?"开始创建任务":2==e.status?"正在创建任务":3==e.status?"创建任务完成":""),1)])),_:1}),d(K,{"show-overflow-tooltip":"",prop:"createTime",width:"170px",label:"创建时间"}),d(K,{label:"操作",align:"center",width:"100"},{default:p((({row:e})=>[d(F,{text:"",onClick:t=>v.detailFn(e.id)},{default:p((()=>[m("详情")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[P,a.loading]]),d($,{total:a.total,page:a.query.pageNum,"onUpdate:page":t[2]||(t[2]=e=>a.query.pageNum=e),limit:a.query.pageSize,"onUpdate:limit":t[3]||(t[3]=e=>a.query.pageSize=e),onPagination:t[4]||(t[4]=e=>v.getList())},null,8,["total","page","limit"])]),d(G,{visible:a.dialogVisible,"onUpdate:visible":t[5]||(t[5]=e=>a.dialogVisible=e),title:"组织架构",defaultValues:a.userArray,onSuccess:v.getSelectUser},null,8,["visible","defaultValues","onSuccess"]),d(O,{title:"详情",modelValue:a.detailDialogVisible,"onUpdate:modelValue":t[8]||(t[8]=e=>a.detailDialogVisible=e),width:"40%"},{default:p((()=>[d(B,{"label-position":"right","label-width":"100px"},{footer:p((()=>[u("span",L,[d(F,{onClick:t[6]||(t[6]=e=>a.detailDialogVisible=!1)},{default:p((()=>[m("取 消")])),_:1}),d(F,{type:"primary",onClick:t[7]||(t[7]=e=>a.detailDialogVisible=!1)},{default:p((()=>[m("确 定")])),_:1})])])),default:p((()=>[C,(r(!0),n(f,null,b(a.detail.otherContent,((e,t)=>(r(),n(f,{key:t},["text"===e.annexType?(r(),y(w,{key:0,label:" "},{default:p((()=>[m(c(e.other),1)])),_:2},1024)):g("",!0),"video"===e.annexType?(r(),y(w,{key:1,label:" "},{default:p((()=>[u("div",M,[u("video",{style:{width:"200px",height:"200px"},src:e.annexUrl,controls:""},null,8,V)])])),_:2},1024)):g("",!0),"link"===e.annexType?(r(),y(w,{key:2,label:" "},{default:p((()=>[u("div",N,[u("span",A,c(e.annexUrl),1)])])),_:2},1024)):g("",!0)],64)))),128)),d(w,{label:" "},{default:p((()=>[u("div",z,[(r(!0),n(f,null,b(a.detail.otherContent,((e,t)=>(r(),n("div",null,["image"===e.annexType?(r(),y(I,{key:0,class:"item",style:{width:"100px",height:"100px"},"preview-src-list":[e.annexUrl],src:e.annexUrl},null,8,["preview-src-list","src"])):g("",!0)])))),256))])])),_:1}),a.detail.addUserName?(r(),y(w,{key:0,label:"已发送员工"},{default:p((()=>[(r(!0),n(f,null,b(a.detail.addUserName.split(","),((e,t)=>(r(),y(J,{key:t},{default:p((()=>[m(c(e),1)])),_:2},1024)))),128))])),_:1})):g("",!0),a.detail.noAddUserName?(r(),y(w,{key:1,label:"未发送员工"},{default:p((()=>[(r(!0),n(f,null,b(a.detail.noAddUserName.split(","),((e,t)=>(r(),y(J,{key:t},{default:p((()=>[m(c(e),1)])),_:2},1024)))),128))])),_:1})):g("",!0)])),_:1})])),_:1},8,["modelValue"])])}],["__scopeId","data-v-29615b1a"]]);export{F as default};
