import{c as e,d as l,e as i,f as s}from"./staff-48996164.js";import{g as t}from"./welcome-6ff4c53e.js";import{S as o}from"./index-618cff16.js";import{_ as a}from"./quill-image-resize-module-c051113e.js";import{ai as r,aq as d,V as m,o as c,c as p,_ as n,U as u,K as f,a9 as g,T as h,Y as b,Z as w,a as S,X as y,bl as j,bj as C}from"./@vue-e400fd81.js";import"../index-044285d2.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";import"./tag-13936295.js";import"./index-0bf429ac.js";const v={components:{SelectMaterial:o},data:()=>({dialogVisibleSelectUser:!1,dialogVisibleSelectTag:!1,dialogVisibleSelectMaterial:!1,dialogVisibleSelectWel:!1,loading:!1,form:{codeType:1,qrCode:"",isJoinConfirmFriends:0,weEmpleCodeTags:[],weEmpleCodeUseScops:[],scenario:""},materialSelected:"",welQuery:{welcomeMsg:""},welLoading:!1,welList:[],welSelected:{},type:{1:"单人",2:"多人",3:"批量单人"}}),created(){let e=this.$route.query.id;e&&this.getDetail(e)},methods:{getDetail(l){this.loading=!0,e(l).then((({data:e})=>{this.form=e,this.materialSelected=null==e.weMaterial?"":e.weMaterial.materialUrl,this.loading=!1}))},getWelList(){this.welLoading=!0,t(this.welQuery).then((({rows:e})=>{this.welList=e,this.$refs.table.$forceUpdate(),this.welLoading=!1}))},codeTypeChange(){this.form.weEmpleCodeUseScops=[],this.form.qrCode=""},selectedUser(e){let i={userIds:[],departmentIds:[]};this.form.weEmpleCodeUseScops=e.map((e=>(e.userId&&i.userIds.push(e.userId),e.id&&i.departmentIds.push(e.id),{businessId:e.id||e.userId,businessName:e.name,businessIdType:e.userId?2:1}))),i.userIds+="",i.departmentIds+="",l(i).then((({data:e})=>{this.form.qrCode=e.qr_code}))},submitSelectTag(e){this.form.weEmpleCodeTags=e.map((e=>({tagId:e.tagId,tagName:e.name})))},submitSelectMaterial(e,l,i){this.form.mediaId=l.id,this.materialSelected=l.materialUrl,this.dialogVisibleSelectMaterial=!1},removeMaterial(){this.form.mediaId="",this.materialSelected=""},selectWelcome(){this.form.welcomeMsg=this.welSelected.welcomeMsg,this.form.mediaId=this.welSelected.mediaId,this.dialogVisibleSelectWel=!1},submit(){this.form.weEmpleCodeUseScops.length?(this.loading=!0,(this.form.id?i:s)(this.form).then((({data:e})=>{this.msgSuccess("操作成功"),this.loading=!1,this.$router.back()})).catch((()=>{this.loading=!1}))):this.msgError("请至少选择一名使用员工")}}},V=e=>(j("data-v-e0027464"),e=e(),C(),e),_={class:"flex"},k=V((()=>S("div",{class:"tip"},"根据使用场景做标签记录，扫码添加的客户，可自动打上标签",-1))),U={key:0},x=V((()=>S("div",{class:"tip"},"设置个性化欢迎语，扫描该员工活码添加的客户，将自动推送该欢迎语",-1))),T={class:"preview-wrap g-card mt0"},M=V((()=>S("div",{class:"tip mb20"},"二维码预览",-1))),I=V((()=>S("div",{style:{margin:"10px 0","border-bottom":"1px solid #ddd"}},null,-1))),q=V((()=>S("div",null,"性别：男",-1))),E=V((()=>S("div",null,"设置：备注和描述",-1))),L=V((()=>S("div",{class:"tip mb20"},"扫码标签样式",-1))),W=V((()=>S("div",{class:"tip"},"欢迎语样式",-1)));const F=a(v,[["render",function(e,l,i,s,t,o){const a=r("el-radio"),j=r("el-radio-group"),C=r("el-form-item"),v=r("el-tag"),V=r("el-button"),F=r("el-checkbox"),z=r("el-input"),J=r("el-divider"),N=r("el-image"),$=r("el-icon-CircleCloseFilled"),D=r("el-card"),Q=r("el-form"),O=r("el-icon-UserFilled"),A=r("PhoneDialog"),K=r("SelectUser"),R=r("SelectTag"),B=r("SelectMaterial"),P=r("el-table-column"),X=r("el-icon-check"),Y=r("el-table"),Z=r("el-dialog"),G=d("loading");return m((c(),p("div",_,[n(Q,{model:t.form,ref:"form","label-width":"100px",class:"g-card fxauto mr20"},{default:u((()=>[n(C,{label:"类型",prop:"codeType"},{default:u((()=>[n(j,{modelValue:t.form.codeType,"onUpdate:modelValue":l[0]||(l[0]=e=>t.form.codeType=e),onChange:o.codeTypeChange},{default:u((()=>[(c(!0),p(f,null,g(t.type,((e,l,i)=>(c(),h(a,{key:i,label:+l},{default:u((()=>[b(w(e),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1}),n(C,{label:"使用员工"},{default:u((()=>[(c(!0),p(f,null,g(t.form.weEmpleCodeUseScops,((e,l)=>(c(),h(v,{key:l},{default:u((()=>[b(w(e.businessName),1)])),_:2},1024)))),128)),n(V,{type:"primary",plain:"",class:"ml10",icon:"el-icon-plus",onClick:l[1]||(l[1]=e=>t.dialogVisibleSelectUser=!0)},{default:u((()=>[b(w(t.form.weEmpleCodeUseScops.length?"修改":"添加"),1)])),_:1})])),_:1}),n(C,{label:"添加设置",prop:"isJoinConfirmFriends"},{default:u((()=>[n(F,{"true-label":1,"false-label":0,modelValue:t.form.isJoinConfirmFriends,"onUpdate:modelValue":l[2]||(l[2]=e=>t.form.isJoinConfirmFriends=e)},{default:u((()=>[b(" 客户添加时无需经过确认自动成为好友 ")])),_:1},8,["modelValue"])])),_:1}),n(C,{label:"活动场景",prop:"scenario"},{default:u((()=>[n(z,{modelValue:t.form.scenario,"onUpdate:modelValue":l[3]||(l[3]=e=>t.form.scenario=e),maxlength:"30","show-word-limit":"",placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1}),n(C,{label:"扫码标签",prop:"weEmpleCodeTags"},{default:u((()=>[(c(!0),p(f,null,g(t.form.weEmpleCodeTags,((e,l)=>(c(),h(v,{key:l},{default:u((()=>[b(w(e.tagName),1)])),_:2},1024)))),128)),n(V,{type:"primary",class:"ml10",plain:"",icon:"el-icon-plus",onClick:l[4]||(l[4]=e=>t.dialogVisibleSelectTag=!0)},{default:u((()=>[b(" 添加标签 ")])),_:1}),k])),_:1}),n(C,{label:"欢迎语"},{default:u((()=>[n(D,{shadow:"never"},{default:u((()=>[n(z,{type:"textarea",modelValue:t.form.welcomeMsg,"onUpdate:modelValue":l[5]||(l[5]=e=>t.form.welcomeMsg=e),maxlength:"220","show-word-limit":"",autosize:{minRows:5,maxRows:20},placeholder:"请输入",clearable:""},null,8,["modelValue"]),n(J),t.materialSelected?(c(),p("div",U,[n(N,{style:{width:"100px",height:"100px",cursor:"pointer","border-radius":"6px"},src:t.materialSelected,fit:"fill"},null,8,["src"]),n($,{class:"el-icon-CircleCloseFilled",onClick:o.removeMaterial},null,8,["onClick"])])):(c(),h(V,{key:1,icon:"el-icon-plus",onClick:l[6]||(l[6]=e=>t.dialogVisibleSelectMaterial=!0)},{default:u((()=>[b("添加图片")])),_:1}))])),_:1}),n(V,{icon:"el-icon-plus",type:"primary",onClick:l[7]||(l[7]=e=>(o.getWelList(),t.dialogVisibleSelectWel=!0))},{default:u((()=>[b(" 从欢迎语模板选取 ")])),_:1}),x])),_:1}),n(C,{label:" "},{default:u((()=>[n(V,{type:"primary",onClick:o.submit},{default:u((()=>[b("保存")])),_:1},8,["onClick"]),n(V,{onClick:l[8]||(l[8]=l=>e.$router.back())},{default:u((()=>[b("取消")])),_:1})])),_:1})])),_:1},8,["model"]),S("div",T,[n(N,{style:{width:"180px",height:"180px"},src:t.form.qrCode||"@/assets/image/user-code-example.jpg",fit:"fill"},null,8,["src"]),M,n(D,{shadow:"never","body-style":{padding:"10px 10px 20px"}},{default:u((()=>[n(O,{class:"el-icon-UserFilled",style:{"font-size":"20px"}}),b(" 昵称 "),I,q,E,S("div",null,[b(" 标签： "),(c(!0),p(f,null,g(t.form.weEmpleCodeTags,((e,l)=>(c(),h(v,{key:l},{default:u((()=>[b(w(e.tagName),1)])),_:2},1024)))),128))])])),_:1}),L,n(A,{list:[{text:t.form.welcomeMsg||"请输入欢迎语"},{image:t.materialSelected}]},null,8,["list"]),W]),(c(),h(K,{key:t.form.codeType,visible:t.dialogVisibleSelectUser,"onUpdate:visible":l[9]||(l[9]=e=>t.dialogVisibleSelectUser=e),title:"选择使用员工",isOnlyLeaf:2!==t.form.codeType,isSigleSelect:1==t.form.codeType,onSuccess:o.selectedUser},null,8,["visible","isOnlyLeaf","isSigleSelect","onSuccess"])),n(R,{visible:t.dialogVisibleSelectTag,"onUpdate:visible":l[10]||(l[10]=e=>t.dialogVisibleSelectTag=e),selected:t.form.toTag,onSuccess:o.submitSelectTag},null,8,["visible","selected","onSuccess"]),n(B,{visible:t.dialogVisibleSelectMaterial,"onUpdate:visible":l[11]||(l[11]=e=>t.dialogVisibleSelectMaterial=e),type:"1",showArr:[1],onSuccess:o.submitSelectMaterial},null,8,["visible","onSuccess"]),n(Z,{key:"a",title:"选择欢迎语",modelValue:t.dialogVisibleSelectWel,"onUpdate:modelValue":l[15]||(l[15]=e=>t.dialogVisibleSelectWel=e),width:"500"},{footer:u((()=>[S("div",null,[n(V,{onClick:l[14]||(l[14]=e=>t.dialogVisibleSelectWel=!1)},{default:u((()=>[b("取 消")])),_:1}),n(V,{type:"primary",onClick:o.selectWelcome},{default:u((()=>[b("确 定")])),_:1},8,["onClick"])])])),default:u((()=>[S("div",null,[n(z,{class:"welcome-input",placeholder:"请输入关键字",modelValue:t.welQuery.welcomeMsg,"onUpdate:modelValue":l[12]||(l[12]=e=>t.welQuery.welcomeMsg=e)},{append:u((()=>[n(V,{onClick:o.getWelList},{default:u((()=>[b("查询")])),_:1},8,["onClick"])])),_:1},8,["modelValue"]),m((c(),h(Y,{ref:"table",data:t.welList,"max-height":300,"show-header":!1,"highlight-current-row":"",onCurrentChange:l[13]||(l[13]=e=>t.welSelected=e)},{default:u((()=>[n(P,{property:"welcomeMsg","show-overflow-tooltip":""}),n(P,{width:"60"},{default:u((({row:e})=>[t.welSelected.id===e.id?(c(),h(X,{key:0,class:"el-icon-check",style:{color:"rgb(65, 133, 244)","font-size":"25px"}})):y("",!0)])),_:1})])),_:1},8,["data"])),[[G,t.welLoading]])])])),_:1},8,["modelValue"])])),[[G,t.loading]])}],["__scopeId","data-v-e0027464"]]);export{F as default};
