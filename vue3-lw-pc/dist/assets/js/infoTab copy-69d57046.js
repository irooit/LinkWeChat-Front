import{I as e,R as a,S as t,T as s}from"../index-044285d2.js";import l from"./record-d8133c69.js";import r from"./record-table-6037d986.js";import{_ as i}from"./quill-image-resize-module-c051113e.js";import{ai as o,o as d,c as u,_ as p,U as n,a as c,K as m,a9 as f,P as y,Z as g,X as k,T as b,Y as h,bl as v,bj as _}from"./@vue-e400fd81.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";import"./businessConver-2b86f97c.js";import"./MaterialCard-ea409fb9.js";const j={name:"",props:{stageList:{type:Array,default:[]},userId:{type:String,default:""},trackUsers:{type:Array,default:[]}},components:{record:l,RecordTable:r},data:()=>({portrayalSum:{companyTags:[],personTags:[],trackStates:[],trackUsers:[]},trajectoryType:{0:"全部",1:"客户动态",2:"员工动态",3:"互动动态",4:"商机阶段"},recod:[],active:"0",openedTabs:["0"],openTrack:["0"],lastSyncTime:null,dictTrackState:e,fieldList:[],stage:[]}),computed:{},watch:{stageList:{deep:!0,immediate:!0,handler(e){e&&(this.stage=e)}}},created(){this.userId?this.getCustomerInfoByUserId():this.getSummary()},mounted(){},methods:{setList(e){let a=0;return this.stage.forEach(((t,s)=>{t.stageVal==e&&(a=s)})),a+1},setActive(e){return this.stage.map((e=>2==e.stageState)).length+2},getSummary(){a(this.$route.query).then((({data:e})=>{this.portrayalSum=e}))},getCustomerInfoByUserId(){t({externalUserid:this.$route.query.externalUserid,weUserId:this.userId}).then((({data:e})=>{this.portrayalSum=e,s({externalUserId:this.$route.query.externalUserid,weUserId:this.userId}).then((e=>{this.setData(e.data)}))}))},setData(e){let a=e;a.forEach(((e,t)=>{if(0==e.isDefault){let s=this.getEditValue(e),l={...e,...s};a[t]=l}})),this.fieldList=a},getEditValue(e){let a={value:3!==e.type||1==e.typeSub?"":[]};return this.portrayalSum.weCustomerInfoExpands&&this.portrayalSum.weCustomerInfoExpands.forEach(((t,s)=>{t.fieldTemplateId===e.id&&t.fieldCustomerInfoVal&&t.fieldCustomerInfoVal.length&&(3!==e.type?a.value=t.fieldCustomerInfoVal[0].infoVal:(a.value=t.fieldCustomerInfoVal.map((e=>e.infoVal)),1==e.typeSub&&(a.value=a.value[0])))})),a},changeTab(e){this.openedTabs.includes(e.index)||this.openedTabs.push(e.index)},changeTrack(e){this.openTrack.includes(e)||this.openTrack.push(e),this.active=e},sync(){this.$refs.record[this.active].sync()},jsGetAge(e){if(!e)return"无";let a,t=e.split("-"),s=t[0],l=t[1],r=t[2],i=new Date,o=i.getFullYear(),d=i.getMonth()+1,u=i.getDate();if(o==s)a=0;else{let e=o-s;if(e>0)if(d==l){a=u-r<0?e-1:e}else{a=d-l<0?e-1:e}else a=-1}return a}}},S=e=>(v("data-v-b636d993"),e=e(),_(),e),w={class:"left"},I=S((()=>c("div",{class:"card-title"},"企业标签",-1))),T={key:0,class:"name oe g-bg-lg"},N={key:1,class:"gap10"},x={key:2,class:"g-tip-color ac"},U={key:1,class:"g-tip-color ac"},V=S((()=>c("div",{class:"card-title"},"个人标签",-1))),C={key:0,class:"name oe g-bg-lg"},L={key:1,class:"gap10"},q={key:2,class:"g-tip-color ac"},D={key:1,class:"g-tip-color ac"},E=S((()=>c("div",{class:"card-title"},"共同群聊",-1))),A={key:1,class:"g-tip-color ac"},K=S((()=>c("div",{class:"card-title"},"详细资料",-1))),$={style:{"max-height":"450px",overflow:"hidden auto"}},z=S((()=>c("div",{class:"card-title"},"商机阶段",-1))),G={key:0,class:"name oe g-bg-lg"},M={key:4,class:"g-tip-color ac"},B={key:1,class:"g-tip-color ac"},F=S((()=>c("div",{class:"card-title"},"跟进记录",-1))),R={key:2,class:"g-tip-color ac"};const Y=i(j,[["render",function(e,a,t,s,l,r){const i=o("el-tag"),v=o("el-card"),_=o("el-col"),j=o("el-row"),S=o("el-step"),Y=o("el-steps"),J=o("record-table"),O=o("el-tab-pane"),P=o("el-tabs");return d(),u("div",null,[p(j,{gutter:10},{default:n((()=>[p(_,{span:24},{default:n((()=>[c("div",w,[p(v,{class:"mb10",shadow:"never"},{header:n((()=>[I])),default:n((()=>[l.portrayalSum.companyTags&&l.portrayalSum.companyTags.length?(d(!0),u(m,{key:0},f(l.portrayalSum.companyTags,((e,a)=>(d(),u("div",{key:a,class:y(["flex  ait",a&&"mt20"])},[t.userId?k("",!0):(d(),u("div",T,g(e.userName),1)),e.tagNames?(d(),u("div",N,[(d(!0),u(m,null,f(e.tagNames.split(","),((e,a)=>(d(),b(i,{key:a},{default:n((()=>[h(g(e),1)])),_:2},1024)))),128))])):(d(),u("div",x,"暂无标签"))],2)))),128)):(d(),u("div",U,"暂无标签"))])),_:1}),p(v,{class:"mb10",shadow:"never"},{header:n((()=>[V])),default:n((()=>[l.portrayalSum.personTags&&l.portrayalSum.personTags.length?(d(!0),u(m,{key:0},f(l.portrayalSum.personTags,((e,a)=>(d(),u("div",{key:a,class:y(["flex aic",a&&"mt20"])},[t.userId?k("",!0):(d(),u("div",C,g(e.userName),1)),e.tagNames?(d(),u("div",L,[(d(!0),u(m,null,f(e.tagNames.split(","),((e,a)=>(d(),b(i,{key:a},{default:n((()=>[h(g(e),1)])),_:2},1024)))),128))])):(d(),u("div",q,"暂无标签"))],2)))),128)):(d(),u("div",D,"暂无标签"))])),_:1}),t.userId?(d(),u(m,{key:0},[p(v,{class:"mb10",shadow:"never"},{header:n((()=>[E])),default:n((()=>[l.portrayalSum.commonGroupChat?(d(!0),u(m,{key:0},f(l.portrayalSum.commonGroupChat.split(","),((e,a)=>(d(),b(i,{type:"info",key:a},{default:n((()=>[h(g(e),1)])),_:2},1024)))),128)):(d(),u("div",A,"暂无数据"))])),_:1}),p(v,{class:"mb10",shadow:"never"},{header:n((()=>[K])),default:n((()=>[c("div",$,[p(j,{gutter:20,type:"type",class:"pad10",justify:"space-between",style:{"flex-wrap":"wrap"}},{default:n((()=>[(d(!0),u(m,null,f(l.fieldList,((e,a)=>(d(),u(m,{key:a},[["address","customerFullName"].includes(e.labelVal)?k("",!0):(d(),u(m,{key:0},[1==e.isDefault?(d(),b(_,{key:0,span:12},{default:n((()=>["remarkMobiles"==e.labelVal?(d(),b(j,{key:0,class:"baseinfo-row"},{default:n((()=>[p(_,{span:6},{default:n((()=>[h(g(e.labelName),1)])),_:2},1024),p(_,{span:18},{default:n((()=>[h(g(l.portrayalSum.phone||"无"),1)])),_:1})])),_:2},1024)):"age"==e.labelVal?(d(),b(j,{key:1,class:"baseinfo-row"},{default:n((()=>[p(_,{span:6},{default:n((()=>[h(g(e.labelName),1)])),_:2},1024),p(_,{span:18},{default:n((()=>[h(g(r.jsGetAge(l.portrayalSum.birthday)),1)])),_:1})])),_:2},1024)):"birthday"==e.labelVal?(d(),b(j,{key:2,class:"baseinfo-row"},{default:n((()=>[p(_,{span:6},{default:n((()=>[h(g(e.labelName),1)])),_:2},1024),p(_,{span:18},{default:n((()=>[h(g(l.portrayalSum.birthday||"无"),1)])),_:1})])),_:2},1024)):"email"==e.labelVal?(d(),b(j,{key:3,class:"baseinfo-row"},{default:n((()=>[p(_,{span:6},{default:n((()=>[h(g(e.labelName),1)])),_:2},1024),p(_,{span:18},{default:n((()=>[h(g(l.portrayalSum.email||"无"),1)])),_:1})])),_:2},1024)):"area"==e.labelVal?(d(),b(j,{key:4,class:"baseinfo-row"},{default:n((()=>[p(_,{span:6},{default:n((()=>[h(g(e.labelName),1)])),_:2},1024),p(_,{span:18},{default:n((()=>[h(g(l.portrayalSum.address||"无"),1)])),_:1})])),_:2},1024)):"qq"==e.labelVal?(d(),b(j,{key:5,class:"baseinfo-row"},{default:n((()=>[p(_,{span:6},{default:n((()=>[h(g(e.labelName),1)])),_:2},1024),p(_,{span:18},{default:n((()=>[h(g(l.portrayalSum.qq||"无"),1)])),_:1})])),_:2},1024)):"position"==e.labelVal?(d(),b(j,{key:6,class:"baseinfo-row"},{default:n((()=>[p(_,{span:6},{default:n((()=>[h(g(e.labelName),1)])),_:2},1024),p(_,{span:18},{default:n((()=>[h(g(l.portrayalSum.position||"无"),1)])),_:1})])),_:2},1024)):"remarkCorpName"==e.labelVal?(d(),b(j,{key:7,class:"baseinfo-row"},{default:n((()=>[p(_,{span:6},{default:n((()=>[h(g(e.labelName),1)])),_:2},1024),p(_,{span:18},{default:n((()=>[h(g(l.portrayalSum.corpName||"无"),1)])),_:1})])),_:2},1024)):"otherDescr"==e.labelVal?(d(),b(j,{key:8,class:"baseinfo-row"},{default:n((()=>[p(_,{span:6},{default:n((()=>[h(g(e.labelName),1)])),_:2},1024),p(_,{span:18},{default:n((()=>[h(g(l.portrayalSum.otherDescr||"无"),1)])),_:1})])),_:2},1024)):k("",!0)])),_:2},1024)):(d(),b(_,{key:1,span:12},{default:n((()=>[3!==e.type?(d(),b(j,{key:0,class:"baseinfo-row"},{default:n((()=>[p(_,{span:6},{default:n((()=>[h(g(e.labelName),1)])),_:2},1024),p(_,{span:18},{default:n((()=>[h(g(e.value||"无"),1)])),_:2},1024)])),_:2},1024)):(d(),u(m,{key:1},[1==e.typeSub?(d(),b(j,{key:0,class:"baseinfo-row"},{default:n((()=>[p(_,{span:6},{default:n((()=>[h(g(e.labelName),1)])),_:2},1024),p(_,{span:18},{default:n((()=>[h(g(e.value||"无"),1)])),_:2},1024)])),_:2},1024)):(d(),b(j,{key:1,class:"baseinfo-row"},{default:n((()=>[p(_,{span:6},{default:n((()=>[h(g(e.labelName),1)])),_:2},1024),p(_,{span:18},{default:n((()=>[h(g(e.value.join(",")||"无"),1)])),_:2},1024)])),_:2},1024))],64))])),_:2},1024))],64))],64)))),128))])),_:1})])])),_:1})],64)):k("",!0),p(v,{class:"mb10",shadow:"never"},{header:n((()=>[z])),default:n((()=>[t.trackUsers&&t.trackUsers.length?(d(!0),u(m,{key:0},f(t.trackUsers,((e,a)=>(d(),u("div",{key:a,class:y(["flex aic",a&&"mt20"])},[t.userId?k("",!0):(d(),u("div",G,g(e.userName),1)),1===e.trackState?(d(),b(Y,{key:1,style:{flex:"auto"},active:1},{default:n((()=>[p(S,{title:"待跟进"})])),_:1})):3===e.trackState||4===e.trackState||5===e.trackState?(d(),b(Y,{key:2,style:{flex:"auto"},active:r.setActive(e.trackState)},{default:n((()=>[p(S,{title:"待跟进"}),(d(!0),u(m,null,f(l.stage,((e,a)=>(d(),u(m,null,[2==e.stageState?(d(),b(S,{title:e.stageKey,key:a},null,8,["title"])):k("",!0)],64)))),256)),(d(!0),u(m,null,f(l.stage,((a,t)=>(d(),u(m,null,[e.trackState==a.stageVal?(d(),b(S,{title:a.stageKey,key:t},null,8,["title"])):k("",!0)],64)))),256))])),_:2},1032,["active"])):e.trackState?(d(),b(Y,{key:3,style:{flex:"auto"},active:r.setList(e.trackState)},{default:n((()=>[(d(!0),u(m,null,f(l.stage,((a,t)=>(d(),u(m,null,[r.setList(e.trackState)<=t+1?(d(),b(S,{title:a.stageKey,key:t},null,8,["title"])):k("",!0)],64)))),256))])),_:2},1032,["active"])):(d(),u("div",M,"暂无数据"))],2)))),128)):(d(),u("div",B,"暂无数据"))])),_:1}),p(v,{shadow:"never"},{header:n((()=>[F])),default:n((()=>[t.userId?(d(),b(J,{key:0,stageList:l.stage,userId:t.userId},null,8,["stageList","userId"])):t.trackUsers&&t.trackUsers.length?(d(),b(P,{key:1,"model-value":"0",onTabClick:r.changeTab},{default:n((()=>[(d(!0),u(m,null,f(t.trackUsers,((e,a)=>(d(),b(O,{key:a,label:e.userName},{default:n((()=>[l.openedTabs.includes(a+"")?(d(),b(J,{key:0,stageList:l.stage,userId:e.trackUserId},null,8,["stageList","userId"])):k("",!0)])),_:2},1032,["label"])))),128))])),_:1},8,["onTabClick"])):(d(),u("div",R,"暂无数据"))])),_:1})])])),_:1})])),_:1})])}],["__scopeId","data-v-b636d993"]]);export{Y as default};
