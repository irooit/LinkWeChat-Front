import{g as e,a as t}from"./index-0bf429ac.js";import{g as i}from"./staff-48996164.js";import a from"./PreviewInPhone-9ed75a0f.js";import{ai as s,aq as r,o,c as l,a as p,_ as d,U as m,Z as n,K as u,a9 as g,P as h,aa as c,T as y,Y as j,X as f,V as v,O as b,$ as q}from"./@vue-e400fd81.js";import{_ as x}from"./quill-image-resize-module-c051113e.js";import"../index-044285d2.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";const w={class:"page"},T={style:{"margin-top":"16px"}},L={class:"title"},I={class:"title-name"},N={class:"item-list"},k=["onClick"],C={class:"name"},P={class:"g-card",style:{"padding-bottom":"0"}},V={class:"pad20"};const _=x({name:"MaPage",components:{PreviewInPhone:a},props:{type:{type:String,default:"0"},selected:{type:[Array,String],default:""}},data(){return{data:"裂变海报",mobForm:[{}],groupList:[],groupVisible:!1,groupForm:{mediaType:this.type,name:""},groupRules:{name:[{required:!0,message:"请输入分组名称",trigger:"blur"},{min:1,max:15,message:"长度在 1 到 15 个字符",trigger:"blur"}]},groupIndex:0,delObj:{updateOrDel:1,moduleType:1,ids:[]},times:null,submitLoading:!1,audioType:["amr"],loading:!0,query:{pageNum:1,pageSize:10,materialName:"",mediaType:"0",categoryId:""},list:[],total:0,treeData:[{}],treeProps:{children:"children",label:"name"},treeForm:{},treeDialogVisible:!1,group:"",groupDialogVisible:!1,groupProps:{expandTrigger:"hover",checkStrictly:!0,children:"children",label:"name",value:"id",emitPath:!1},form:{}}},watch:{},computed:{},created(){this.query.mediaType=this.type,this.getTree(),this.getCodeCategoryListFn()},mounted(){this.mobForm[0].msgType=this.type},methods:{getCodeCategoryListFn(){i({mediaType:this.type}).then((e=>{200==e.code&&(this.groupList=e.data,this.query.categoryId=this.groupList[0].id,this.groupIndex=0,this.query.pageNum=1,"5"==this.type?this.query.type=2:delete this.query.type,this.getList())}))},switchGroup(e,t){this.groupIndex=e,this.query.categoryId=t.id,this.search()},search(){this.query.pageNum=1,this.getList()},editGroup(e){this.groupForm=JSON.parse(JSON.stringify(e)),this.groupVisible=!0},resetQuery(){this.query.materialName="",this.search()},getTree(){e(this.type).then((({data:e})=>{this.treeData=[{id:"",name:"全部",parentId:"0",hasParent:!1,hasChildren:!0,children:e||[]}]}))},getList(e){e&&(this.query.pageNum=e),this.loading=!0,t(this.query).then((({rows:e,total:t})=>{this.list=e.sort(((e,t)=>+new Date(t.updateTime)-+new Date(e.updateTime))),this.total=+t,this.loading=!1,this.$emit("listChange",this.list)})).catch((()=>{this.loading=!1}))}}},[["render",function(e,t,i,a,x,_){const D=s("el-col"),S=s("el-input"),z=s("el-option"),F=s("el-select"),O=s("el-button"),U=s("pagination"),$=s("el-row"),M=r("loading");return o(),l("div",w,[p("div",T,[d($,{type:"flex",justify:"space-between"},{default:m((()=>[d(D,{span:5,class:"left pad20",style:{"border-radius":"4px",background:"var(--bg-white)"}},{default:m((()=>{var t;return[p("div",L,[p("div",I,n(null==(t=e.$dictMaterialType[i.type])?void 0:t.name)+"分组",1)]),p("div",N,[(o(!0),l(u,null,g(x.groupList,((e,t)=>(o(),l("div",{class:h(["item",{active:x.groupIndex==t}]),key:e.id,onClick:i=>_.switchGroup(t,e)},[p("div",C,n(e.name+" ("+e.number+")"),1)],10,k)))),128))])]})),_:1}),d(D,{span:19,style:{"margin-top":"0px"}},{default:m((()=>{var a;return[p("div",P,[d(S,{modelValue:x.query.materialName,"onUpdate:modelValue":t[0]||(t[0]=e=>x.query.materialName=e),placeholder:"请输入"+(null==(a=e.$dictMaterialType[i.type])?void 0:a.name)+"标题",clearable:"","prefix-icon":"el-icon-search",style:{width:"300px"},onKeyup:t[1]||(t[1]=c((e=>_.search()),["enter"]))},null,8,["modelValue","placeholder"]),"5"==i.type?(o(),y(F,{key:0,modelValue:x.data,"onUpdate:modelValue":t[2]||(t[2]=e=>x.data=e),disabled:""},{default:m((()=>[d(z,{label:"裂变海报"},{default:m((()=>[j("裂变海报")])),_:1})])),_:1},8,["modelValue"])):f("",!0),d(O,{class:"ml10",onClick:t[3]||(t[3]=e=>_.getList(1))},{default:m((()=>[j("查询")])),_:1}),d(O,{onClick:_.resetQuery},{default:m((()=>[j("重置")])),_:1},8,["onClick"])]),p("div",V,[v((o(),l("div",null,[b(e.$slots,"default",{list:x.list},void 0,!0)])),[[M,x.loading]]),v(d(U,{total:x.total,page:x.query.pageNum,"onUpdate:page":t[4]||(t[4]=e=>x.query.pageNum=e),limit:x.query.pageSize,"onUpdate:limit":t[5]||(t[5]=e=>x.query.pageSize=e),onPagination:t[6]||(t[6]=e=>_.getList())},null,8,["total","page","limit"]),[[q,x.total>0]])])]})),_:3})])),_:3})])])}],["__scopeId","data-v-7895d061"]]);export{_ as default};
