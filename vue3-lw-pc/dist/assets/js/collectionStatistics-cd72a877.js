import{d as t}from"../index-044285d2.js";import e from"./ChartBar-39a01942.js";import a from"./ChartLine-b009fc4d.js";import i from"./SearchTitle-ceb204ee.js";import{e as s,f as o,h as l,i as r,j as d}from"./pullNews-68e01d94.js";import{_ as n}from"./quill-image-resize-module-c051113e.js";import{ai as p,aq as m,o as h,c as u,_ as c,a as g,V as j,T as f,U as y,Y as v}from"./@vue-e400fd81.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";import"./echarts-8e7b9cd7.js";import"./tslib-a4e99503.js";import"./zrender-da4e2cf7.js";import"./lodash.merge-f1a4e0c2.js";import"./moment-8163541f.js";const b={name:"identity-code-statistics",components:{SearchTitle:i,ChartLine:a,ChartBar:e},data:()=>({exportLoading:!1,legend:["新客扫码人数","添加新客人数","老客扫码人数","流失客户人数"],legendRedOne:["红包领取个数"],legendRedTwo:["红包领取金额（元）"],legendCardOne:["卡券领取个数"],legendCardTwo:["卡券领取面额（元）"],xdata:[],series:[],xdataOne:[],seriesOne:[],cardData:[],cardDataRed:[{title:"红包领取总数",tips:"当前活码新客累计领取红包的总个数",value:0},{title:"红包领取总金额(元)",tips:"当前活码新客累计领取红包的总金额",value:0},{title:"今日红包领取数",tips:"当前活码今日新客领取红包的总个数",value:0,title1:"较昨日",value1:0},{title:"今日红包领取金额(元)",tips:"当前活码今日新客领取红包的总金额",value:0,title1:"较昨日",value1:0}],cardDataCard:[{title:"卡券领取总数",tips:"当前活码新客累计领取卡券的总个数",value:0},{title:"卡券领取总面额(元)",tips:"当前活码新客累计领取卡券的总面额",value:0},{title:"今日卡券领取数",tips:"当前活码今日新客领取卡券的总个数",value:0,title1:"较昨日",value1:0},{title:"今日红包领取面额(元)",tips:"当前活码今日新客领取卡券的总面额",value:0,title1:"较昨日",value1:0}],total:0,query:{pageSize:10,pageNum:1},tableList:[],loading:!1,searchData:{},bar:[],value:[],tableSearch:{},addWeUserState:null,id:""}),props:{form:{type:Object,default:{}}},methods:{exportFn(){this.$confirm("确认导出吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>(this.exportLoading=!0,s(Object.assign({},this.query,this.tableSearch))))).then((e=>{if(e){let a=new Blob([e],{type:"application/vnd.ms-excel"}),i=window.URL.createObjectURL(a);const s=document.createElement("a");s.href=i,s.download="数据明细-"+t(new Date)+".xlsx",s.click(),URL.revokeObjectURL(i)}})).catch((t=>{})).finally((()=>{this.exportLoading=!1}))},getTabTotalFn(){o({qrId:this.id}).then((t=>{this.cardDataRed[0].value=t.data.totalNum,this.cardDataRed[1].value=t.data.totalAmount,this.cardDataRed[2].value=t.data.todayNum,t.data.todayNumDiff&&(this.cardDataRed[2].value1=t.data.todayNumDiff),this.cardDataRed[3].value=t.data.todayAmount,t.data.todayAmountDiff&&(this.cardDataRed[3].value1=t.data.todayAmountDiff)}))},getLineData(t){t.qrId=this.id,l(t).then((t=>{this.xdata=[],this.series=[],t.data&&(this.xdata=t.data.xaxis,this.series=[t.data.yaxis])})),r(t).then((t=>{this.xdataOne=[],this.seriesOne=[],t.data&&(this.xdataOne=t.data.xaxis,this.seriesOne=[t.data.yaxis])}))},getTableChangeSize(){this.loading=!0,d(Object.assign({},this.query)).then((t=>{this.tableList=t.rows,this.total=Number(t.total),this.loading=!1}))},getTableFn(t){this.loading=!0,this.query.qrId=this.id,this.query.beginTime=t.beginTime,this.query.endTime=t.endTime,this.getTableChangeSize()}},created(){this.addWeUserState=this.$route.query.addWeUserState,this.id=this.$route.query.groupId,this.getTabTotalFn()}},x={class:"g-card"},w=g("div",{class:"g-card-title"},"数据趋势",-1),D={style:{display:"flex","justify-content":"space-between"}},T={class:"g-card"},q=g("div",{class:"g-card-title"},"数据报表",-1),O={style:{display:"flex","justify-content":"space-between"}};const S=n(b,[["render",function(t,e,a,i,s,o){const l=p("CardGroupIndex"),r=p("search-title"),d=p("chart-line"),n=p("el-button"),b=p("el-table-column"),S=p("el-table"),L=p("pagination"),R=m("loading");return h(),u("div",null,[c(l,{data:1===a.form.type?s.cardDataRed:s.cardDataCard},null,8,["data"]),g("div",x,[w,c(r,{onSearch:o.getLineData},null,8,["onSearch"]),g("div",D,[c(d,{style:{height:"300px",width:"48%"},legend:s.legendRedOne,xData:s.xdataOne,series:s.seriesOne},null,8,["legend","xData","series"]),c(d,{style:{height:"300px",width:"48%"},legend:s.legendRedTwo,xData:s.xdata,series:s.series},null,8,["legend","xData","series"])])]),g("div",T,[q,g("div",O,[c(r,{onSearch:o.getTableFn},null,8,["onSearch"]),j((h(),f(n,{type:"primary",onClick:o.exportFn},{default:y((()=>[v("导出Excel")])),_:1},8,["onClick"])),[[R,s.exportLoading]])]),j((h(),f(S,{data:s.tableList,style:{width:"100%"}},{default:y((()=>[c(b,{label:"日期",align:"center","min-width":"100",prop:"dateTime","show-overflow-tooltip":""}),c(b,{label:"红包领取总数",align:"center",prop:"totalNum","min-width":"100","show-overflow-tooltip":""}),c(b,{label:"红包领取总金额(元)",align:"center",prop:"totalAmount","min-width":"100","show-overflow-tooltip":""}),c(b,{label:"今日红包领取数",align:"center",prop:"todayNum","min-width":"120","show-overflow-tooltip":""}),c(b,{label:"今日红包领取金额(元)",align:"center",prop:"todayAmount","min-width":"120","show-overflow-tooltip":""})])),_:1},8,["data"])),[[R,s.loading]]),c(L,{total:s.total,page:s.query.pageNum,"onUpdate:page":e[0]||(e[0]=t=>s.query.pageNum=t),limit:s.query.pageSize,"onUpdate:limit":e[1]||(e[1]=t=>s.query.pageSize=t),onPagination:e[2]||(e[2]=t=>o.getTableChangeSize())},null,8,["total","page","limit"])])])}]]);export{S as default};
