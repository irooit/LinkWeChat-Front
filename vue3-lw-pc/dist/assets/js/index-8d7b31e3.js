import{d as draggable}from"./vuedraggable-6f5e6033.js";import{F as FileSaver_minExports}from"./file-saver-40ca0bfd.js";import{b as beautifier}from"./js-beautify-7c0eaa99.js";import{t as trigger,R as RightPanel,f as formConf,i as inputComponents}from"./RightPanel-299cad40.js";import{a3 as titleCase,a4 as exportDefault,b as uuid,a5 as beautifierConf}from"../index-044285d2.js";import CodeTypeDialog from"./CodeTypeDialog-a4fd582c.js";import DraggableItem from"./DraggableItem-8beb6ac6.js";import{ai as resolveComponent,o as openBlock,c as createElementBlock,a as createBaseVNode,_ as createVNode,U as withCtx,Y as createTextVNode,Z as toDisplayString,K as Fragment,a9 as renderList,P as normalizeClass,a5 as withModifiers,V as withDirectives,$ as vShow,bl as pushScopeId,bj as popScopeId}from"./@vue-e400fd81.js";import{_ as _export_sfc}from"./quill-image-resize-module-c051113e.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./vue-afbfa742.js";import"./TreeNodeDialog-1d89ab66.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";import"./quill-c6b3d2fb.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";import"./IconsDialog-a9f799a3.js";let confGlobal$1,someSpanIsNot24;function dialogWrapper(e){return`<el-dialog v-bind="$attrs"  @open="onOpen" @close="onClose" title="Dialog Titile">\n    ${e}\n    <template #footer><div>\n      <el-button @click="close">取消</el-button>\n      <el-button type="primary" @click="handelConfirm">确定</el-button>\n    </div></template>\n  </el-dialog>`}function vueTemplate(e){return`<template>\n    <div>\n      ${e}\n    </div>\n  </template>`}function vueScript(e){return`<script>\n    ${e}\n  <\/script>`}function cssStyle(e){return`<style>\n    ${e}\n  </style>`}function buildFormTemplate(e,t,i){let a="";"right"!==e.labelPosition&&(a=`label-position="${e.labelPosition}"`);const o=e.disabled?`:disabled="${e.disabled}"`:"";let l=`<el-form ref="${e.formRef}" :model="${e.formModel}" :rules="${e.formRules}" size="${e.size}" ${o} label-width="${e.labelWidth}px" ${a}>\n      ${t}\n      ${buildFromBtns(e,i)}\n    </el-form>`;return someSpanIsNot24&&(l=`<el-row :gutter="${e.gutter}">\n        ${l}\n      </el-row>`),l}function buildFromBtns(e,t){let i="";return e.formBtns&&"file"===t&&(i='<el-form-item size="large">\n          <el-button type="primary" @click="submitForm">提交</el-button>\n          <el-button @click="resetForm">重置</el-button>\n        </el-form-item>',someSpanIsNot24&&(i=`<el-col :span="24">\n          ${i}\n        </el-col>`)),i}function colWrapper(e,t){return someSpanIsNot24||24!==e.span?`<el-col :span="${e.span}">\n      ${t}\n    </el-col>`:t}const layouts={colFormItem(e){let t="";e.labelWidth&&e.labelWidth!==confGlobal$1.labelWidth&&(t=`label-width="${e.labelWidth}px"`);const i=!trigger[e.tag]&&e.required?"required":"",a=tags[e.tag]?tags[e.tag](e):null;let o=`<el-form-item ${t} label="${e.label}" prop="${e.vModel}" ${i}>\n        ${a}\n      </el-form-item>`;return o=colWrapper(e,o),o},rowFormItem(e){let t=`<el-row ${"default"===e.type?"":`type="${e.type}"`} ${"default"===e.type?"":`justify="${e.justify}"`} ${"default"===e.type?"":`align="${e.align}"`} ${e.gutter?`gutter="${e.gutter}"`:""}>\n      ${e.children.map((e=>layouts[e.layout](e))).join("\n")}\n    </el-row>`;return t=colWrapper(e,t),t}},tags={"el-input":e=>{const{disabled:t,vModel:i,clearable:a,placeholder:o,width:l}=attrBuilder(e),s=e.maxlength?`:maxlength="${e.maxlength}"`:"",n=e["show-word-limit"]?"show-word-limit":"",r=e.readonly?"readonly":"",d=e["prefix-icon"]?`prefix-icon='${e["prefix-icon"]}'`:"",p=e["suffix-icon"]?`suffix-icon='${e["suffix-icon"]}'`:"",c=e["show-password"]?"show-password":"",h=e.type?`type="${e.type}"`:"",m=e.autosize&&e.autosize.minRows?`:autosize="{minRows: ${e.autosize.minRows}, maxRows: ${e.autosize.maxRows}}"`:"";let u=buildElInputChild(e);return u&&(u=`\n${u}\n`),`<${e.tag} ${i} ${h} ${o} ${s} ${n} ${r} ${t} ${a} ${d} ${p} ${c} ${m} ${l}>${u}</${e.tag}>`},"el-image":e=>{const{disabled:t,vModel:i,clearable:a,placeholder:o,width:l,src:s}=attrBuilder(e),n=e.maxlength?`:maxlength="${e.maxlength}"`:"",r=e["show-word-limit"]?"show-word-limit":"",d=e.readonly?"readonly":"",p=e["prefix-icon"]?`prefix-icon='${e["prefix-icon"]}'`:"",c=e["suffix-icon"]?`suffix-icon='${e["suffix-icon"]}'`:"",h=e["show-password"]?"show-password":"",m=e.type?`type="${e.type}"`:"",u=e.autosize&&e.autosize.minRows?`:autosize="{minRows: ${e.autosize.minRows}, maxRows: ${e.autosize.maxRows}}"`:"";let f=buildElInputChild(e);return f&&(f=`\n${f}\n`),`<${e.tag} ${i} ${m} ${o} ${n} ${r} ${d} ${t} ${a} ${p} ${c} ${h} ${u} ${l}>${f}</${e.tag}>`},"el-input-number":e=>{const{disabled:t,vModel:i,placeholder:a}=attrBuilder(e),o=e["controls-position"]?`controls-position=${e["controls-position"]}`:"",l=e.min?`:min='${e.min}'`:"",s=e.max?`:max='${e.max}'`:"",n=e.step?`:step='${e.step}'`:"",r=e["step-strictly"]?"step-strictly":"",d=e.precision?`:precision='${e.precision}'`:"";return`<${e.tag} ${i} ${a} ${n} ${r} ${d} ${o} ${l} ${s} ${t}></${e.tag}>`},"el-select":e=>{const{disabled:t,vModel:i,clearable:a,placeholder:o,width:l}=attrBuilder(e),s=e.filterable?"filterable":"",n=e.multiple?"multiple":"";let r=buildElSelectChild(e);return r&&(r=`\n${r}\n`),`<${e.tag} ${i} ${o} ${t} ${n} ${s} ${a} ${l}>${r}</${e.tag}>`},"el-radio-group":e=>{const{disabled:t,vModel:i}=attrBuilder(e),a=`size="${e.size}"`;let o=buildElRadioGroupChild(e);return o&&(o=`\n${o}\n`),`<${e.tag} ${i} ${a} ${t}>${o}</${e.tag}>`},"el-checkbox-group":e=>{const{disabled:t,vModel:i}=attrBuilder(e),a=`size="${e.size}"`,o=e.min?`:min="${e.min}"`:"",l=e.max?`:max="${e.max}"`:"";let s=buildElCheckboxGroupChild(e);return s&&(s=`\n${s}\n`),`<${e.tag} ${i} ${o} ${l} ${a} ${t}>${s}</${e.tag}>`},"el-switch":e=>{const{disabled:t,vModel:i}=attrBuilder(e),a=e["active-text"]?`active-text="${e["active-text"]}"`:"",o=e["inactive-text"]?`inactive-text="${e["inactive-text"]}"`:"",l=e["active-color"]?`active-color="${e["active-color"]}"`:"",s=e["inactive-color"]?`inactive-color="${e["inactive-color"]}"`:"",n=!0!==e["active-value"]?`:active-value='${JSON.stringify(e["active-value"])}'`:"",r=!1!==e["inactive-value"]?`:inactive-value='${JSON.stringify(e["inactive-value"])}'`:"";return`<${e.tag} ${i} ${a} ${o} ${l} ${s} ${n} ${r} ${t}></${e.tag}>`},"el-cascader":e=>{const{disabled:t,vModel:i,clearable:a,placeholder:o,width:l}=attrBuilder(e),s=e.options?`:options="${e.vModel}Options"`:"",n=e.props?`:props="${e.vModel}Props"`:"",r=e["show-all-levels"]?"":':show-all-levels="false"',d=e.filterable?"filterable":"",p="/"===e.separator?"":`separator="${e.separator}"`;return`<${e.tag} ${i} ${s} ${n} ${l} ${r} ${o} ${p} ${d} ${a} ${t}></${e.tag}>`},"el-slider":e=>{const{disabled:t,vModel:i}=attrBuilder(e),a=e.min?`:min='${e.min}'`:"",o=e.max?`:max='${e.max}'`:"",l=e.step?`:step='${e.step}'`:"",s=e.range?"range":"",n=e["show-stops"]?`:show-stops="${e["show-stops"]}"`:"";return`<${e.tag} ${a} ${o} ${l} ${i} ${s} ${n} ${t}></${e.tag}>`},"el-time-picker":e=>{const{disabled:t,vModel:i,clearable:a,placeholder:o,width:l}=attrBuilder(e),s=e["start-placeholder"]?`start-placeholder="${e["start-placeholder"]}"`:"",n=e["end-placeholder"]?`end-placeholder="${e["end-placeholder"]}"`:"",r=e["range-separator"]?`range-separator="${e["range-separator"]}"`:"",d=e["is-range"]?"is-range":"",p=e.format?`format="${e.format}"`:"",c=e["value-format"]?`value-format="${e["value-format"]}"`:"",h=e["picker-options"]?`:picker-options='${JSON.stringify(e["picker-options"])}'`:"";return`<${e.tag} ${i} ${d} ${p} ${c} ${h} ${l} ${o} ${s} ${n} ${r} ${a} ${t}></${e.tag}>`},"el-date-picker":e=>{const{disabled:t,vModel:i,clearable:a,placeholder:o,width:l}=attrBuilder(e),s=e["start-placeholder"]?`start-placeholder="${e["start-placeholder"]}"`:"",n=e["end-placeholder"]?`end-placeholder="${e["end-placeholder"]}"`:"",r=e["range-separator"]?`range-separator="${e["range-separator"]}"`:"",d=e.format?`format="${e.format}"`:"",p=e["value-format"]?`value-format="${e["value-format"]}"`:"",c="date"===e.type?"":`type="${e.type}"`,h=e.readonly?"readonly":"";return`<${e.tag} ${c} ${i} ${d} ${p} ${l} ${o} ${s} ${n} ${r} ${a} ${h} ${t}></${e.tag}>`},"el-rate":e=>{const{disabled:t,vModel:i}=attrBuilder(e);e.max&&e.max;const a=e["allow-half"]?"allow-half":"",o=e["show-text"]?"show-text":"",l=e["show-score"]?"show-score":"";return`<${e.tag} ${i} ${a} ${o} ${l} ${t}></${e.tag}>`},"el-color-picker":e=>{const{disabled:t,vModel:i}=attrBuilder(e),a=`size="${e.size}"`,o=e["show-alpha"]?"show-alpha":"",l=e["color-format"]?`color-format="${e["color-format"]}"`:"";return`<${e.tag} ${i} ${a} ${o} ${l} ${t}></${e.tag}>`},"el-upload":e=>{const t=e.disabled?":disabled='true'":"",i=e.action?`:action="${e.vModel}Action"`:"",a=e.multiple?"multiple":"",o="text"!==e["list-type"]?`list-type="${e["list-type"]}"`:"",l=e.accept?`accept="${e.accept}"`:"",s="file"!==e.name?`name="${e.name}"`:"",n=!1===e["auto-upload"]?':auto-upload="false"':"",r=`:before-upload="${e.vModel}BeforeUpload"`,d=`:file-list="${e.vModel}fileList"`,p=`ref="${e.vModel}"`;let c=buildElUploadChild(e);return c&&(c=`\n${c}\n`),`<${e.tag} ${p} ${d} ${i} ${n} ${a} ${r} ${o} ${l} ${s} ${t}>${c}</${e.tag}>`}};function attrBuilder(e){return{vModel:`v-model="${confGlobal$1.formModel}.${e.vModel}"`,clearable:e.clearable?"clearable":"",placeholder:e.placeholder?`placeholder="${e.placeholder}"`:"",width:e.style&&e.style.width?":style=\"{width: '100%'}\"":"",disabled:e.disabled?":disabled='true'":""}}function buildElInputChild(e){const t=[];return e.prepend&&t.push(`<template #prepend>${e.prepend}</template>`),e.append&&t.push(`<template #append>${e.append}</template>`),t.join("\n")}function buildElSelectChild(e){const t=[];return e.options&&e.options.length&&t.push(`<el-option v-for="(item, index) in ${e.vModel}Options" :key="index" :label="item.label" :value="item.value" :disabled="item.disabled"></el-option>`),t.join("\n")}function buildElRadioGroupChild(e){const t=[];if(e.options&&e.options.length){const i="button"===e.optionType?"el-radio-button":"el-radio",a=e.border?"border":"";t.push(`<${i} v-for="(item, index) in ${e.vModel}Options" :key="index" :label="item.value" :disabled="item.disabled" ${a}>{{item.label}}</${i}>`)}return t.join("\n")}function buildElCheckboxGroupChild(e){const t=[];if(e.options&&e.options.length){const i="button"===e.optionType?"el-checkbox-button":"el-checkbox",a=e.border?"border":"";t.push(`<${i} v-for="(item, index) in ${e.vModel}Options" :key="index" :label="item.value" :disabled="item.disabled" ${a}>{{item.label}}</${i}>`)}return t.join("\n")}function buildElUploadChild(e){const t=[];return"picture-card"===e["list-type"]?t.push('<el-icon-plus class="el-icon-plus"></el-icon-plus>'):t.push(`<el-button size="small" type="primary" icon="el-icon-upload">${e.buttonText}</el-button>`),e.showTip&&t.push(`<template #tip><div class="el-upload__tip">只能上传不超过 ${e.fileSize}${e.sizeUnit} 的${e.accept}文件</div></template>`),t.join("\n")}function makeUpHtml(e,t){const i=[];confGlobal$1=e,someSpanIsNot24=e.fields.some((e=>24!==e.span)),e.fields.forEach((e=>{i.push(layouts[e.layout](e))}));let a=buildFormTemplate(e,i.join("\n"),t);return"dialog"===t&&(a=dialogWrapper(a)),confGlobal$1=null,a}const units={KB:"1024",MB:"1024 / 1024",GB:"1024 / 1024 / 1024"};let confGlobal;const inheritAttrs={file:"",dialog:"inheritAttrs: false,"};function makeUpJs(e,t){confGlobal=e=JSON.parse(JSON.stringify(e));const i=[],a=[],o=[],l=[],s=mixinMethod(t),n=[];e.fields.forEach((e=>{buildAttributes(e,i,a,o,s,l,n)}));const r=buildexport(e,t,i.join("\n"),a.join("\n"),o.join("\n"),n.join("\n"),l.join("\n"),s.join("\n"));return confGlobal=null,r}function buildAttributes(e,t,i,a,o,l,s){if(buildData(e,t),buildRules(e,i),e.options&&e.options.length&&(buildOptions(e,a),"dynamic"===e.dataType)){const t=`${e.vModel}Options`;buildOptionMethod(`get${titleCase(t)}`,t,o)}e.props&&e.props.props&&buildProps(e,l),e.action&&"el-upload"===e.tag&&(s.push(`${e.vModel}Action: '${e.action}',\n      ${e.vModel}fileList: [],`),o.push(buildBeforeUpload(e)),e["auto-upload"]||o.push(buildSubmitUpload(e))),e.children&&e.children.forEach((e=>{buildAttributes(e,t,i,a,o,l,s)}))}function mixinMethod(e){const t=[],i={file:confGlobal.formBtns?{submitForm:`submitForm() {\n        this.$refs['${confGlobal.formRef}'].validate(valid => {\n          if(!valid) return\n          // TODO 提交表单\n        })\n      },`,resetForm:`resetForm() {\n        this.$refs['${confGlobal.formRef}'].resetFields()\n      },`}:null,dialog:{onOpen:"onOpen() {},",onClose:`onClose() {\n        this.$refs['${confGlobal.formRef}'].resetFields()\n      },`,close:"close() {\n        this.$emit('update:visible', false)\n      },",handelConfirm:`handelConfirm() {\n        this.$refs['${confGlobal.formRef}'].validate(valid => {\n          if(!valid) return\n          this.close()\n        })\n      },`}}[e];return i&&Object.keys(i).forEach((e=>{t.push(i[e])})),t}function buildData(e,t){if(void 0===e.vModel)return;let i;i="string"!=typeof e.defaultValue||e.multiple?`${JSON.stringify(e.defaultValue)}`:`'${e.defaultValue}'`,t.push(`${e.vModel}: ${i},`)}function buildRules(conf,ruleList){if(void 0===conf.vModel)return;const rules=[];if(trigger[conf.tag]){if(conf.required){const e=Array.isArray(conf.defaultValue)?"type: 'array',":"";let t=Array.isArray(conf.defaultValue)?`请至少选择一个${conf.vModel}`:conf.placeholder;void 0===t&&(t=`${conf.label}不能为空`),rules.push(`{ required: true, ${e} message: '${t}', trigger: '${trigger[conf.tag]}' }`)}conf.regList&&Array.isArray(conf.regList)&&conf.regList.forEach((item=>{item.pattern&&rules.push(`{ pattern: ${eval(item.pattern)}, message: '${item.message}', trigger: '${trigger[conf.tag]}' }`)})),ruleList.push(`${conf.vModel}: [${rules.join(",")}],`)}}function buildOptions(e,t){if(void 0===e.vModel)return;"dynamic"===e.dataType&&(e.options=[]);const i=`${e.vModel}Options: ${JSON.stringify(e.options)},`;t.push(i)}function buildProps(e,t){"dynamic"===e.dataType&&("value"!==e.valueKey&&(e.props.props.value=e.valueKey),"label"!==e.labelKey&&(e.props.props.label=e.labelKey),"children"!==e.childrenKey&&(e.props.props.children=e.childrenKey));const i=`${e.vModel}Props: ${JSON.stringify(e.props.props)},`;t.push(i)}function buildBeforeUpload(e){const t=units[e.sizeUnit];let i="",a="";const o=[];e.fileSize&&(i=`let isRightSize = file.size / ${t} < ${e.fileSize}\n    if(!isRightSize){\n      this.$message.error('文件大小超过 ${e.fileSize}${e.sizeUnit}')\n    }`,o.push("isRightSize")),e.accept&&(a=`let isAccept = new RegExp('${e.accept}').test(file.type)\n    if(!isAccept){\n      this.$message.error('应该选择${e.accept}类型的文件')\n    }`,o.push("isAccept"));const l=`${e.vModel}BeforeUpload(file) {\n    ${i}\n    ${a}\n    return ${o.join("&&")}\n  },`;return o.length?l:""}function buildSubmitUpload(e){return`submitUpload() {\n    this.$refs['${e.vModel}'].submit()\n  },`}function buildOptionMethod(e,t,i){const a=`${e}() {\n    // TODO 发起请求获取数据\n    this.${t}\n  },`;i.push(a)}function buildexport(e,t,i,a,o,l,s,n){return`${exportDefault}{\n  ${inheritAttrs[t]}\n  components: {},\n  props: [],\n  data () {\n    return {\n      ${e.formModel}: {\n        ${i}\n      },\n      ${e.formRules}: {\n        ${a}\n      },\n      ${l}\n      ${o}\n      ${s}\n    }\n  },\n  computed: {},\n  watch: {},\n  created () {},\n  mounted () {},\n  methods: {\n    ${n}\n  }\n}`}const styles={"el-rate":".el-rate{display: inline-block; vertical-align: text-top;}","el-upload":".el-upload__tip{line-height: 1.2;}"};function addCss(e,t){const i=styles[t.tag];i&&-1===e.indexOf(i)&&e.push(i),t.children&&t.children.forEach((t=>addCss(e,t)))}function makeUpCss(e){const t=[];return e.fields.forEach((e=>addCss(t,e))),t.join("\n")}const drawingDefalutInit=[{formCodeId:11,label:"姓名",captions:"",tag:"el-input",tagIcon:"input",layout:"colFormItem",placeholder:"请输入你的名字",defaultValue:void 0,span:24,labelWidth:null,style:{width:"100%"},clearable:!0,prepend:"",append:"","prefix-icon":"","suffix-icon":"",maxlength:null,"show-word-limit":!0,readonly:!1,disabled:!1,required:!0,regList:[],changeTag:!0,renderKey:+new Date},{formCodeId:5,layout:"colFormItem",tagIcon:"phone",label:"手机号",captions:"",tag:"el-input",placeholder:"请输入手机号",defaultValue:"",span:24,style:{width:"100%"},clearable:!0,prepend:"",append:"","prefix-icon":"","suffix-icon":"",maxlength:11,"show-word-limit":!0,change:"change",readonly:!1,disabled:!1,required:!0,changeTag:!0,regList:[{pattern:/^1[^012]\d{9}$/,message:"手机号格式错误"}],renderKey:+new Date}],index_vue_vue_type_style_index_0_scoped_611428b5_lang="";let drawingDefalut=[],oldActiveId,tempActiveData;const _sfc_main={components:{draggable:draggable,RightPanel:RightPanel,CodeTypeDialog:CodeTypeDialog,DraggableItem:DraggableItem},props:{pageDataAll:{type:Array}},data(){return{ifNew:!0,drawingListOld:"",logo:this.lwConfig.LOGO_DARK,idGlobal:"",formConf:formConf,inputComponents:inputComponents,labelWidth:100,drawingList:[],drawingData:{},activeId:0,drawerVisible:!1,formData:{},dialogVisible:!1,generateConf:null,showFileName:!1,activeData:drawingDefalut[0],pageData:[],page:1}},computed:{},watch:{"activeData.label":function(e,t){void 0!==this.activeData.placeholder&&this.activeData.tag&&this.activeId},pageDataAll:{handler(e){this.pageData=e,this.drawingList=this.pageData[this.page-1]},deep:!0},activeId:{handler(e){oldActiveId=e},immediate:!0},drawingList:{handler(e){e.length!=this.drawingListOld.length&&this.Updates();for(let i=0;i<this.pageData.length;i++)for(let e=0;e<this.pageData[i].length;e++)"625"!=this.pageData[i][e].formCodeId&&"626"!=this.pageData[i][e].formCodeId||this.pageData[i].splice(e,1);if(this.page-1==-1)return this.pageData.styles=[],void this.$emit("toStyles",JSON.stringify(this.pageData));this.pageData[this.page-1]=e;try{localStorage.setItem("pageData",this.pageData)}catch(t){}this.drawingListOld=[];for(let i=0;i<e.length;i++)this.drawingListOld.push(e[i]);this.$emit("toStyles",this.pageData)},deep:!0}},created(){drawingDefalut=JSON.parse(JSON.stringify(drawingDefalutInit)),this.pageDataAll&&(this.pageData=this.pageDataAll)},mounted(){this.pageDataAll?this.drawingList=this.pageDataAll[0]:this.drawingList=drawingDefalut,drawingDefalut[0]&&(drawingDefalut.forEach((e=>{e.formId=uuid()})),this.activeId=drawingDefalut[0].formId),this.pageData[this.page-1]=this.drawingList;for(let e=0;e<this.pageData.length;e++)for(let t=0;t<this.pageData[e].length;t++)this.pageData[e][t].page=e+1,this.pageData[e][t].pageNo=t+1;this.Updates()},methods:{Updates(){let e=this,t=0;for(let i=0;i<this.pageData.length;i++)for(let a=0;a<this.pageData[i].length;a++)0!=this.pageData[i][a].formCodeId&&1!=this.pageData[i][a].formCodeId?(t++,this.pageData[i][a].page=i+1,this.pageData[i][a].pageNo=a+1,this.pageData[i][a].label.indexOf("."),this.pageData[i][a].TitleNumber=t,"625"==this.pageData[i][a].formCodeId&&"626"==this.pageData[i][a].formCodeId&&(this.pageData[i].splice(a,1),e.toPage(this.page))):(this.pageData[i][a].page=i+1,this.pageData[i][a].label="")},deletePage(e){1!=this.pageData.length?(1!=this.page?this.toPage(this.page-2):this.toPage(this.page-1),this.pageData.splice(e,1)):this.msgError("最后一页不能删除！")},toPage(e){this.page=e+1,0==this.page?this.drawingList=[]:this.drawingList=this.pageData[e],this.Updates()},addPage(){this.pageData.push([])},activeFormItem(e){this.activeData=e,this.activeId=e.formId,this.$forceUpdate()},onEnd(e,t){e.from!==e.to&&(this.activeData=tempActiveData,this.activeId=this.idGlobal)},addComponent(e){const t=this.cloneComponent(e);this.drawingList.push(t),this.activeFormItem(t)},cloneComponent(e){const t=JSON.parse(JSON.stringify(e));return t.formId=this.idGlobal=uuid(),t.span=formConf.span,t.renderKey=+new Date,t.layout||(t.layout="colFormItem"),"rowFormItem"===t.layout&&(delete t.label,t.componentName=`row${this.idGlobal}`,t.gutter=this.formConf.gutter),tempActiveData=t,tempActiveData},AssembleFormData(){this.formData={fields:JSON.parse(JSON.stringify(this.drawingList)),...this.formConf}},generate(e){const t=this[`exec${titleCase(this.operationType)}`];this.generateConf=e,t&&t(e)},execRun(e){this.AssembleFormData(),this.drawerVisible=!0},execDownload(e){const t=this.generateCode(),i=new Blob([t],{type:"text/plain;charset=utf-8"});FileSaver_minExports.saveAs(i,e.fileName)},execCopy(e){document.getElementById("copyNode").click()},empty(){this.$confirm("确定要清空所有组件吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.drawingList=[]}))},drawingItemCopy(e,t){let i=JSON.parse(JSON.stringify(e));i=this.createIdAndKey(i),t.push(i),this.activeFormItem(i)},createIdAndKey(e){return e.formId=this.idGlobal=uuid(),e.renderKey=+new Date,"colFormItem"===e.layout?e.vModel=`field${this.idGlobal}`:"rowFormItem"===e.layout&&(e.componentName=`row${this.idGlobal}`),Array.isArray(e.children)&&(e.children=e.children.map((e=>this.createIdAndKey(e)))),e},drawingItemDelete(e,t){t.splice(e,1),this.$nextTick((()=>{const e=this.drawingList.length;e&&this.activeFormItem(this.drawingList[e-1]),this.Updates()}))},generateCode(){const{type:e}=this.generateConf;this.AssembleFormData();const t=vueScript(makeUpJs(this.formData,e)),i=vueTemplate(makeUpHtml(this.formData,e)),a=cssStyle(makeUpCss(this.formData));return beautifier.html(i+t+a,beautifierConf.html)},download(){this.dialogVisible=!0,this.showFileName=!0,this.operationType="download"},run(){this.dialogVisible=!0,this.showFileName=!1,this.operationType="run"},copy(){this.dialogVisible=!0,this.showFileName=!1,this.operationType="copy"},tagChange(e){(e=this.cloneComponent(e)).vModel=this.activeData.vModel,e.formId=this.activeId,e.span=this.activeData.span,delete this.activeData.tag,delete this.activeData.tagIcon,delete this.activeData.document,Object.keys(e).forEach((t=>{void 0!==this.activeData[t]&&typeof this.activeData[t]==typeof e[t]&&(e[t]=this.activeData[t])})),this.activeData=e,this.updateDrawingList(e,this.drawingList)},updateDrawingList(e,t){const i=t.findIndex((e=>e.formId===this.activeId));i>-1?t.splice(i,1,e):t.forEach((t=>{Array.isArray(t.children)&&this.updateDrawingList(e,t.children)}))}}},_withScopeId=e=>(pushScopeId("data-v-611428b5"),e=e(),popScopeId(),e),_hoisted_1={class:"container"},_hoisted_2={class:"left-board"},_hoisted_3={class:"components-list"},_hoisted_4={class:"components-title"},_hoisted_5=["onClick"],_hoisted_6={class:"components-body"},_hoisted_7=_withScopeId((()=>createBaseVNode("div",{style:{display:"flex","justify-content":"center",color:"var(--font-black-7)"}},"更多控件持续上线中...",-1))),_hoisted_8={class:"center-board"},_hoisted_9={style:{padding:"24px 24px 5px 24px"}},_hoisted_10={style:{},class:"smartForms_build_index_ul"},_hoisted_11=["onClick"],_hoisted_12={class:"smartForms_build_index_ul_liX_hover",style:{cursor:"hand",position:"relative",width:"100%",height:"100%",display:"flex","align-items":"center","justify-content":"center"}},_hoisted_13=["onClick"],_hoisted_14=_withScopeId((()=>createBaseVNode("div",null,"+",-1))),_hoisted_15=[_hoisted_14],_hoisted_16={class:"empty-info"},_hoisted_17=_withScopeId((()=>createBaseVNode("input",{id:"copyNode",type:"hidden"},null,-1)));function _sfc_render(e,t,i,a,o,l){const s=resolveComponent("svg-icon"),n=resolveComponent("draggable"),r=resolveComponent("el-scrollbar"),d=resolveComponent("el-icon-close"),p=resolveComponent("draggable-item"),c=resolveComponent("el-form"),h=resolveComponent("el-col"),m=resolveComponent("el-row"),u=resolveComponent("right-panel"),f=resolveComponent("code-type-dialog");return openBlock(),createElementBlock("div",_hoisted_1,[createBaseVNode("div",_hoisted_2,[createVNode(r,{class:"left-scrollbar"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_3,[createBaseVNode("div",_hoisted_4,[createVNode(s,{icon:"component",class:"mr5"}),createTextVNode(" 表单控件 ")]),createVNode(n,{class:"components-draggable",list:o.inputComponents,"item-key":"formCodeId",group:{name:"componentsGroup",pull:"clone",put:!1},clone:l.cloneComponent,draggable:!1,sort:!1,onEnd:l.onEnd},{item:withCtx((({element:e,index:t})=>[createBaseVNode("div",{class:"components-item",onClick:t=>l.addComponent(e),style:{width:"98%"}},[createBaseVNode("div",_hoisted_6,[createVNode(s,{icon:e.tagIcon},null,8,["icon"]),createTextVNode(" "+toDisplayString(e.label),1)])],8,_hoisted_5)])),_:1},8,["list","clone","onEnd"]),_hoisted_7])])),_:1})]),createBaseVNode("div",_hoisted_8,[createBaseVNode("div",_hoisted_9,[createBaseVNode("div",_hoisted_10,[(openBlock(!0),createElementBlock(Fragment,null,renderList(o.pageData,((e,t)=>(openBlock(),createElementBlock("div",{style:{position:"relative"},onClick:e=>l.toPage(t),key:t,class:normalizeClass(t+1==o.page?"smartForms_build_index_lix smartForms_build_index_liBtn":"smartForms_build_index_lix")},[createBaseVNode("div",_hoisted_12," 第"+toDisplayString(t+1)+"页 ",1),createBaseVNode("div",{onClick:withModifiers((e=>l.deletePage(t)),["stop"]),class:"smartForms_build_index_ul_liY_hover",style:{position:"absolute",right:"2px",top:"9px"}},[createVNode(d,{class:"el-icon-close"})],8,_hoisted_13)],10,_hoisted_11)))),128)),createBaseVNode("div",{onClick:t[0]||(t[0]=e=>l.addPage()),class:"smartForms_build_index_li",style:{width:"30px","border-left":"none"}},_hoisted_15)])]),createVNode(r,{class:"center-scrollbar"},{default:withCtx((()=>[createVNode(m,{class:"center-board-row",gutter:o.formConf.gutter},{default:withCtx((()=>[createVNode(h,null,{default:withCtx((()=>[createVNode(c,{style:{width:"100%"},size:o.formConf.size,"label-position":o.formConf.labelPosition,disabled:o.formConf.disabled,"label-width":o.formConf.labelWidth+"px"},{default:withCtx((()=>[createVNode(n,{class:"drawing-board",list:o.drawingList,animation:340,group:"componentsGroup","item-key":"renderKey"},{item:withCtx((({element:e,index:t})=>[createVNode(p,{"drawing-list":o.drawingList,element:e,index:t,"active-id":o.activeId,"form-conf":o.formConf,onActiveItem:l.activeFormItem,onCopyItem:l.drawingItemCopy,onDeleteItem:l.drawingItemDelete},null,8,["drawing-list","element","index","active-id","form-conf","onActiveItem","onCopyItem","onDeleteItem"])])),_:1},8,["list"]),withDirectives(createBaseVNode("div",_hoisted_16,"从左侧点选组件进行表单设计",512),[[vShow,!o.drawingList.length]])])),_:1},8,["size","label-position","disabled","label-width"])])),_:1})])),_:1},8,["gutter"])])),_:1})]),createVNode(u,{"active-data":o.activeData,"form-conf":o.formConf,"show-field":!!o.drawingList.length,onTagChange:l.tagChange},null,8,["active-data","form-conf","show-field","onTagChange"]),createVNode(f,{visible:o.dialogVisible,"onUpdate:visible":t[1]||(t[1]=e=>o.dialogVisible=e),title:"选择生成类型","show-file-name":o.showFileName,onConfirm:l.generate},null,8,["visible","show-file-name","onConfirm"]),_hoisted_17])}const Build=_export_sfc(_sfc_main,[["render",_sfc_render],["__scopeId","data-v-611428b5"]]);export{Build as default};
