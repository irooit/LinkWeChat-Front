import e from"./PreviewInStore-85980d06.js";import{l as t,c as s}from"./store-1f3cfa19.js";import{_ as i}from"./quill-image-resize-module-c051113e.js";import{ai as o,aq as r,o as l,c as a,_ as m,U as d,a as u,Y as c,K as n,a9 as p,T as f,Z as g,X as h,V as j,bl as b,bj as v}from"./@vue-e400fd81.js";import"./code-ab4e587b.js";import"./quill-c6b3d2fb.js";import"./@babel-efd68da6.js";import"./to-fast-properties-1160b370.js";import"./quill-delta-a1872f89.js";import"./fast-diff-d5a53119.js";import"./lodash.clonedeep-1b6eefdc.js";import"./lodash.isequal-e7d08617.js";import"./@vueup-7cf8cfdd.js";import"../index-044285d2.js";import"./js-cookie-8253c38e.js";/* empty css                      */import"./vue-router-f8d53be7.js";import"./element-plus-68ba2566.js";import"./lodash-es-d4f5f48c.js";import"./@element-plus-214e0f7b.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-c17bc6b2.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./pinia-1b56b17e.js";import"./vue-demi-71ba0ef2.js";import"./jsencrypt-43f479c1.js";import"./crypto-js-d6a67473.js";import"./ali-oss-912914b8.js";import"./axios-fb5f9e0e.js";import"./@vueuse-4025ce01.js";import"./path-browserify-289407ee.js";import"./nprogress-a39edb90.js";import"./clipboard-7a0da8dc.js";function S(e,t,s){""!=t&&(Number.isNaN(Number(t))||Number(t)<1||Number(t)>10||t.toString().indexOf(".")>-1)?s("请输入 1-100 的正整数"):s()}const w={name:"store_code_add",data:()=>({submitLoading:!1,dialogVisibleSelectUser:!1,selectedUserList:[],form:{addOrUpdate:!0,raidus:3,outOfRangeTip:"您所在区域暂未开设门店，可联系客服或手动搜索",welcomeMsg:"直接加入专属门店群，享受更多福利！",codeState:1,storeCodeType:2,customerServiceName:"",customerServiceId:""},rule:{raidus:[{required:!0,message:"请输入门店范围",trigger:"blur"},{validator:S,trigger:"change"}],outOfRangeTip:[{required:!0,message:"请输入超出范围提示",trigger:"blur"}],welcomeMsg:[{required:!0,message:"请输入加群引导语",trigger:"blur"}]}}),components:{PreviewStoreClient:e},created(){this.init()},methods:{setChange(e){1===e&&(this.selectUserList=[],this.form.customerServiceName="",this.form.customerServiceId="")},onSelectUser(){this.dialogVisibleSelectUser=!0},selectedUser(e){this.selectedUserList=e,e&&e.length?(this.form.customerServiceName=e[0].name,this.form.customerServiceId=e[0].userId):(this.form.customerServiceName="",this.form.customerServiceId="")},cancelFn(){this.$router.back()},submitFn(){this.$refs.form.validate((e=>{if(e){if(0===this.form.codeState&&!this.form.customerServiceId)return void this.msgError("开启了活码员工客服， 请选择员工");this.submitLoading=!0,this.form.addOrUpdate=!this.form.id,t(this.form).then((({data:e})=>{this.msgSuccess("操作成功"),this.$router.back(),this.submitLoading=!1}))}}))},init(){s(2).then((({data:e})=>{if((null==e?void 0:e.id)&&(this.form=e,this.form.customerServiceId)){let e={name:this.form.customerServiceName,userId:this.form.customerServiceId};this.selectedUserList=[e]}}))}}},U={class:"g-card"},y=(e=>(b("data-v-3692d4dc"),e=e(),v(),e))((()=>u("div",{class:"sub-des"},"开启后，当客户超过范围时显示该员工客服的二维码",-1))),V={key:0},_={class:"g-card",style:{height:"100%",display:"flex"}};const x=i(w,[["render",function(e,t,s,i,b,v){const S=o("el-input"),w=o("el-form-item"),x=o("el-switch"),k=o("el-tag"),L=o("el-button"),C=o("el-form"),I=o("el-col"),N=o("preview-store-client"),O=o("el-row"),q=o("SelectUser"),R=r("loading");return l(),a("div",null,[m(O,{gutter:10,type:"flex",style:{"margin-top":"10px"}},{default:d((()=>[m(I,null,{default:d((()=>[m(C,{model:b.form,ref:"form",rules:b.rule,"label-width":"120px","label-position":"right"},{default:d((()=>[u("div",U,[m(w,{label:"门店范围：",prop:"raidus"},{default:d((()=>[c(" 距离门店半径 "),m(S,{modelValue:b.form.raidus,"onUpdate:modelValue":t[0]||(t[0]=e=>b.form.raidus=e),style:{width:"50px"}},null,8,["modelValue"]),c(" 公里范围内，客户可扫码添加门店群 ")])),_:1}),m(w,{label:"加群引导语：",prop:"welcomeMsg"},{default:d((()=>[m(S,{modelValue:b.form.welcomeMsg,"onUpdate:modelValue":t[1]||(t[1]=e=>b.form.welcomeMsg=e),type:"textarea",maxlength:"200","show-word-limit":"",placeholder:"请输入加群引导语",autosize:{minRows:5,maxRows:20},clearable:""},null,8,["modelValue"])])),_:1}),m(w,{label:"超出范围提示：",prop:"outOfRangeTip"},{default:d((()=>[m(S,{modelValue:b.form.outOfRangeTip,"onUpdate:modelValue":t[2]||(t[2]=e=>b.form.outOfRangeTip=e),type:"textarea",maxlength:"30","show-word-limit":"",placeholder:"请输入超出范围提示",autosize:{minRows:2,maxRows:20},clearable:""},null,8,["modelValue"])])),_:1}),m(w,{label:"活码员工客服："},{default:d((()=>[m(x,{onChange:v.setChange,modelValue:b.form.codeState,"onUpdate:modelValue":t[3]||(t[3]=e=>b.form.codeState=e),"active-value":0,"inactive-value":1},null,8,["onChange","modelValue"]),y,0===b.form.codeState?(l(),a(n,{key:0},[b.selectedUserList.length>0?(l(),a("div",V,[(l(!0),a(n,null,p(b.selectedUserList,((e,t)=>(l(),f(k,{key:t},{default:d((()=>[c(g(e.name),1)])),_:2},1024)))),128))])):h("",!0),m(L,{type:"primary",dialogVisibleSelectTag:"",plain:"",onClick:v.onSelectUser},{default:d((()=>[c(g(b.selectedUserList.length?"编辑":"选择")+"员工 ",1)])),_:1},8,["onClick"])],64)):h("",!0)])),_:1})]),m(w,{style:{float:"right"}},{default:d((()=>[m(L,{plain:"",onClick:v.cancelFn},{default:d((()=>[c("取消")])),_:1},8,["onClick"]),j((l(),f(L,{type:"primary",disabled:b.submitLoading,onClick:v.submitFn},{default:d((()=>[c(" 确定 ")])),_:1},8,["disabled","onClick"])),[[R,b.submitLoading]])])),_:1})])),_:1},8,["model","rules"])])),_:1}),m(I,{style:{"min-width":"750px"}},{default:d((()=>[u("div",_,[m(N,{key:"1",showStore:!0,name:"专属门店群",value:b.form},null,8,["value"]),m(N,{key:"2",showTip:!0,name:"专属门店群",value:b.form},null,8,["value"])])])),_:1})])),_:1}),m(q,{visible:b.dialogVisibleSelectUser,"onUpdate:visible":t[4]||(t[4]=e=>b.dialogVisibleSelectUser=e),title:"选择员工",isOnlyLeaf:!0,isSigleSelect:!0,defaultValues:b.selectedUserList,onSuccess:v.selectedUser},null,8,["visible","defaultValues","onSuccess"])])}],["__scopeId","data-v-3692d4dc"]]);export{x as default};
